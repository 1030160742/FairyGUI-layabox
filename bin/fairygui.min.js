!function(t,e,i){var s=(i.un,i.uns,i["static"]),n=i["class"],h=i.getset,r=(i.__newvec,laya.events.Event),a=laya.maths.Point,o=laya.renders.Render,l=laya.filters.ColorFilter,u=(laya.display.Graphics,laya.utils.Handler),_=laya.events.EventDispatcher,c=(laya.media.Sound,laya.utils.Tween),d=laya.utils.Ease,g=laya.display.Sprite,f=laya.maths.Rectangle,p=laya.resource.Texture,m=laya.utils.Utils,y=laya.utils.Byte,v=laya.display.Text,b=laya.html.dom.HTMLDivElement,w=laya.utils.Log,C=(laya.display.Node,laya.media.SoundChannel,laya.display.Input);laya.display.Stage;i["interface"]("fairygui.IColorGear"),i["interface"]("fairygui.IUISource"),i["interface"]("fairygui.IAnimationGear");var x=function(){function t(){}return n(t,"fairygui.AutoSizeType"),t.parse=function(t){switch(t){case"none":return 0;case"both":return 1;case"height":return 2;default:return 0}},t.None=0,t.Both=1,t.Height=2,t}(),S=function(){function t(){}return n(t,"fairygui.ButtonMode"),t.parse=function(t){switch(t){case"Common":return 0;case"Check":return 1;case"Radio":return 2;default:return 0}},t.Common=0,t.Check=1,t.Radio=2,t}(),I=function(){function t(){this.id=null,this.size=0,this.ttf=!1,this.glyphs=null,this.resizable=!1,this.glyphs={}}return n(t,"fairygui.display.BitmapFont",null,"BitmapFont1"),t}(),O=function(){function t(){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0,this.texture=null}return n(t,"fairygui.display.BMGlyph"),t}(),k=function(){function t(){this.rect=null,this.addDelay=0,this.texture=null,this.rect=new f}return n(t,"fairygui.display.Frame"),t}(),P=function(){function t(){this.reachEnding=!1,this.frameStarting=!1,this.reversed=!1,this.repeatedCount=0,this._curFrame=0,this._lastTime=NaN,this._curFrameDelay=0}n(t,"fairygui.display.PlayState");var e=t.prototype;return e.update=function(t){var e=i.timer.currTimer,s=e-this._lastTime;this._lastTime=e,this.reachEnding=!1,this.frameStarting=!1,this._curFrameDelay+=s;var n=this.reversed?t.frameCount-this._curFrame-1:this._curFrame,h=t.interval+t.frames[n].addDelay+(0==n&&this.repeatedCount>0?t.repeatDelay:0);this._curFrameDelay<h||(this._curFrameDelay=0,this._curFrame++,this.frameStarting=!0,this._curFrame>t.frameCount-1&&(this._curFrame=0,this.repeatedCount++,this.reachEnding=!0,t.swing&&(this.reversed=!this.reversed,this._curFrame++)))},e.rewind=function(){this._curFrame=0,this._curFrameDelay=0,this.reversed=!1,this.reachEnding=!1},e.reset=function(){this._curFrame=0,this._curFrameDelay=0,this.repeatedCount=0,this.reachEnding=!1,this.reversed=!1},e.copy=function(t){this._curFrame=t._curFrame,this._curFrameDelay=t._curFrameDelay,this.repeatedCount=t.repeatedCount,this.reachEnding=t.reachEnding,this.reversed=t.reversed},h(0,e,"currentFrame",function(){return this._curFrame},function(t){this._curFrame=t,this._curFrameDelay=0}),t}(),A=(function(){function t(){this._agent=null,this._sourceData=null,this._agent=new dt,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.sortingOrder=1e6,this._agent.on("fui_drag_end",this,this.__dragEnd)}n(t,"fairygui.DragDropManager");var e=t.prototype;return e.startDrag=function(t,e,i,s){if(void 0===s&&(s=-1),null==this._agent.parent){this._sourceData=i,this._agent.url=e,xt.inst.addChild(this._agent);var n=t.localToGlobal();this._agent.setXY(n.x,n.y),this._agent.startDrag(s)}},e.cancel=function(){null!=this._agent.parent&&(this._agent.stopDrag(),xt.inst.removeChild(this._agent),this._sourceData=null)},e.__dragEnd=function(t){if(null!=this._agent.parent){xt.inst.removeChild(this._agent);var e=this._sourceData;this._sourceData=null;for(var i=j.cast(t.target);null!=i;){if(i.displayObject.hasListener("fui_drop"))return i.requestFocus(),void i.displayObject.event("fui_drop",[e,A.createEvent("fui_drop",i.displayObject,t)]);i=i.parent}}},h(0,e,"dragAgent",function(){return this._agent}),h(0,e,"dragging",function(){return null!=this._agent.parent}),h(1,t,"inst",function(){return null==fairygui.DragDropManager._inst&&(fairygui.DragDropManager._inst=new t),fairygui.DragDropManager._inst}),t._inst=null,t}(),function(){function t(){}return n(t,"fairygui.Events"),t.createEvent=function(t,e,i){return fairygui.Events.$event.setTo(t,e,i?i.target:e),i&&(fairygui.Events.$event.touchId=i.touchId),fairygui.Events.$event._stoped=!1,fairygui.Events.$event},t.dispatch=function(t,e,i){e.event(t,fairygui.Events.createEvent(t,e,i))},t.STATE_CHANGED="fui_state_changed",t.XY_CHANGED="fui_xy_changed",t.SIZE_CHANGED="fui_size_changed",t.SIZE_DELAY_CHANGE="fui_size_delay_change",t.CLICK_ITEM="fui_click_item",t.SCROLL="fui_scroll",t.DROP="fui_drop",t.FOCUS_CHANGED="fui_focus_changed",t.DRAG_START="fui_drag_start",t.DRAG_MOVE="fui_drag_move",t.DRAG_END="fui_drag_end",s(t,["$event",function(){return this.$event=new r}]),t}()),H=function(){function t(){}return n(t,"fairygui.FillType"),t.parse=function(t){switch(t){case"none":return 0;case"scale":return 3;case"scaleFree":return 4;default:return 0}},t.None=0,t.Scale=3,t.ScaleFree=4,t}(),T=function(){function t(){}return n(t,"fairygui.FlipType"),t.parse=function(t){switch(t){case"hz":return 1;case"vt":return 2;case"both":return 3;default:return 0}},t.None=0,t.Horizontal=1,t.Vertical=2,t.Both=3,t}(),j=function(){function t(){this.data=null,this._x=0,this._y=0,this._width=0,this._height=0,this._pivotX=0,this._pivotY=0,this._alpha=1,this._rotation=0,this._visible=!0,this._touchable=!0,this._grayed=!1,this._draggable=!1,this._scaleX=1,this._scaleY=1,this._pivotOffsetX=0,this._pivotOffsetY=0,this._sortingOrder=0,this._internalVisible=1,this._focusable=!1,this._tooltips=null,this._relations=null,this._group=null,this._gearDisplay=null,this._gearXY=null,this._gearSize=null,this._gearLook=null,this._dragBounds=null,this._displayObject=null,this._yOffset=0,this._parent=null,this._rawWidth=0,this._rawHeight=0,this._sourceWidth=0,this._sourceHeight=0,this._initWidth=0,this._initHeight=0,this._id=null,this._name=null,this._packageItem=null,this._underConstruct=!1,this._constructingData=null,this._gearLocked=!1,this._touchDownPoint=null,this._id=""+fairygui.GObject._gInstanceCounter++,this._name="",this.createDisplayObject(),this._relations=new X(this),this._gearDisplay=new at(this),this._gearXY=new ct(this),this._gearSize=new _t(this),this._gearLook=new ot(this)}n(t,"fairygui.GObject");var e=t.prototype;return e.setXY=function(t,e){if(this._x!=t||this._y!=e){var i=t-this._x,s=e-this._y;this._x=t,this._y=e,this.handleXYChanged(),this instanceof fairygui.GGroup&&this.moveChildren(i,s),this._gearXY.controller&&this._gearXY.updateState(),!this._parent||this._parent instanceof fairygui.GList||(this._parent.setBoundsChangedFlag(),this.displayObject.event("fui_xy_changed"))}},e.center=function(t){void 0===t&&(t=!1);var e;e=null!=this._parent?this.parent:this.root,this.setXY((e.width-this.width)/2,(e.height-this.height)/2),t&&(this.addRelation(e,3),this.addRelation(e,10))},e.setSize=function(t,e,i){if(void 0===i&&(i=!1),this._rawWidth!=t||this._rawHeight!=e){this._rawWidth=t,this._rawHeight=e,0>t&&(t=0),0>e&&(e=0);var s=t-this._width,n=e-this._height;this._width=t,this._height=e,0==this._pivotX&&0==this._pivotY||(i||this.setXY(this.x-this._pivotX*s,this.y-this._pivotY*n),this.updatePivotOffset()),this.handleSizeChanged(),this._gearSize.controller&&this._gearSize.updateState(),this._parent&&(this._relations.onOwnerSizeChanged(s,n),this._parent.setBoundsChangedFlag()),this.displayObject.event("fui_size_changed")}},e.ensureSizeCorrect=function(){},e.setScale=function(t,e){this._scaleX==t&&this._scaleY==e||(this._scaleX=t,this._scaleY=e,this.applyPivot(),this.handleSizeChanged(),this._gearSize.controller&&this._gearSize.updateState())},e.setPivot=function(t,e){void 0===e&&(e=0),this._pivotX==t&&this._pivotY==e||(this._pivotX=t,this._pivotY=e,this.updatePivotOffset())},e.updatePivotOffset=function(){var t=this.normalizeRotation;if(0!=t||1!=this._scaleX||1!=this._scaleY){var e=t*Math.PI/180,i=Math.cos(e),s=Math.sin(e),n=this._scaleX*i,h=this._scaleX*s,r=this._scaleY*-s,a=this._scaleY*i,o=this._pivotX*this._width,l=this._pivotY*this._height;this._pivotOffsetX=o-(n*o+r*l),this._pivotOffsetY=l-(a*l+h*o)}else this._pivotOffsetX=0,this._pivotOffsetY=0},e.applyPivot=function(){0==this._pivotX&&0==this._pivotY||(this.updatePivotOffset(),this.handleXYChanged())},e.updateAlpha=function(){this._displayObject&&(this._displayObject.alpha=this._alpha),this._gearLook.controller&&this._gearLook.updateState()},e.requestFocus=function(){for(var t=this;t&&!t._focusable;)t=t.parent;null!=t&&(this.root.focus=t)},e.addRelation=function(t,e,i){void 0===i&&(i=!1),this._relations.add(t,e,i)},e.removeRelation=function(t,e){void 0===e&&(e=0),this._relations.remove(t,e)},e.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},e.dispose=function(){this.removeFromParent(),this._relations.dispose()},e.onClick=function(t,e,i){this.on("click",t,e,i)},e.offClick=function(t,e){this.off("click",t,e)},e.hasClickListener=function(){return this._displayObject.hasListener("click")},e.on=function(t,e,i,s){this._displayObject.on(t,e,i,s)},e.off=function(t,e,i){this._displayObject.off(t,e,i)},e.startDrag=function(t){void 0===t&&(t=-1),null!=this._displayObject.stage&&this.dragBegin()},e.stopDrag=function(){this.dragEnd()},e.localToGlobal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),i?(i.x=t,i.y=e,this._displayObject.localToGlobal(i,!1)):(i=fairygui.GObject.sHelperPoint,i.x=t,i.y=e,this._displayObject.localToGlobal(i,!0))},e.globalToLocal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),i?(i.x=t,i.y=e,this._displayObject.globalToLocal(i,!1)):(i=fairygui.GObject.sHelperPoint,i.x=t,i.y=e,this._displayObject.globalToLocal(i,!0))},e.localToGlobalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new f);var h=this.localToGlobal(t,e);return n.x=h.x,n.y=h.y,h=this.localToGlobal(t+i,e+s),n.width=h.x-n.x,n.height=h.y-n.y,n},e.globalToLocalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new f);var h=this.globalToLocal(t,e);return n.x=h.x,n.y=h.y,h=this.globalToLocal(t+i,e+s),n.width=h.x-n.x,n.height=h.y-n.y,n},e.handleControllerChanged=function(t){this._gearDisplay.controller==t&&this._gearDisplay.apply(),this._gearXY.controller==t&&this._gearXY.apply(),this._gearSize.controller==t&&this._gearSize.apply(),this._gearLook.controller==t&&this._gearLook.apply()},e.createDisplayObject=function(){this._displayObject=new g,this._displayObject.$owner=this},e.handleXYChanged=function(){this._displayObject.pos(Math.floor(this._x+this._pivotOffsetX),Math.floor(this._y+this._pivotOffsetY+this._yOffset))},e.handleSizeChanged=function(){},e.handleGrayChanged=function(){this._displayObject&&(this._grayed?this._displayObject.filters=[new l(J.GRAY_FILTERS_MATRIX)]:this._displayObject.filters=null)},e.constructFromResource=function(t){this._packageItem=t},e.setup_beforeAdd=function(t){var e,i;if(this._id=t.getAttribute("id"),this._name=t.getAttribute("name"),e=t.getAttribute("xy"),i=e.split(","),this.setXY(parseInt(i[0]),parseInt(i[1])),e=t.getAttribute("size"),e&&(i=e.split(","),this._initWidth=parseInt(i[0]),this._initHeight=parseInt(i[1]),this.setSize(this._initWidth,this._initHeight)),e=t.getAttribute("scale"),e&&(i=e.split(","),this.setScale(parseFloat(i[0]),parseFloat(i[1]))),e=t.getAttribute("rotation"),e&&(this.rotation=parseInt(e)),e=t.getAttribute("pivot")){i=e.split(",");var s=parseFloat(i[0]),n=parseFloat(i[1]);s>2&&(0!=this._sourceWidth?s/=this._sourceWidth:s=0),n>2&&(0!=this._sourceHeight?n/=this._sourceHeight:n=0),this.setPivot(s,n)}e=t.getAttribute("alpha"),e&&(this.alpha=parseFloat(e)),"false"==t.getAttribute("touchable")&&(this.touchable=!1),"false"==t.getAttribute("visible")&&(this.visible=!1),"true"==t.getAttribute("grayed")&&(this.grayed=!0),this.tooltips=t.getAttribute("tooltips")},e.setup_afterAdd=function(t){var e,i=t.getAttribute("group");i&&(this._group=this._parent.getChildById(i));for(var s=t.childNodes,n=s.length,h=0;n>h;h++)e=s[h],"gearDisplay"==e.nodeName?this._gearDisplay.setup(e):"gearXY"==e.nodeName?this._gearXY.setup(e):"gearSize"==e.nodeName?this._gearSize.setup(e):"gearLook"==e.nodeName&&this._gearLook.setup(e)},e.initDrag=function(){this._draggable?this.on("mousedown",this,this.__begin):this.off("mousedown",this,this.__begin)},e.dragBegin=function(){null!=fairygui.GObject.sDragging&&fairygui.GObject.sDragging.stopDrag(),fairygui.GObject.sGlobalDragStart.x=i.stage.mouseX,fairygui.GObject.sGlobalDragStart.y=i.stage.mouseY,this.localToGlobalRect(0,0,this.width,this.height,fairygui.GObject.sGlobalRect),fairygui.GObject.sDragging=this,i.stage.on("mousemove",this,this.__moving2),i.stage.on("mouseup",this,this.__end2)},e.dragEnd=function(){fairygui.GObject.sDragging==this&&(i.stage.off("mousemove",this,this.__moving2),i.stage.off("mouseup",this,this.__end2),fairygui.GObject.sDragging=null),fairygui.GObject.sDraggingQuery=!1},e.reset=function(){i.stage.off("mousemove",this,this.__moving),i.stage.off("mouseup",this,this.__end)},e.__begin=function(){null==this._touchDownPoint&&(this._touchDownPoint=new a),this._touchDownPoint.x=i.stage.mouseX,this._touchDownPoint.y=i.stage.mouseY,i.stage.on("mousemove",this,this.__moving),i.stage.on("mouseup",this,this.__end)},e.__end=function(){this.reset()},e.__moving=function(t){var e=Q.touchDragSensitivity;null!=this._touchDownPoint&&Math.abs(this._touchDownPoint.x-i.stage.mouseX)<e&&Math.abs(this._touchDownPoint.y-i.stage.mouseY)<e||(this.reset(),fairygui.GObject.sDraggingQuery=!0,A.dispatch("fui_drag_start",this._displayObject,t),fairygui.GObject.sDraggingQuery&&this.dragBegin())},e.__moving2=function(t){var e=i.stage.mouseX-fairygui.GObject.sGlobalDragStart.x+fairygui.GObject.sGlobalRect.x,s=i.stage.mouseY-fairygui.GObject.sGlobalDragStart.y+fairygui.GObject.sGlobalRect.y;if(null!=this._dragBounds){var n=xt.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,fairygui.GObject.sDragHelperRect);e<n.x?e=n.x:e+fairygui.GObject.sGlobalRect.width>n.right&&(e=n.right-fairygui.GObject.sGlobalRect.width,e<n.x&&(e=n.x)),s<n.y?s=n.y:s+fairygui.GObject.sGlobalRect.height>n.bottom&&(s=n.bottom-fairygui.GObject.sGlobalRect.height,s<n.y&&(s=n.y))}var h=this.parent.globalToLocal(e,s,fairygui.GObject.sHelperPoint);this.setXY(Math.round(h.x),Math.round(h.y)),A.dispatch("fui_drag_move",this._displayObject,t)},e.__end2=function(t){fairygui.GObject.sDragging==this&&(this.stopDrag(),A.dispatch("fui_drag_end",this._displayObject,t))},h(0,e,"id",function(){return this._id}),h(0,e,"name",function(){return this._name},function(t){this._name=t}),h(0,e,"parent",function(){return this._parent},function(t){this._parent=t}),h(0,e,"asLabel",function(){return this}),h(0,e,"asTextField",function(){return this}),h(0,e,"gearLook",function(){return this._gearLook}),h(0,e,"initHeight",function(){return this._initHeight}),h(0,e,"y",function(){return this._y},function(t){this.setXY(this._x,t)}),h(0,e,"asButton",function(){return this}),h(0,e,"x",function(){return this._x},function(t){this.setXY(t,this._y)}),h(0,e,"gearSize",function(){return this._gearSize}),h(0,e,"width",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},function(t){this.setSize(t,this._rawHeight)}),h(0,e,"height",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},function(t){this.setSize(this._rawWidth,t)}),h(0,e,"sourceHeight",function(){return this._sourceHeight}),h(0,e,"asComboBox",function(){return this}),h(0,e,"scaleX",function(){return this._scaleX},function(t){this.setScale(t,this._scaleY)}),h(0,e,"sourceWidth",function(){return this._sourceWidth}),h(0,e,"tooltips",function(){return this._tooltips},function(t){this._tooltips=t}),h(0,e,"initWidth",function(){return this._initWidth}),h(0,e,"actualWidth",function(){return this.width*this._scaleX}),h(0,e,"actualHeight",function(){return this.height*this._scaleY}),h(0,e,"rotation",function(){return this._rotation},function(t){this._rotation!=t&&(this._rotation=t,this.applyPivot(),this._displayObject&&(this._displayObject.rotation=this.normalizeRotation),this._gearLook.controller&&this._gearLook.updateState())}),h(0,e,"scaleY",function(){return this._scaleY},function(t){this.setScale(this._scaleX,t)}),h(0,e,"pivotX",function(){return this._pivotX},function(t){this.setPivot(t,this._pivotY)}),h(0,e,"normalizeRotation",function(){var t=this._rotation%360;return t>180?t-=360:-180>t&&(t=360+t),t}),h(0,e,"pivotY",function(){return this._pivotY},function(t){this.setPivot(this._pivotX,t)}),h(0,e,"touchable",function(){return this._touchable},function(t){this._touchable=t,this instanceof fairygui.GImage||this instanceof fairygui.GMovieClip||!(!(this instanceof fairygui.GTextField)||this instanceof fairygui.GTextInput||this instanceof fairygui.GRichTextField)||null!=this._displayObject&&(this._displayObject.mouseEnabled=this._touchable)}),h(0,e,"grayed",function(){return this._grayed},function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayChanged())}),h(0,e,"enabled",function(){return!this._grayed&&this._touchable},function(t){this.grayed=!t,this.touchable=t}),h(0,e,"alpha",function(){return this._alpha},function(t){this._alpha!=t&&(this._alpha=t,this.updateAlpha())}),h(0,e,"visible",function(){return this._visible},function(t){this._visible!=t&&(this._visible=t,this._displayObject&&(this._displayObject.visible=this._visible),this._parent&&this._parent.childStateChanged(this))}),h(0,e,"asTextInput",function(){return this}),h(0,e,"internalVisible",function(){return this._internalVisible},function(t){0>t&&(t=0);var e=this._internalVisible>0,i=t>0;this._internalVisible=t,e!=i&&this._parent&&this._parent.childStateChanged(this)}),h(0,e,"finalVisible",function(){return this._visible&&this._internalVisible>0&&(!this._group||this._group.finalVisible)}),h(0,e,"text",function(){return null},function(t){}),h(0,e,"resourceURL",function(){return null!=this._packageItem?"ui://"+this._packageItem.owner.id+this._packageItem.id:null}),h(0,e,"sortingOrder",function(){return this._sortingOrder},function(t){if(0>t&&(t=0),this._sortingOrder!=t){var e=this._sortingOrder;this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}}),h(0,e,"focusable",function(){return this._focusable},function(t){this._focusable=t}),h(0,e,"focused",function(){return this.root.focus==this}),h(0,e,"dragBounds",function(){return this._dragBounds},function(t){this._dragBounds=t}),h(0,e,"inContainer",function(){return null!=this._displayObject&&null!=this._displayObject.parent}),h(0,e,"onStage",function(){return null!=this._displayObject&&null!=this._displayObject.stage}),h(0,e,"group",function(){return this._group},function(t){this._group=t}),h(0,e,"gearDisplay",function(){return this._gearDisplay}),h(0,e,"asGroup",function(){return this}),h(0,e,"asRichTextField",function(){return this}),h(0,e,"dragging",function(){return fairygui.GObject.sDragging==this}),h(0,e,"gearXY",function(){return this._gearXY}),h(0,e,"root",function(){if(this instanceof fairygui.GRoot)return this;for(var t=this._parent;t;){if(t instanceof fairygui.GRoot)return t;t=t.parent}return xt.inst}),h(0,e,"relations",function(){return this._relations}),h(0,e,"displayObject",function(){return this._displayObject}),h(0,e,"asCom",function(){return this}),h(0,e,"asLoader",function(){return this}),h(0,e,"asProgress",function(){return this}),h(0,e,"asSlider",function(){return this}),h(0,e,"asList",function(){return this}),h(0,e,"asGraph",function(){return this}),h(0,e,"asMovieClip",function(){return this}),h(0,e,"draggable",function(){return this._draggable},function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())}),t.cast=function(t){return t.$owner},t._gInstanceCounter=0,t.sDragging=null,t.sDraggingQuery=!1,s(t,["sGlobalDragStart",function(){return this.sGlobalDragStart=new a},"sGlobalRect",function(){return this.sGlobalRect=new f},"sHelperPoint",function(){return this.sHelperPoint=new a},"sDragHelperRect",function(){return this.sDragHelperRect=new f}]),t}(),B=function(){function t(t){this._pageSet=null,this._tween=!1,this._easeType=null,this._tweenTime=NaN,this._delay=NaN,this._owner=null,this._controller=null,this._owner=t,this._pageSet=new R,this._easeType=d.QuadOut,this._tweenTime=.3,this._delay=0}n(t,"fairygui.GearBase");var e=t.prototype;return e.getPageSet=function(){return this._pageSet},e.setup=function(t){if(this._controller=this._owner.parent.getController(t.getAttribute("controller")),null!=this._controller){this.init();var e;e=t.getAttribute("pages");var i;i=e?e.split(","):[];for(var s=i.length,n=0;s>n;n++)e=i[n],this._pageSet.addById(e);e=t.getAttribute("tween"),e&&(this._tween=!0),e=t.getAttribute("ease"),e&&(this._easeType=J.parseEaseType(e)),e=t.getAttribute("duration"),e&&(this._tweenTime=parseFloat(e)),e=t.getAttribute("delay"),e&&(this._delay=parseFloat(e)),e=t.getAttribute("values");var h;h=e?t.getAttribute("values").split("|"):[];for(var r=0;r<h.length;r++)e=h[r],"-"!=e&&this.addStatus(i[r],e);e=t.getAttribute("default"),e&&this.addStatus(null,e)}},e.addStatus=function(t,e){},e.init=function(){},e.apply=function(){},e.updateState=function(){},h(0,e,"controller",function(){return this._controller},function(t){t!=this._controller&&(this._controller=t,this._pageSet.controller=t,this._pageSet.clear(),this._controller&&this.init())}),h(0,e,"connected",function(){return this._controller&&!this._pageSet.empty?this._pageSet.containsId(this._controller.selectedPageId):!1}),h(0,e,"tween",function(){return this._tween},function(t){this._tween=t}),h(0,e,"delay",function(){return this._delay},function(t){this._delay=t}),h(0,e,"tweenTime",function(){return this._tweenTime},function(t){this._tweenTime=t}),h(0,e,"easeType",function(){return this._easeType},function(t){this._easeType=t}),t.disableAllTweenEffect=!1,t}(),F=function(){function t(){this._pool=null,this._count=0,this._pool={}}n(t,"fairygui.GObjectPool");var e=t.prototype;return e.clear=function(){for(var t=this._pool.length,e=0;t>e;e++)for(var i=this._pool[e],s=i.length,n=0;s>n;n++)i[n].dispose();this._pool={},this._count=0},e.getObject=function(t){var e=this._pool[t];if(null==e&&(e=[],this._pool[t]=e),e.length)return this._count--,e.shift();var i=Z.createObjectFromURL(t);return i},e.returnObject=function(t){var e=t.resourceURL;if(e){var i=this._pool[e];i&&(this._count++,i.push(t))}},h(0,e,"count",function(){return this._count}),t}(),z=function(){function t(){}return n(t,"fairygui.ListLayoutType"),t.parse=function(t){switch(t){case"column":return 0;case"row":return 1;case"flow_hz":return 2;case"flow_vt":return 3;default:return 0}},t.SingleColumn=0,t.SingleRow=1,t.FlowHorizontal=2,t.FlowVertical=3,t}(),M=function(){function t(){}return n(t,"fairygui.ListSelectionMode"),t.parse=function(t){switch(t){case"single":return 0;case"multiple":return 1;case"multipleSingleClick":return 2;case"none":return 3;default:return 0}},t.Single=0,t.Multiple=1,t.Multiple_SingleClick=2,t.None=3,t}(),W=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}n(t,"fairygui.Margin");var e=t.prototype;return e.parse=function(t){if(!t)return this.left=0,this.right=0,this.top=0,void(this.bottom=0);var e=t.split(",");if(1==e.length){var i=parseInt(e[0]);this.top=i,this.bottom=i,this.left=i,this.right=i}else this.top=parseInt(e[0]),this.bottom=parseInt(e[1]),this.left=parseInt(e[2]),this.right=parseInt(e[3])},e.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t}(),N=function(){function t(){}return n(t,"fairygui.OverflowType"),t.parse=function(t){switch(t){case"visible":return 0;case"hidden":return 1;case"scroll":return 2;case"scale":return 3;case"scaleFree":return 4;default:return 0}},t.Visible=0,t.Hidden=1,t.Scroll=2,t.Scale=3,t.ScaleFree=4,t}(),L=function(){function t(){this.owner=null,this.type=0,this.id=null,this.name=null,this.width=0,this.height=0,this.file=null,this.decoded=!1,this.scale9Grid=null,this.scaleByTile=!1,this.smoothing=!1,this.texture=null,this.pivot=null,this.interval=NaN,this.repeatDelay=NaN,this.swing=!1,this.frames=null,this.componentData=null,this.sound=null,this.bitmapFont=null}n(t,"fairygui.PackageItem");var e=t.prototype;return e.load=function(){return this.owner.getItemAsset(this)},e.toString=function(){return this.name},t}(),G=function(){function t(){}return n(t,"fairygui.PackageItemType"),t.parse=function(t){switch(t){case"image":return 0;case"movieclip":return 2;case"sound":return 3;case"component":return 4;case"swf":return 1;case"font":return 6;case"atlas":return 7}return 0},t.Image=0,t.Swf=1,t.MovieClip=2,t.Sound=3,t.Component=4,t.Misc=5,t.Font=6,t.Atlas=7,t}(),V=function(){function t(){this._controller=null,this._id=null}n(t,"fairygui.PageOption");var e=t.prototype;return e.clear=function(){this._id=null},h(0,e,"controller",null,function(t){this._controller=t}),h(0,e,"index",function(){return this._id?this._controller.getPageIndexById(this._id):-1},function(t){this._id=this._controller.getPageId(t)}),h(0,e,"id",function(){return this._id},function(t){this._id=t}),h(0,e,"name",function(){return this._id?this._controller.getPageNameById(this._id):null},function(t){this._id=this._controller.getPageIdByName(t)}),t}(),R=function(){function t(){this._controller=null,this._items=null,this._items=[]}n(t,"fairygui.PageOptionSet");var e=t.prototype;return e.add=function(t){void 0===t&&(t=0);var e=this._controller.getPageId(t),i=this._items.indexOf(e);-1==i&&this._items.push(e)},e.remove=function(t){void 0===t&&(t=0);var e=this._controller.getPageId(t),i=this._items.indexOf(e);-1!=i&&this._items.splice(i,1)},e.addByName=function(t){var e=this._controller.getPageIdByName(t),i=this._items.indexOf(e);-1!=i&&this._items.push(e)},e.removeByName=function(t){var e=this._controller.getPageIdByName(t),i=this._items.indexOf(e);-1!=i&&this._items.splice(i,1)},e.clear=function(){this._items.length=0},e.addById=function(t){this._items.push(t)},e.containsId=function(t){return-1!=this._items.indexOf(t)},h(0,e,"controller",null,function(t){this._controller=t}),h(0,e,"empty",function(){return 0==this._items.length}),t}(),E=(function(){function t(t){if(this._contentPane=null,this._list=null,!t&&(t=Q.popupMenu,!t))throw"UIConfig.popupMenu not defined";this._contentPane=Z.createObjectFromURL(t).asCom,this._contentPane.on("display",this,this.__addedToStage),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,14),this._list.removeRelation(this._contentPane,15),this._contentPane.addRelation(this._list,15),this._list.on("fui_click_item",this,this.__clickItem)}n(t,"fairygui.PopupMenu");var e=t.prototype;return e.addItem=function(t,e){var i=this._list.addItemFromPool().asButton;i.title=t,i.data=e,i.grayed=!1;var s=i.getController("checked");return null!=s&&(s.selectedIndex=0),i},e.addItemAt=function(t,e,i){var s=this._list.getFromPool().asButton;this._list.addChildAt(s,e),s.title=t,s.data=i,s.grayed=!1;var n=s.getController("checked");return null!=n&&(n.selectedIndex=0),s},e.addSeperator=function(){if(null==Q.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(Q.popupMenu_seperator)},e.getItemName=function(t){var e=this._list.getChildAt(t);return e.name},e.setItemText=function(t,e){var i=this._list.getChild(t).asButton;i.title=e},e.setItemVisible=function(t,e){var i=this._list.getChild(t).asButton;i.visible!=e&&(i.visible=e,this._list.setBoundsChangedFlag())},e.setItemGrayed=function(t,e){var i=this._list.getChild(t).asButton;i.grayed=e},e.setItemCheckable=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(e?0==s.selectedIndex&&(s.selectedIndex=1):s.selectedIndex=0)},e.setItemChecked=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(s.selectedIndex=e?2:1)},e.isItemChecked=function(t){var e=this._list.getChild(t).asButton,i=e.getController("checked");return null!=i?2==i.selectedIndex:!1},e.removeItem=function(t){var e=this._list.getChild(t);if(null!=e){var i=this._list.getChildIndex(e);return this._list.removeChildToPoolAt(i),!0}return!1},e.clearItems=function(){this._list.removeChildrenToPool()},e.show=function(t,e){var i=null!=t?t.root:xt.inst;i.showPopup(this.contentPane,t instanceof fairygui.GRoot?null:t,e)},e.__clickItem=function(t){i.timer.once(100,this,this.__clickItem2,[t])},e.__clickItem2=function(t){var e=t.asButton;if(null!=e){if(e.grayed)return void(this._list.selectedIndex=-1);var i=e.getController("checked");null!=i&&0!=i.selectedIndex&&(1==i.selectedIndex?i.selectedIndex=2:i.selectedIndex=1);var s=this._contentPane.parent;s.hidePopup(this.contentPane),null!=e.data&&e.data.run()}},e.__addedToStage=function(){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},h(0,e,"itemCount",function(){return this._list.numChildren}),h(0,e,"contentPane",function(){return this._contentPane}),h(0,e,"list",function(){return this._list}),t}(),function(){function t(){}return n(t,"fairygui.ProgressTitleType"),t.parse=function(t){switch(t){case"percent":return 0;case"valueAndmax":return 1;case"value":return 2;case"max":return 3;default:return 0}},t.Percent=0,t.ValueAndMax=1,t.Value=2,t.Max=3,t}()),D=function(){function t(t){this._owner=null,this._target=null,this._defs=null,this._targetX=NaN,this._targetY=NaN,this._targetWidth=NaN,this._targetHeight=NaN,this._owner=t,this._defs=[]}var e;n(t,"fairygui.RelationItem");var i=t.prototype;return i.add=function(t,i){if(24==t)return this.add(14,i),void this.add(15,i);for(var s=this._defs.length,n=0;s>n;n++){var h=this._defs[n];if(h.type==t)return}var r=new e;r.affectBySelfSizeChanged=t>=3&&6>=t||t>=10&&13>=t,r.percent=i,r.type=t,this._defs.push(r)},i.remove=function(t){if(void 0===t&&(t=0),24==t)return this.remove(14),void this.remove(15);for(var e=this._defs.length,i=0;e>i;i++)if(this._defs[i].type==t){this._defs.splice(i,1);break}},i.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var i=t._defs.length,s=0;i>s;s++){var n=t._defs[s],h=new e;h.copyFrom(n),this._defs.push(h)}},i.dispose=function(){null!=this._target&&(this.releaseRefTarget(this._target),this._target=null)},i.applyOnSelfResized=function(t,e){for(var i=this._owner.x,s=this._owner.y,n=this._defs.length,h=0;n>h;h++){var r=this._defs[h];if(r.affectBySelfSizeChanged)switch(r.type){case 3:case 5:this._owner.x-=t/2;break;case 4:case 6:this._owner.x-=t;break;case 10:case 12:this._owner.y-=e/2;break;case 11:case 13:this._owner.y-=e}}if((i!=this._owner.x||s!=this._owner.y)&&(i=this._owner.x-i,s=this._owner.y-s,null!=this._owner.gearXY.controller&&this._owner.gearXY.updateFromRelations(i,s),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(h=0;a>h;++h)this._owner.parent._transitions[h].updateFromRelations(this._owner.id,i,s)}},i.applyOnXYChanged=function(t,e,i){var s=NaN;switch(t.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:this._owner.x+=e;break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:this._owner.y+=i;break;case 14:case 15:break;case 16:case 17:s=this._owner.x,this._owner.x+=e,this._owner.width=this._owner._rawWidth-(this._owner.x-s);break;case 18:case 19:this._owner.width=this._owner._rawWidth+e;break;case 20:case 21:s=this._owner.y,this._owner.y+=i,this._owner.height=this._owner._rawHeight-(this._owner.y-s);break;case 22:case 23:this._owner.height=this._owner._rawHeight+i}},i.applyOnSizeChanged=function(t){var e=NaN,i=NaN;this._target!=this._owner.parent?(e=this._target.x,i=this._target.y):(e=0,i=0);var s=NaN,n=NaN;switch(t.type){case 0:break;case 1:s=this._owner.x-(e+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+this._target._rawWidth/2+s;
break;case 2:s=this._owner.x-(e+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+this._target._rawWidth+s;break;case 3:s=this._owner.x+this._owner._rawWidth/2-(e+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+this._target._rawWidth/2+s-this._owner._rawWidth/2;break;case 4:s=this._owner.x+this._owner._rawWidth-e,t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+s-this._owner._rawWidth;break;case 5:s=this._owner.x+this._owner._rawWidth-(e+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+this._target._rawWidth/2+s-this._owner._rawWidth;break;case 6:s=this._owner.x+this._owner._rawWidth-(e+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=e+this._target._rawWidth+s-this._owner._rawWidth;break;case 7:break;case 8:s=this._owner.y-(i+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+this._target._rawHeight/2+s;break;case 9:s=this._owner.y-(i+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+this._target._rawHeight+s;break;case 10:s=this._owner.y+this._owner._rawHeight/2-(i+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+this._target._rawHeight/2+s-this._owner._rawHeight/2;break;case 11:s=this._owner.y+this._owner._rawHeight-i,t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+s-this._owner._rawHeight;break;case 12:s=this._owner.y+this._owner._rawHeight-(i+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+this._target._rawHeight/2+s-this._owner._rawHeight;break;case 13:s=this._owner.y+this._owner._rawHeight-(i+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=i+this._target._rawHeight+s-this._owner._rawHeight;break;case 14:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target._initWidth:this._owner._rawWidth-this._targetWidth,t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._target==this._owner.parent?this._owner.setSize(this._target._rawWidth+s,this._owner._rawHeight,!0):this._owner.width=this._target._rawWidth+s;break;case 15:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target._initHeight:this._owner._rawHeight-this._targetHeight,t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._target==this._owner.parent?this._owner.setSize(this._owner._rawWidth,this._target._rawHeight+s,!0):this._owner.height=this._target._rawHeight+s;break;case 16:break;case 17:s=this._owner.x-(e+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),n=this._owner.x,this._owner.x=e+this._target._rawWidth+s,this._owner.width=this._owner._rawWidth-(this._owner.x-n);break;case 18:break;case 19:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-(e+this._target._initWidth):this._owner.width-(e+this._targetWidth),this._owner!=this._target.parent&&(s+=this._owner.x),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner!=this._target.parent?this._owner.width=e+this._target._rawWidth+s-this._owner.x:this._owner.width=e+this._target._rawWidth+s;break;case 20:break;case 21:s=this._owner.y-(i+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),n=this._owner.y,this._owner.y=i+this._target._rawHeight+s,this._owner.height=this._owner._rawHeight-(this._owner.y-n);break;case 22:break;case 23:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-(i+this._target._initHeight):this._owner._rawHeight-(i+this._targetHeight),this._owner!=this._target.parent&&(s+=this._owner.y),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner!=this._target.parent?this._owner.height=i+this._target._rawHeight+s-this._owner.y:this._owner.height=i+this._target._rawHeight+s}},i.addRefTarget=function(t){t!=this._owner.parent&&t.on("fui_xy_changed",this,this.__targetXYChanged),t.on("fui_size_changed",this,this.__targetSizeChanged),t.on("fui_size_delay_change",this,this.__targetSizeWillChange),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight},i.releaseRefTarget=function(t){t.off("fui_xy_changed",this,this.__targetXYChanged),t.off("fui_size_changed",this,this.__targetSizeChanged),t.off("fui_size_delay_change",this,this.__targetSizeWillChange)},i.__targetXYChanged=function(){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var t=this._owner.x,e=this._owner.y,i=this._target.x-this._targetX,s=this._target.y-this._targetY,n=this._defs.length,h=0;n>h;h++){var r=this._defs[h];this.applyOnXYChanged(r,i,s)}if(this._targetX=this._target.x,this._targetY=this._target.y,(t!=this._owner.x||e!=this._owner.y)&&(t=this._owner.x-t,e=this._owner.y-e,null!=this._owner.gearXY.controller&&this._owner.gearXY.updateFromRelations(t,e),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(h=0;a>h;++h)this._owner.parent._transitions[h].updateFromRelations(this._owner.id,t,e)}this._owner.relations.handling=null},i.__targetSizeChanged=function(){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var t=this._owner.x,e=this._owner.y,i=this._owner._rawWidth,s=this._owner._rawHeight,n=this._defs.length,h=0;n>h;h++){var r=this._defs[h];this.applyOnSizeChanged(r)}if(this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight,(t!=this._owner.x||e!=this._owner.y)&&(t=this._owner.x-t,e=this._owner.y-e,null!=this._owner.gearXY.controller&&this._owner.gearXY.updateFromRelations(t,e),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(h=0;a>h;++h)this._owner.parent._transitions[h].updateFromRelations(this._owner.id,t,e)}i==this._owner._rawWidth&&s==this._owner._rawHeight||(i=this._owner._rawWidth-i,s=this._owner._rawHeight-s,null!=this._owner.gearSize.controller&&this._owner.gearSize.updateFromRelations(i,s)),this._owner.relations.handling=null}},i.__targetSizeWillChange=function(){this._owner.relations.sizeDirty=!0},h(0,i,"isEmpty",function(){return 0==this._defs.length}),h(0,i,"owner",function(){return this._owner}),h(0,i,"target",function(){return this._target},function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))}),t.__init$=function(){e=function(){function t(){this.affectBySelfSizeChanged=!1,this.percent=!1,this.type=NaN}n(t,"");var e=t.prototype;return e.copyFrom=function(t){this.affectBySelfSizeChanged=t.affectBySelfSizeChanged,this.percent=t.percent,this.type=t.type},t}()},t}(),X=function(){function t(t){this._owner=null,this._items=null,this.handling=null,this.sizeDirty=!1,this._owner=t,this._items=[]}n(t,"fairygui.Relations");var e=t.prototype;return e.add=function(t,e,i){void 0===i&&(i=!1);for(var s=this._items.length,n=0;s>n;n++){var h=this._items[n];if(h.target==t)return void h.add(e,i)}var r=new D(this._owner);r.target=t,r.add(e,i),this._items.push(r)},e.addItems=function(t,e){var i,s=e.split(","),n=!1,h=NaN;for(h=0;2>h;h++)if(i=s[h]){"%"==i.charAt(i.length-1)?(i=i.substr(0,i.length-1),n=!0):n=!1;var r=i.indexOf("-");-1==r&&(i=i+"-"+i);var a=fairygui.Relations.RELATION_NAMES.indexOf(i);if(-1==a)throw"invalid relation type";this.add(t,a,n)}},e.remove=function(t,e){void 0===e&&(e=0);for(var i=this._items.length,s=0;i>s;){var n=this._items[s];n.target==t?(n.remove(e),n.isEmpty?(n.dispose(),this._items.splice(s,1),i--):s++):s++}},e.contains=function(t){for(var e=this._items.length,i=0;e>i;i++){var s=this._items[i];if(s.target==t)return!0}return!1},e.clearFor=function(t){for(var e=this._items.length,i=0;e>i;){var s=this._items[i];s.target==t?(s.dispose(),this._items.splice(i,1),e--):i++}},e.clearAll=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.dispose()}this._items.length=0},e.copyFrom=function(t){this.clearAll();for(var e=t._items,i=e.length,s=0;i>s;s++){var n=e[s],h=new D(this._owner);h.copyFrom(n),this._items.push(h)}},e.dispose=function(){this.clearAll()},e.onOwnerSizeChanged=function(t,e){if(0!=this._items.length)for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];n.applyOnSelfResized(t,e)}},e.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.target.ensureSizeCorrect()}}},e.setup=function(t){for(var e,i,s=t.childNodes,n=s.length,h=0;n>h;h++){var r=s[h];"relation"==r.nodeName&&(e=r.getAttribute("target"),i=this._owner.parent?e?this._owner.parent.getChildById(e):this._owner.parent:this._owner.getChildById(e),i&&this.addItems(i,r.getAttribute("sidePair")))}},h(0,e,"empty",function(){return 0==this._items.length}),s(t,["RELATION_NAMES",function(){return this.RELATION_NAMES=["left-left","left-center","left-right","center-center","right-left","right-center","right-right","top-top","top-middle","top-bottom","middle-middle","bottom-top","bottom-middle","bottom-bottom","width-width","height-height","leftext-left","leftext-right","rightext-left","rightext-right","topext-top","topext-bottom","bottomext-top","bottomext-bottom"]}]),t}(),Y=(function(){function t(){}return n(t,"fairygui.RelationType"),t.Left_Left=0,t.Left_Center=1,t.Left_Right=2,t.Center_Center=3,t.Right_Left=4,t.Right_Center=5,t.Right_Right=6,t.Top_Top=7,t.Top_Middle=8,t.Top_Bottom=9,t.Middle_Middle=10,t.Bottom_Top=11,t.Bottom_Middle=12,t.Bottom_Bottom=13,t.Width=14,t.Height=15,t.LeftExt_Left=16,t.LeftExt_Right=17,t.RightExt_Left=18,t.RightExt_Right=19,t.TopExt_Top=20,t.TopExt_Bottom=21,t.BottomExt_Top=22,t.BottomExt_Bottom=23,t.Size=24,t}(),function(){function t(){}return n(t,"fairygui.ScrollBarDisplayType"),t.parse=function(t){switch(t){case"default":return 0;case"visible":return 1;case"auto":return 2;case"hidden":return 3;default:return 0}},t.Default=0,t.Visible=1,t.Auto=2,t.Hidden=3,t}()),U=function(){function t(t,i,s,n,h,r,o){if(this._owner=null,this._container=null,this._maskHolder=null,this._maskContentHolder=null,this._maskWidth=0,this._maskHeight=0,this._contentWidth=0,this._contentHeight=0,this._scrollType=0,this._scrollSpeed=0,this._mouseWheelSpeed=0,this._scrollBarMargin=null,this._bouncebackEffect=!1,this._touchEffect=!1,this._scrollBarDisplayAuto=!1,this._vScrollNone=!1,this._hScrollNone=!1,this._displayOnLeft=!1,this._snapToItem=!1,this._displayInDemand=!1,this._mouseWheelEnabled=!1,this._pageMode=!1,this._pageSizeH=NaN,this._pageSizeV=NaN,this._yPerc=NaN,this._xPerc=NaN,this._vScroll=!1,this._hScroll=!1,this._needRefresh=!1,this._tweening=NaN,this._tweenHelper=null,this._tweener=null,this._time1=NaN,this._time2=NaN,this._y1=NaN,this._y2=NaN,this._yOverlap=NaN,this._yOffset=NaN,this._x1=NaN,this._x2=NaN,this._xOverlap=NaN,this._xOffset=NaN,this._isMouseMoved=!1,this._holdAreaPoint=null,this._isHoldAreaDone=!1,this._aniFlag=!1,this._scrollBarVisible=!1,this._hzScrollBar=null,this._vtScrollBar=null,null==fairygui.ScrollPane._easeTypeFunc&&(fairygui.ScrollPane._easeTypeFunc=d.cubicOut),this._tweenHelper=new e,this._owner=t,this._container=this._owner.displayObject,this._maskHolder=new g,this._container.addChild(this._maskHolder),this._maskContentHolder=this._owner._container,this._maskContentHolder.pos(0,0),this._maskHolder.addChild(this._maskContentHolder),this._scrollType=i,this._scrollBarMargin=s,this._bouncebackEffect=Q.defaultScrollBounceEffect,this._touchEffect=Q.defaultScrollTouchEffect,this._scrollSpeed=Q.defaultScrollSpeed,this._mouseWheelSpeed=2*this._scrollSpeed,this._displayOnLeft=0!=(1&h),this._snapToItem=0!=(2&h),this._displayInDemand=0!=(4&h),this._pageMode=0!=(8&h),16&h?this._touchEffect=!0:32&h?this._touchEffect=!1:this._touchEffect=Q.defaultScrollTouchEffect,64&h?this._bouncebackEffect=!0:128&h?this._bouncebackEffect=!1:this._bouncebackEffect=Q.defaultScrollBounceEffect,this._xPerc=0,this._yPerc=0,this._aniFlag=!0,this._scrollBarVisible=!0,this._mouseWheelEnabled=!0,this._holdAreaPoint=new a,0==n&&(n=Q.defaultScrollBarDisplay),3!=n){if(2==this._scrollType||1==this._scrollType){var l=r?r:Q.verticalScrollBar;if(l){if(this._vtScrollBar=Z.createObjectFromURL(l),!this._vtScrollBar)throw"cannot create scrollbar from "+l;this._vtScrollBar.setScrollPane(this,!0),this._container.addChild(this._vtScrollBar.displayObject)}}if((2==this._scrollType||0==this._scrollType)&&(l=o?o:Q.horizontalScrollBar)){if(this._hzScrollBar=Z.createObjectFromURL(l),!this._hzScrollBar)throw"cannot create scrollbar from "+l;this._hzScrollBar.setScrollPane(this,!1),this._container.addChild(this._hzScrollBar.displayObject)}this._scrollBarDisplayAuto=2==n,this._scrollBarDisplayAuto&&(this._scrollBarVisible=!1,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=!1))}this._contentWidth=0,this._contentHeight=0,this.setSize(t.width,t.height,!0),this._owner.on("mousedown",this,this.__mouseDown),this._owner.on("mousewheel",this,this.__mouseWheel)}var e;n(t,"fairygui.ScrollPane");var r=t.prototype;return r.setPercX=function(t,e){void 0===e&&(e=!1),t>1?t=1:0>t&&(t=0),t!=this._xPerc&&(this._xPerc=t,this.posChanged(e))},r.setPercY=function(t,e){void 0===e&&(e=!1),t>1?t=1:0>t&&(t=0),t!=this._yPerc&&(this._yPerc=t,this.posChanged(e))},r.setPosX=function(t,e){void 0===e&&(e=!1),this._contentWidth>this._maskWidth?this.setPercX(t/(this._contentWidth-this._maskWidth),e):this.setPercX(0,e)},r.setPosY=function(t,e){void 0===e&&(e=!1),this._contentHeight>this._maskHeight?this.setPercY(t/(this._contentHeight-this._maskHeight),e):this.setPercY(0,e)},r.getDeltaX=function(t){return t/(this._contentWidth-this._maskWidth)},r.getDeltaY=function(t){return t/(this._contentHeight-this._maskHeight)},r.scrollTop=function(t){void 0===t&&(t=!1),this.setPercY(0,t)},r.scrollBottom=function(t){void 0===t&&(t=!1),this.setPercY(1,t)},r.scrollUp=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc-this.getDeltaY(this._scrollSpeed*t),e)},r.scrollDown=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercY(this._yPerc+this.getDeltaY(this._scrollSpeed*t),e)},r.scrollLeft=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc-this.getDeltaX(this._scrollSpeed*t),e)},r.scrollRight=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this.setPercX(this._xPerc+this.getDeltaX(this._scrollSpeed*t),e)},r.scrollToView=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh();var s;if(t instanceof fairygui.GObject?t.parent!=this._owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,fairygui.ScrollPane.sHelperRect),s=this._owner.globalToLocalRect(fairygui.ScrollPane.sHelperRect.x,fairygui.ScrollPane.sHelperRect.y,fairygui.ScrollPane.sHelperRect.width,fairygui.ScrollPane.sHelperRect.height,fairygui.ScrollPane.sHelperRect)):(s=fairygui.ScrollPane.sHelperRect,s.setTo(t.x,t.y,t.width,t.height)):s=t,this._vScroll){var n=this.posY,h=n+this._maskHeight;i||s.y<n||s.height>=this._maskHeight?this._pageMode?this.setPosY(Math.floor(s.y/this._pageSizeV)*this._pageSizeV,e):this.setPosY(s.y,e):s.y+s.height>h&&(this._pageMode?this.setPosY(Math.floor(s.y/this._pageSizeV)*this._pageSizeV,e):s.height<=this._maskHeight/2?this.setPosY(s.y+2*s.height-this._maskHeight,e):this.setPosY(s.y+s.height-this._maskHeight,e))}if(this._hScroll){var r=this.posX,a=r+this._maskWidth;i||s.x<r||s.width>=this._maskWidth?this._pageMode?this.setPosX(Math.floor(s.x/this._pageSizeH)*this._pageSizeH,e):this.setPosX(s.x,e):s.x+s.width>a&&(this._pageMode?this.setPosX(Math.floor(s.x/this._pageSizeH)*this._pageSizeH,e):s.width<=this._maskWidth/2?this.setPosX(s.x+2*s.width-this._maskWidth,e):this.setPosX(s.x+s.width-this._maskWidth,e))}!e&&this._needRefresh&&this.refresh()},r.isChildInView=function(t){var e=NaN;return this._vScroll&&(e=t.y+this._maskContentHolder.y,e<-t.height-20||e>this._maskHeight+20)?!1:!(this._hScroll&&(e=t.x+this._maskContentHolder.x,e<-t.width-20||e>this._maskWidth+20))},r.setSize=function(t,e,i){void 0===i&&(i=!1),this._displayOnLeft&&this._vtScrollBar?this._maskHolder.x=Math.floor(this._owner.margin.left+this._vtScrollBar.width):this._maskHolder.x=this._owner.margin.left,this._maskHolder.y=this._owner.margin.top,this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._maskWidth=t,this._maskHeight=e,this._hzScrollBar&&!this._hScrollNone&&(this._maskHeight-=this._hzScrollBar.height),this._vtScrollBar&&!this._vScrollNone&&(this._maskWidth-=this._vtScrollBar.width),this._maskWidth-=this._owner.margin.left+this._owner.margin.right,this._maskHeight-=this._owner.margin.top+this._owner.margin.bottom,this._maskWidth=Math.max(1,this._maskWidth),this._maskHeight=Math.max(1,this._maskHeight),this._pageSizeH=this._maskWidth,this._pageSizeV=this._maskHeight,this.handleSizeChanged(),i||this.posChanged(!1)},r.setContentSize=function(t,e){this._contentWidth==t&&this._contentHeight==e||(this._contentWidth=t,this._contentHeight=e,this.handleSizeChanged(),this._aniFlag=!1,this.refresh())},r.handleSizeChanged=function(){switch(this._displayInDemand&&(this._vtScrollBar&&(this._contentHeight<=this._maskHeight?this._vScrollNone||(this._vScrollNone=!0,this._maskWidth+=this._vtScrollBar.width):this._vScrollNone&&(this._vScrollNone=!1,this._maskWidth-=this._vtScrollBar.width)),this._hzScrollBar&&(this._contentWidth<=this._maskWidth?this._hScrollNone||(this._hScrollNone=!0,this._maskHeight+=this._vtScrollBar.height):this._hScrollNone&&(this._hScrollNone=!1,this._maskHeight-=this._vtScrollBar.height))),this._vtScrollBar&&(this._maskHeight<this._vtScrollBar.minSize?this._vtScrollBar.displayObject.visible=!1:(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone,0==this._contentHeight?this._vtScrollBar.displayPerc=0:this._vtScrollBar.displayPerc=Math.min(1,this._maskHeight/this._contentHeight))),this._hzScrollBar&&(this._maskWidth<this._hzScrollBar.minSize?this._hzScrollBar.displayObject.visible=!1:(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone,0==this._contentWidth?this._hzScrollBar.displayPerc=0:this._hzScrollBar.displayPerc=Math.min(1,this._maskWidth/this._contentWidth))),null==this._maskHolder.mask?(this._maskHolder.mask=new g,this._maskHolder.mask.graphics.drawRect(0,0,this._maskWidth,this._maskHeight,"#000000")):(this._maskHolder.mask.graphics.clear(),this._maskHolder.mask.graphics.drawRect(0,0,this._maskWidth,this._maskHeight,"#000000")),this._xOverlap=Math.max(0,this._contentWidth-this._maskWidth),this._yOverlap=Math.max(0,this._contentHeight-this._maskHeight),this._scrollType){case 2:this._contentWidth>this._maskWidth&&this._contentHeight<=this._maskHeight?(this._hScroll=!0,this._vScroll=!1):this._contentWidth<=this._maskWidth&&this._contentHeight>this._maskHeight?(this._hScroll=!1,this._vScroll=!0):this._contentWidth>this._maskWidth&&this._contentHeight>this._maskHeight?(this._hScroll=!0,this._vScroll=!0):(this._hScroll=!1,this._vScroll=!1);break;case 1:this._contentHeight>this._maskHeight?(this._hScroll=!1,this._vScroll=!0):(this._hScroll=!1,this._vScroll=!1);break;case 0:this._contentWidth>this._maskWidth?(this._hScroll=!0,this._vScroll=!1):(this._hScroll=!1,this._vScroll=!1)}},r.posChanged=function(t){this._aniFlag&&(this._aniFlag=t),this._needRefresh=!0,i.timer.callLater(this,this.refresh),2==this._tweening&&this.killTweens()},r.refresh=function(){this._needRefresh=!1,i.timer.clear(this,this.refresh);var t=0,e=0;if(this._vScroll&&(t=this._yPerc*(this._contentHeight-this._maskHeight)),this._hScroll&&(e=this._xPerc*(this._contentWidth-this._maskWidth)),this._pageMode){var s=NaN,n=NaN;this._vScroll&&1!=this._yPerc&&0!=this._yPerc&&(s=Math.floor(t/this._pageSizeV),n=t-s*this._pageSizeV,n>this._pageSizeV/2&&s++,t=s*this._pageSizeV,t>this._contentHeight-this._maskHeight?(t=this._contentHeight-this._maskHeight,this._yPerc=1):this._yPerc=t/(this._contentHeight-this._maskHeight)),this._hScroll&&1!=this._xPerc&&0!=this._xPerc&&(s=Math.floor(e/this._pageSizeH),n=e-s*this._pageSizeH,n>this._pageSizeH/2&&s++,e=s*this._pageSizeH,e>this._contentWidth-this._maskWidth?(e=this._contentWidth-this._maskWidth,this._xPerc=1):this._xPerc=e/(this._contentWidth-this._maskWidth))}else if(this._snapToItem){var h=this._owner.getSnappingPosition(e,t,fairygui.ScrollPane.sHelperPoint);1!=this._xPerc&&h.x!=e&&(this._xPerc=h.x/(this._contentWidth-this._maskWidth),this._xPerc>1&&(this._xPerc=1),e=this._xPerc*(this._contentWidth-this._maskWidth)),1!=this._yPerc&&h.y!=t&&(this._yPerc=h.y/(this._contentHeight-this._maskHeight),this._yPerc>1&&(this._yPerc=1),t=this._yPerc*(this._contentHeight-this._maskHeight))}this.refresh2(e,t),A.dispatch("fui_scroll",this._container),this._needRefresh&&(this._needRefresh=!1,i.timer.clear(this,this.refresh),this._hScroll&&(e=this._xPerc*(this._contentWidth-this._maskWidth)),this._vScroll&&(t=this._yPerc*(this._contentHeight-this._maskHeight)),this.refresh2(e,t)),this._aniFlag=!0},r.refresh2=function(t,e){if(t=Math.floor(t),e=Math.floor(e),this._aniFlag&&!this._isMouseMoved){var i=this._maskContentHolder.x,s=this._maskContentHolder.y;this._vScroll?s=-e:0!=this._maskContentHolder.y&&(this._maskContentHolder.y=0),this._hScroll?i=-t:0!=this._maskContentHolder.x&&(this._maskContentHolder.x=0),i==this._maskContentHolder.x&&s==this._maskContentHolder.y||(this.killTweens(),this._maskHolder.mouseEnabled=!1,this._tweening=1,this._tweener=c.to(this._maskContentHolder,{x:i,y:s},500,fairygui.ScrollPane._easeTypeFunc,u.create(this,this.__tweenComplete)),this._tweener.update=u.create(this,this.__tweenUpdate,null,!1))}else this.killTweens(),this._isMouseMoved&&(this._xOffset+=this._maskContentHolder.x- -t,this._yOffset+=this._maskContentHolder.y- -e),this._maskContentHolder.pos(-t,-e),this._isMouseMoved&&(this._y1=this._y2=this._maskContentHolder.y,this._x1=this._x2=this._maskContentHolder.x),this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc)},r.killTweens=function(){1==this._tweening?(this._tweening=0,this._tweener.clear()):2==this._tweening&&(this._tweening=0,this._tweener.clear(),this._tweenHelper.value=1,this.__tweenUpdate2(),this.__tweenComplete2())},r.calcYPerc=function(){if(!this._vScroll)return 0;var t=this._contentHeight-this._maskHeight,e=this._maskContentHolder.y,i=NaN;return i=e>0?0:-e>t?t:-e,i/t},r.calcXPerc=function(){if(!this._hScroll)return 0;var t=this._contentWidth-this._maskWidth,e=NaN,i=this._maskContentHolder.x;return e=i>0?0:-i>t?t:-i,e/t},r.onScrolling=function(){this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this.calcYPerc(),this._scrollBarDisplayAuto&&this.showScrollBar(!0)),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this.calcXPerc(),this._scrollBarDisplayAuto&&this.showScrollBar(!0))},r.onScrollEnd=function(){this._vtScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._hzScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1)},r.__mouseDown=function(){this._touchEffect&&(this.killTweens(),this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint),this._x1=this._x2=this._maskContentHolder.x,this._y1=this._y2=this._maskContentHolder.y,this._xOffset=fairygui.ScrollPane.sHelperPoint.x-this._maskContentHolder.x,this._yOffset=fairygui.ScrollPane.sHelperPoint.y-this._maskContentHolder.y,this._time1=this._time2=i.timer.currTimer,this._holdAreaPoint.x=fairygui.ScrollPane.sHelperPoint.x,this._holdAreaPoint.y=fairygui.ScrollPane.sHelperPoint.y,this._isHoldAreaDone=!1,this._isMouseMoved=!1,this._owner.displayObject.stage.on("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.on("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.on("click",this,this.__click))},r.__mouseMove=function(){var t=Q.touchScrollSensitivity,e=NaN,s=!1,n=!1,h=!1,r=this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint);if(1==this._scrollType){if(!this._isHoldAreaDone&&(e=Math.abs(this._holdAreaPoint.y-r.y),t>e))return;s=!0}else if(0==this._scrollType){if(!this._isHoldAreaDone&&(e=Math.abs(this._holdAreaPoint.x-r.x),t>e))return;n=!0}else{if(!this._isHoldAreaDone&&(e=Math.abs(this._holdAreaPoint.y-r.y),t>e&&(e=Math.abs(this._holdAreaPoint.x-r.x),t>e)))return;s=n=!0}var a=i.timer.currTimer;if(a-this._time2>50&&(this._time2=this._time1,this._time1=a,h=!0),s){var o=Math.floor(r.y-this._yOffset);o>0?this._bouncebackEffect?this._maskContentHolder.y=Math.floor(.5*o):this._maskContentHolder.y=0:o<-this._yOverlap?this._bouncebackEffect?this._maskContentHolder.y=Math.floor(.5*(o-this._yOverlap)):this._maskContentHolder.y=-Math.floor(this._yOverlap):this._maskContentHolder.y=o,h&&(this._y2=this._y1,this._y1=this._maskContentHolder.y),this._yPerc=this.calcYPerc()}if(n){var l=Math.floor(r.x-this._xOffset);l>0?this._bouncebackEffect?this._maskContentHolder.x=Math.floor(.5*l):this._maskContentHolder.x=0:l<0-this._xOverlap?this._bouncebackEffect?this._maskContentHolder.x=Math.floor(.5*(l-this._xOverlap)):this._maskContentHolder.x=-Math.floor(this._xOverlap):this._maskContentHolder.x=l,h&&(this._x2=this._x1,this._x1=this._maskContentHolder.x),this._xPerc=this.calcXPerc()}this._maskHolder.mouseEnabled=!1,this._isHoldAreaDone=!0,this._isMouseMoved=!0,this.onScrolling(),A.dispatch("fui_scroll",this._container)},r.__mouseUp=function(){if(this._owner.displayObject.stage.off("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.off("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.off("click",this,this.__click),!this._touchEffect)return void(this._isMouseMoved=!1);if(this._isMouseMoved){var t=(i.timer.currTimer-this._time2)/1e3;0==t&&(t=.001);var s=(this._maskContentHolder.y-this._y2)/t,n=(this._maskContentHolder.x-this._x2)/t,h=.3;this._tweenHelper.start.x=this._maskContentHolder.x,this._tweenHelper.start.y=this._maskContentHolder.y;var r=this._tweenHelper.change1,a=this._tweenHelper.change2,o=0,l=0,_=0,d=0;if(2==this._scrollType||0==this._scrollType?(r.x=e.calculateChange(n,h),a.x=0,o=this._maskContentHolder.x+r.x,this._pageMode&&(_=Math.floor(-o/this._pageSizeH),d=-o-_*this._pageSizeH,r.x>this._pageSizeH?d>=this._pageSizeH/2&&_++:o<this._maskContentHolder.x&&d>=this._pageSizeH/2&&_++,o=-_*this._pageSizeH,o<this._maskWidth-this._contentWidth&&(o=this._maskWidth-this._contentWidth),r.x=o-this._maskContentHolder.x)):r.x=a.x=0,2==this._scrollType||1==this._scrollType?(r.y=e.calculateChange(s,h),a.y=0,l=this._maskContentHolder.y+r.y,this._pageMode&&(_=Math.floor(-l/this._pageSizeV),d=-l-_*this._pageSizeV,r.y>this._pageSizeV?d>=this._pageSizeV/2&&_++:l<this._maskContentHolder.y&&d>=this._pageSizeV/2&&_++,l=-_*this._pageSizeV,l<this._maskHeight-this._contentHeight&&(l=this._maskHeight-this._contentHeight),r.y=l-this._maskContentHolder.y)):r.y=a.y=0,this._snapToItem){o=-o,l=-l;var g=this._owner.getSnappingPosition(o,l,fairygui.ScrollPane.sHelperPoint);o=-g.x,l=-g.y,r.x=o-this._maskContentHolder.x,r.y=l-this._maskContentHolder.y}this._bouncebackEffect?(o>0?a.x=0-this._maskContentHolder.x-r.x:o<-this._xOverlap&&(a.x=-this._xOverlap-this._maskContentHolder.x-r.x),l>0?a.y=0-this._maskContentHolder.y-r.y:l<-this._yOverlap&&(a.y=-this._yOverlap-this._maskContentHolder.y-r.y)):(o>0?r.x=0-this._maskContentHolder.x:o<-this._xOverlap&&(r.x=-this._xOverlap-this._maskContentHolder.x),l>0?r.y=0-this._maskContentHolder.y:l<-this._yOverlap&&(r.y=-this._yOverlap-this._maskContentHolder.y)),this._tweenHelper.value=0,this._tweenHelper.change1=r,this._tweenHelper.change2=a,this.killTweens(),this._tweening=2,this._tweener=c.to(this._tweenHelper,{value:1},1e3*h,fairygui.ScrollPane._easeTypeFunc,u.create(this,this.__tweenComplete2)),this._tweener.update=u.create(this,this.__tweenUpdate2,null,!1)}},r.__click=function(){this._isMouseMoved=!1},r.__mouseWheel=function(t){if(this._mouseWheelEnabled){var e=(this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint),t.delta);this._hScroll&&!this._vScroll?0>e?this.setPercX(this._xPerc+this.getDeltaX(this._mouseWheelSpeed),!1):this.setPercX(this._xPerc-this.getDeltaX(this._mouseWheelSpeed),!1):0>e?this.setPercY(this._yPerc+this.getDeltaY(this._mouseWheelSpeed),!1):this.setPercY(this._yPerc-this.getDeltaY(this._mouseWheelSpeed),!1)}},r.__rollOver=function(){this.showScrollBar(!0)},r.__rollOut=function(){this.showScrollBar(!1)},r.showScrollBar=function(t){t?(this.__showScrollBar(!0),i.timer.clear(this,this.__showScrollBar)):i.timer.once(500,this,this.__showScrollBar,[t])},r.__showScrollBar=function(t){this._scrollBarVisible=t&&this._maskWidth>0&&this._maskHeight>0,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone)},r.__tweenUpdate=function(){this.onScrolling()},r.__tweenComplete=function(){this._tweening=0,this._maskHolder.mouseEnabled=!0,this.onScrollEnd()},r.__tweenUpdate2=function(){this._maskContentHolder.pos(Math.floor(this._tweenHelper.start.x+this._tweenHelper.change1.x*this._tweenHelper.value+this._tweenHelper.change2.x*this._tweenHelper.value*this._tweenHelper.value),Math.floor(this._tweenHelper.start.y+this._tweenHelper.change1.y*this._tweenHelper.value+this._tweenHelper.change2.y*this._tweenHelper.value*this._tweenHelper.value)),1==this._scrollType?this._yPerc=this.calcYPerc():0==this._scrollType?this._xPerc=this.calcXPerc():(this._yPerc=this.calcYPerc(),this._xPerc=this.calcXPerc()),this.onScrolling(),A.dispatch("fui_scroll",this._container)},r.__tweenComplete2=function(){0!=this._tweening&&(this._tweening=0,1==this._scrollType?this._yPerc=this.calcYPerc():0==this._scrollType?this._xPerc=this.calcXPerc():(this._yPerc=this.calcYPerc(),this._xPerc=this.calcXPerc()),this._maskHolder.mouseEnabled=!0,this.onScrollEnd(),A.dispatch("fui_scroll",this._container))},h(0,r,"owner",function(){return this._owner}),h(0,r,"bouncebackEffect",function(){return this._bouncebackEffect},function(t){this._bouncebackEffect=t}),h(0,r,"scrollSpeed",function(){return this._scrollSpeed},function(t){this._scrollSpeed=this.scrollSpeed,0==this._scrollSpeed&&(this._scrollSpeed=Q.defaultScrollSpeed),this._mouseWheelSpeed=2*this._scrollSpeed}),h(0,r,"snapToItem",function(){return this._snapToItem},function(t){this._snapToItem=t}),h(0,r,"touchEffect",function(){return this._touchEffect},function(t){this._touchEffect=t}),h(0,r,"percX",function(){return this._xPerc},function(t){this.setPercX(t,!1)}),h(0,r,"percY",function(){return this._yPerc},function(t){this.setPercY(t,!1)}),h(0,r,"posX",function(){return this._xPerc*Math.max(0,this.contentWidth-this._maskWidth)},function(t){this.setPosX(t,!1)}),h(0,r,"posY",function(){return this._yPerc*Math.max(0,this._contentHeight-this._maskHeight);
},function(t){this.setPosY(t,!1)}),h(0,r,"isBottomMost",function(){return 1==this._yPerc||this._maskHeight<=this._maskHeight}),h(0,r,"isRightMost",function(){return 1==this._xPerc||this._contentWidth<=this._maskWidth}),h(0,r,"currentPageX",function(){return this._pageMode?Math.floor(this.posX/this._pageSizeH):0},function(t){this._pageMode&&this._hScroll&&this.setPosX(t*this._pageSizeH,!1)}),h(0,r,"currentPageY",function(){return this._pageMode?Math.floor(this.posY/this._pageSizeV):0},function(t){this._pageMode&&this._hScroll&&this.setPosY(t*this._pageSizeV,!1)}),h(0,r,"contentWidth",function(){return this._contentWidth}),h(0,r,"contentHeight",function(){return this._contentHeight}),h(0,r,"viewWidth",function(){return this._maskWidth},function(t){t=t+this._owner.margin.left+this._owner.margin.right,null!=this._vtScrollBar&&(t+=this._vtScrollBar.width),this._owner.width=t}),h(0,r,"viewHeight",function(){return this._maskHeight},function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,null!=this._hzScrollBar&&(t+=this._hzScrollBar.height),this._owner.height=t}),t._easeTypeFunc=null,s(t,["sHelperRect",function(){return this.sHelperRect=new f},"sHelperPoint",function(){return this.sHelperPoint=new a}]),t.__init$=function(){e=function(){function t(){this.value=NaN,this.start=null,this.change1=null,this.change2=null,this.start=new a,this.change1=new a,this.change2=new a}return n(t,""),t.calculateChange=function(e,i){return i*t.checkpoint*e/t.easeOutCubic(t.checkpoint,0,1,1)},t.easeOutCubic=function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},t.checkpoint=.05,t}()},t}(),$=function(){function t(){}return n(t,"fairygui.ScrollType"),t.parse=function(t){switch(t){case"horizontal":return 0;case"vertical":return 1;case"both":return 2;default:return 1}},t.Horizontal=0,t.Vertical=1,t.Both=2,t}(),q=function(){function t(t){this.name=null,this.autoPlay=!1,this.autoPlayRepeat=1,this.autoPlayDelay=0,this._owner=null,this._ownerBaseX=0,this._ownerBaseY=0,this._items=null,this._totalTimes=0,this._totalTasks=0,this._playing=!1,this._onComplete=null,this._options=0,this._reversed=!1,this._maxTime=0,this.OPTION_IGNORE_DISPLAY_CONTROLLER=1,this.FRAME_RATE=24,this._owner=t,this._items=[]}var e,s,r;n(t,"fairygui.Transition");var a=t.prototype;return a.play=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=0),this._play(t,e,i,!1)},a.playReverse=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=0),this._play(t,e,i,!0)},a._play=function(t,e,i,s){if(void 0===e&&(e=1),void 0===i&&(i=0),void 0===s&&(s=!1),this.stop(),0==e?e=1:-1==e&&(e=Number.MAX_VALUE),this._totalTimes=e,this._reversed=s,this.internalPlay(i),this._playing=this._totalTasks>0,this._playing){if(this._onComplete=t,this._owner.internalVisible++,0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var n=this._items.length,h=0;n>h;h++){var r=this._items[h];null!=r.target&&r.target!=this._owner&&r.target.internalVisible++}}else null!=t&&t.run()},a.stop=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete;this._onComplete=null,this._owner.internalVisible--;var s,n=this._items.length,h=NaN;if(this._reversed)for(h=n-1;h>=0;h--)s=this._items[h],null!=s.target&&this.stopItem(s,t);else for(h=0;n>h;h++)s=this._items[h],null!=s.target&&this.stopItem(s,t);e&&null!=i&&i.run()}},a.stopItem=function(t,e){if(0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER)&&t.target!=this._owner&&t.target.internalVisible--,!t.completed)if(null!=t.tweener&&(t.tweener.clear(),t.tweener=null),11==t.type){var s=t.target.getTransition(t.value.s);null!=s&&s.stop(e,!1)}else 12==t.type?(i.timer.clear(t,t.__shake),t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target._gearLocked=!1):e&&(t.tween?t.yoyo&&t.repeat%2!=0?this.applyValue(t,this._reversed?t.endValue:t.startValue):this.applyValue(t,this._reversed?t.startValue:t.endValue):10!=t.type&&this.applyValue(t,t.value))},a.setValue=function(t,e){for(var i=[],s=1,n=arguments.length;n>s;s++)i.push(arguments[s]);for(var h,r=this._items.length,s=0;r>s;s++){var a=this._items[s];if(null!=a.label||null!=a.label2){if(a.label==t)h=a.tween?a.startValue:a.value;else{if(a.label2!=t)continue;h=a.endValue}switch(a.type){case 0:case 1:case 3:case 2:h.b1=!0,h.b2=!0,h.f1=parseFloat(i[0]),h.f2=parseFloat(i[1]);break;case 4:h.f1=parseFloat(i[0]);break;case 5:h.i=parseInt(i[0]);break;case 6:h.s=i[0];break;case 7:h.i=parseInt(i[0]),i.length>1&&(h.b=i[1]);break;case 8:h.b=i[0];break;case 9:h.s=i[0];break;case 10:h.s=i[0],i.length>1&&(h.f1=parseFloat(i[1]));break;case 11:h.s=i[0],i.length>1&&(h.i=parseInt(i[1]));break;case 12:h.f1=parseFloat(i[0]),i.length>1&&(h.f2=parseFloat(i[1]))}}}},a.setHook=function(t,e){for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];null==n.label&&null==n.label2||(n.label==t?n.hook=e:n.label2==t&&(n.hook2=e))}},a.clearHooks=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.hook=null,i.hook2=null}},a.setTarget=function(t,e){for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];null==n.label&&null==n.label2||(n.targetId=e.id)}},a.updateFromRelations=function(t,e,i){var s=this._items.length;if(0!=s)for(var n=0;s>n;n++){var h=this._items[n];0==h.type&&h.targetId==t&&(h.tween?(h.startValue.f1+=e,h.startValue.f2+=i,h.endValue.f1+=e,h.endValue.f2+=i):(h.value.f1+=e,h.value.f2+=i))}},a.internalPlay=function(t){void 0===t&&(t=0),this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;for(var e,i=this._items.length,s=NaN,n=0;i>n;n++)e=this._items[n],e.targetId?e.target=this._owner.getChildById(e.targetId):e.target=this._owner,null!=e.target&&(e.tween?(s=this._reversed?t+1e3*(this._maxTime-e.time-e.duration):t+1e3*e.time,e.completed=!1,this._totalTasks++,0==s?this.startTween(e):(e.tweener=c.to(e.value,{},s,null,u.create(this,this.__delayCall,[e])),e.tweener.update=null)):(s=this._reversed?t+1e3*(this._maxTime-e.time):t+1e3*e.time,0==s?this.applyValue(e,e.value):(e.completed=!1,this._totalTasks++,e.tweener=c.to(e.value,{},s,null,u.create(this,this.__delayCall2,[e])),e.tweener.update=null)))},a.prepareValue=function(t,e,i){if(void 0===i&&(i=!1),i)switch(t.type){case 0:case 1:case 2:e.f1=t.startValue.f1,e.f2=t.startValue.f2;case 4:e.f1=t.startValue.f1;break;case 5:e.i=t.startValue.i}else switch(t.type){case 0:t.target==this._owner?(t.startValue.b1||(t.startValue.f1=0),t.startValue.b2||(t.startValue.f2=0)):(t.startValue.b1||(t.startValue.f1=t.target.x),t.startValue.b2||(t.startValue.f2=t.target.y)),t.value.f1=t.startValue.f1,t.value.f2=t.startValue.f2,t.endValue.b1||(t.endValue.f1=t.value.f1),t.endValue.b2||(t.endValue.f2=t.value.f2),e.f1=t.endValue.f1,e.f2=t.endValue.f2;break;case 1:t.startValue.b1||(t.startValue.f1=t.target.width),t.startValue.b2||(t.startValue.f2=t.target.height),t.value.f1=t.startValue.f1,t.value.f2=t.startValue.f2,t.endValue.b1||(t.endValue.f1=t.value.f1),t.endValue.b2||(t.endValue.f2=t.value.f2),e.f1=t.endValue.f1,e.f2=t.endValue.f2;break;case 2:t.value.f1=t.startValue.f1,t.value.f2=t.startValue.f2,e.f1=t.endValue.f1,e.f2=t.endValue.f2;break;case 4:t.value.f1=t.startValue.f1,e.f1=t.endValue.f1;break;case 5:t.value.i=t.startValue.i,e.i=t.endValue.i}e.dummy=0},a.startTween=function(t){var e={};this.prepareValue(t,e,this._reversed),this.applyValue(t,t.value);var i;0!=t.repeat?(t.tweenTimes=0,i=u.create(this,this.__tweenRepeatComplete,[t])):i=u.create(this,this.__tweenComplete,[t]),t.tweener=c.to(t.value,e,1e3*t.duration,t.easeType,i),t.tweener.update=u.create(this,this.__tweenUpdate,[t],!1),null!=t.hook&&t.hook.run()},a.__delayCall=function(t){t.tweener=null,this.startTween(t)},a.__delayCall2=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,this.applyValue(t,t.value),null!=t.hook&&t.hook.run(),this.checkAllComplete()},a.__tweenUpdate=function(t){this.applyValue(t,t.value)},a.__tweenComplete=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,null!=t.hook2&&t.hook2.run(),this.checkAllComplete()},a.__tweenRepeatComplete=function(t){if(t.tweenTimes++,-1==t.repeat||t.tweenTimes<t.repeat+1){var e={},i=!1;i=t.yoyo?this._reversed?t.tweenTimes%2==0:t.tweenTimes%2==1:this._reversed,this.prepareValue(t,e,i),t.tweener=c.to(t.value,e,1e3*t.duration,t.easeType,u.create(this,this.__tweenRepeatComplete,[t])),t.tweener.update=u.create(this,this.__tweenUpdate,[t],!1)}else this.__tweenComplete(t)},a.__playTransComplete=function(t){this._totalTasks--,t.completed=!0,this.checkAllComplete()},a.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)i.timer.callLater(this,this.internalPlay);else if(this._totalTimes--,this._totalTimes>0)i.timer.callLater(this,this.internalPlay);else{this._playing=!1,this._owner.internalVisible--;var t=this._items.length;if(0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var e=0;t>e;e++){var s=this._items[e];null!=s.target&&s.target!=this._owner&&s.target.internalVisible--}if(null!=this._onComplete){var n=this._onComplete;this._onComplete=null,n.run()}}},a.applyValue=function(t,e){switch(t.target._gearLocked=!0,t.type){case 0:if(t.target==this._owner){var s=0,n=0;s=e.b1?e.f1+this._ownerBaseX:t.target.x,n=e.b2?e.f2+this._ownerBaseY:t.target.y,t.target.setXY(s,n)}else e.b1||(e.f1=t.target.x),e.b2||(e.f2=t.target.y),t.target.setXY(e.f1,e.f2);break;case 1:e.b1||(e.f1=t.target.width),e.b2||(e.f2=t.target.height),t.target.setSize(e.f1,e.f2);break;case 3:t.target.setPivot(e.f1,e.f2);break;case 4:t.target.alpha=e.f1;break;case 5:t.target.rotation=e.i;break;case 2:t.target.setScale(e.f1,e.f2);break;case 6:t.target.color=e.s;break;case 7:e.b1||(e.i=t.target.frame),t.target.frame=e.i,t.target.playing=e.b;break;case 8:t.target.visible=e.b;break;case 9:for(var h=e.s.split(","),r=h.length,a=0;r>a;a++){var o=h[a],l=o.split("="),_=t.target.getController(l[0]);_&&(o=l[1],"$"==o.charAt(0)?(o=o.substring(1),_.selectedPage=o):_.selectedIndex=parseInt(o))}break;case 11:var c=t.target.getTransition(e.s);null!=c&&(0==e.i?c.stop(!1,!0):c.playing?c._totalTimes=-1==e.i?Number.MAX_VALUE:e.i:(t.completed=!1,this._totalTasks++,this._reversed?c.playReverse(u.create(this,this.__playTransComplete,[t]),t.value.i):c.play(u.create(this,this.__playTransComplete,[t]),t.value.i)));break;case 10:var d=Z.getItemByURL(e.s);if(d){var g=d.owner.getItemAsset(d);g&&xt.inst.playOneShotSound(g,e.f1)}break;case 12:t.startValue.f1=0,t.startValue.f2=0,t.startValue.f3=t.value.f2,t.startValue.i=i.timer.currTimer,i.timer.frameLoop(1,t,t.__shake,[this]),this._totalTasks++,t.completed=!1}t.target._gearLocked=!1},a.__shakeItem=function(t){var e=Math.ceil(t.value.f1*t.startValue.f3/t.value.f2),s=(2*Math.random()-1)*e,n=(2*Math.random()-1)*e;s=s>0?Math.ceil(s):Math.floor(s),n=n>0?Math.ceil(n):Math.floor(n),t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1+s,t.target.y-t.startValue.f2+n),t.target._gearLocked=!1,t.startValue.f1=s,t.startValue.f2=n;var h=i.timer.currTimer;t.startValue.f3-=(h-t.startValue.i)/1e3,t.startValue.i=h,t.startValue.f3<=0&&(t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target._gearLocked=!1,t.completed=!0,this._totalTasks--,i.timer.clear(t,t.__shake),this.checkAllComplete())},a.setup=function(t){this.name=t.getAttribute("name");var e=t.getAttribute("options");e&&(this._options=parseInt(e)),e=t.getAttribute("autoPlay"),e&&(this.autoPlay="true"==e),this.autoPlay&&(e=t.getAttribute("autoPlayRepeat"),e&&(this.autoPlayRepeat=parseInt(e)),e=t.getAttribute("autoPlayDelay"),e&&(this.autoPlayDelay=parseFloat(e)));for(var i=t.childNodes,n=i.length,h=0;n>h;h++){var r=i[h];if("item"==r.nodeName){var a=new s;switch(this._items.push(a),a.time=parseInt(r.getAttribute("time"))/this.FRAME_RATE,a.targetId=r.getAttribute("target"),e=r.getAttribute("type")){case"XY":a.type=0;break;case"Size":a.type=1;break;case"Scale":a.type=2;break;case"Pivot":a.type=3;break;case"Alpha":a.type=4;break;case"Rotation":a.type=5;break;case"Color":a.type=6;break;case"Animation":a.type=7;break;case"Visible":a.type=8;break;case"Controller":a.type=9;break;case"Sound":a.type=10;break;case"Transition":a.type=11;break;case"Shake":a.type=12;break;default:a.type=13}if(a.tween="true"==r.getAttribute("tween"),a.label=r.getAttribute("label"),a.tween){a.duration=parseInt(r.getAttribute("duration"))/this.FRAME_RATE,a.time+a.duration>this._maxTime&&(this._maxTime=a.time+a.duration),e=r.getAttribute("ease"),e&&(a.easeType=J.parseEaseType(e)),e=r.getAttribute("repeat"),e&&(a.repeat=parseInt(e)),a.yoyo="true"==r.getAttribute("yoyo"),a.label2=r.getAttribute("label2");var o=r.getAttribute("endValue");o?(this.decodeValue(a.type,r.getAttribute("startValue"),a.startValue),this.decodeValue(a.type,o,a.endValue)):(a.tween=!1,this.decodeValue(a.type,r.getAttribute("startValue"),a.value))}else a.time>this._maxTime&&(this._maxTime=a.time),this.decodeValue(a.type,r.getAttribute("value"),a.value)}}},a.decodeValue=function(t,e,i){var s;switch(t){case 0:case 1:case 3:s=e.split(","),"-"==s[0]?i.b1=!1:(i.f1=parseFloat(s[0]),i.b1=!0),"-"==s[1]?i.b2=!1:(i.f2=parseFloat(s[1]),i.b2=!0);break;case 4:i.f1=parseFloat(e);break;case 5:i.i=parseInt(e);break;case 2:s=e.split(","),i.f1=parseFloat(s[0]),i.f2=parseFloat(s[1]);break;case 6:i.s=e;break;case 7:s=e.split(","),"-"==s[0]?i.b1=!1:(i.i=parseInt(s[0]),i.b1=!0),i.b="p"==s[1];break;case 8:i.b="true"==e;break;case 9:i.s=e;break;case 10:if(s=e.split(","),i.s=s[0],s.length>1){var n=parseInt(s[1]);0==n||100==n?i.f1=1:i.f1=n/100}else i.f1=1;break;case 11:s=e.split(","),i.s=s[0],s.length>1?i.i=parseInt(s[1]):i.i=1;break;case 12:s=e.split(","),i.f1=parseFloat(s[0]),i.f2=parseFloat(s[1])}},h(0,a,"playing",function(){return this._playing}),t.__init$=function(){e=function(){function t(){}return n(t,""),t.XY=0,t.Size=1,t.Scale=2,t.Pivot=3,t.Alpha=4,t.Rotation=5,t.Color=6,t.Animation=7,t.Visible=8,t.Controller=9,t.Sound=10,t.Transition=11,t.Shake=12,t.Unknown=13,t}(),s=function(){function t(){this.time=0,this.targetId=null,this.type=0,this.duration=0,this.value=null,this.startValue=null,this.endValue=null,this.easeType=null,this.repeat=0,this.yoyo=!1,this.tween=!1,this.label=null,this.label2=null,this.hook=null,this.hook2=null,this.tweenTimes=0,this.tweener=null,this.completed=!1,this.target=null,this.easeType=d.QuadOut,this.value=new r,this.startValue=new r,this.endValue=new r}n(t,"");var e=t.prototype;return e.__shake=function(t){t.__shakeItem(this)},t}(),r=function(){function t(){this.f1=0,this.f2=0,this.f3=0,this.i=0,this.b=!1,this.s=null,this.b1=!0,this.b2=!0}return n(t,""),t}()},t}(),Q=function(){function t(){}return n(t,"fairygui.UIConfig",null,"UIConfig1"),t.defaultFont="宋体",t.windowModalWaiting=null,t.globalModalWaiting=null,t.modalLayerColor="rgba(33,33,33,0.2)",t.buttonSound=null,t.buttonSoundVolumeScale=1,t.horizontalScrollBar=null,t.verticalScrollBar=null,t.defaultScrollSpeed=25,t.defaultScrollBarDisplay=1,t.defaultScrollTouchEffect=!0,t.defaultScrollBounceEffect=!0,t.popupMenu=null,t.popupMenu_seperator=null,t.loaderErrorSign=null,t.tooltipsWin=null,t.defaultComboBoxVisibleItemCount=10,t.touchScrollSensitivity=20,t.touchDragSensitivity=10,t.clickDragSensitivity=2,t.bringWindowToFrontOnClick=!0,t}(),K=function(){function t(){}return n(t,"fairygui.UIObjectFactory"),t.setPackageItemExtension=function(t,e){fairygui.UIObjectFactory.packageItemExtensions[t.substring(5)]=e},t.setLoaderExtension=function(t){fairygui.UIObjectFactory.loaderExtension=t},t.newObject=function(e){switch(e.type){case 0:return new ut;case 2:return new gt;case 4:var i=t.packageItemExtensions[e.owner.id+e.id];if(i)return new i;var s=e.owner.getItemAsset(e),n=s.getAttribute("extention");if(null==n)return new st;switch(n){case"Button":return new pt;case"Label":return new yt;case"ProgressBar":return new wt;case"Slider":return new It;case"ScrollBar":return new St;case"ComboBox":return new mt;default:return new st}}return null},t.newObject2=function(t){switch(t){case"image":return new ut;case"movieclip":return new gt;case"component":return new st;case"text":return new ft;case"richtext":return new bt;case"group":return new lt;case"list":return new vt;case"graph":return new rt;case"loader":return null!=fairygui.UIObjectFactory.loaderExtension?new fairygui.UIObjectFactory.loaderExtension:new dt}return null},t.packageItemExtensions={},t.loaderExtension=null,t}(),Z=function(){function t(){this._id=null,this._name=null,this._basePath=null,this._items=null,this._itemsById=null,this._itemsByName=null,this._resKey=null,this._resData=null,this._customId=null,this._sprites=null,this._items=[],this._sprites={}}var e;n(t,"fairygui.UIPackage");var s=t.prototype;return s.create=function(t){this._resKey=t,this.loadPackage()},s.loadPackage=function(){var t,s;this.decompressPackage(i.loader.getRes(this._resKey+".fui")),t=this.getDesc("sprites.bytes"),s=t.split("\n");for(var n=s.length,h=1;n>h;h++)if(t=s[h]){var r=t.split(" "),a=new e,o=r[0],l=parseInt(r[1]);if(l>=0)a.atlas="atlas"+l;else{var u=o.indexOf("_");-1==u?a.atlas="atlas_"+o:a.atlas="atlas_"+o.substr(0,u)}a.rect.x=parseInt(r[2]),a.rect.y=parseInt(r[3]),a.rect.width=parseInt(r[4]),a.rect.height=parseInt(r[5]),a.rotated="1"==r[6],this._sprites[o]=a}t=this.getDesc("package.xml");var _=m.parseXMLFromString(t),c=_.firstChild;this._id=c.getAttribute("id"),this._name=c.getAttribute("name");var d=J.findChildNode(c,"resources").childNodes;this._itemsById={},this._itemsByName={};for(var g,f,p=d.length,y=0;p>y;y++)if(f=d[y],1==f.nodeType){switch(g=new L,g.type=G.parse(f.nodeName),g.id=f.getAttribute("id"),g.name=f.getAttribute("name"),g.file=f.getAttribute("file"),t=f.getAttribute("size"),t&&(s=t.split(","),g.width=parseInt(s[0]),g.height=parseInt(s[1])),g.type){case 0:t=f.getAttribute("scale"),"9grid"==t?(g.scale9Grid=new laya.maths.Rectangle,t=f.getAttribute("scale9grid"),t&&(s=t.split(","),g.scale9Grid.x=parseInt(s[0]),g.scale9Grid.y=parseInt(s[1]),g.scale9Grid.width=parseInt(s[2]),g.scale9Grid.height=parseInt(s[3]))):"tile"==t&&(g.scaleByTile=!0),t=f.getAttribute("smoothing"),g.smoothing="false"!=t}g.owner=this,this._items.push(g),this._itemsById[g.id]=g,null!=g.name&&(this._itemsByName[g.name]=g)}for(n=this._items.length,h=0;n>h;h++)g=this._items[h],6==g.type&&(this.loadFont(g),fairygui.UIPackage._bitmapFonts[g.bitmapFont.id]=g.bitmapFont)},s.decompressPackage=function(t){this._resData={};var e,i=new Zlib.RawInflate(t);e=i.decompress();for(var s,n=new y(e).readUTFBytes(),h=0,r=NaN;;){var a=n.indexOf("|",h);if(-1==a)break;s=n.substring(h,a),h=a+1,a=n.indexOf("|",h),r=parseInt(n.substring(h,a)),h=a+1,this._resData[s]=n.substr(h,r),h+=r}},s.dispose=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.texture;null!=i.bitmapFont&&delete fairygui.UIPackage._bitmapFonts[i.bitmapFont.id]}},s.createObject=function(t,e){var i=this._itemsByName[t];return i?this.createObject2(i,e):null},s.createObject2=function(t,e){var i;return i=4==t.type&&null!=e?new e:K.newObject(t),null==i?null:(fairygui.UIPackage._constructing++,i.constructFromResource(t),fairygui.UIPackage._constructing--,i)},s.getItem=function(t){return this._itemsById[t]},s.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},s.getItemAsset=function(t){switch(t.type){case 0:if(!t.decoded){t.decoded=!0;var e=this._sprites[t.id];null!=e&&(t.texture=this.createSpriteTexture(e))}return t.texture;case 7:if(!t.decoded){t.decoded=!0;var s=null!=t.file&&t.file.length>0?t.file:t.id+".png";t.texture=i.loader.getRes(this._resKey+"@"+s)}return t.texture;case 3:return t.decoded||(t.decoded=!0,t.sound=i.loader.getRes(this._resKey+"@"+t.id)),t.sound;case 6:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case 2:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case 4:if(!t.decoded){t.decoded=!0;var n=this.getDesc(t.id+".xml");t.componentData=m.parseXMLFromString(n).firstChild}return t.componentData;default:return i.loader.getRes(this._resKey+"@"+t.id)}},s.getDesc=function(t){return this._resData[t]},s.createSpriteTexture=function(t){var e=this._itemsById[t.atlas];if(null!=e){var i=this.getItemAsset(e);return null==i?null:this.createSubTexture(i,t.rect)}return null},s.createSubTexture=function(t,e){var i=p.createFromTexture(t,e.x,e.y,e.width,e.height);return i},s.loadMovieClip=function(t){var e=m.parseXMLFromString(this.getDesc(t.id+".xml")).firstChild;t.pivot=new a;var i=e.getAttribute("pivot");if(i){var s=i.split(",");t.pivot.x=parseInt(s[0]),t.pivot.y=parseInt(s[1])}i=e.getAttribute("interval"),null!=i&&(t.interval=parseInt(i)),i=e.getAttribute("swing"),null!=i&&(t.swing="true"==i),i=e.getAttribute("repeatDelay"),null!=i&&(t.repeatDelay=parseInt(i));parseInt(e.getAttribute("frameCount"));t.frames=[];for(var n=J.findChildNode(e,"frames").childNodes,h=0,r=n.length,o=0;r>o;o++){var l=n[o];if("frame"==l.nodeName){var u=new k;i=l.getAttribute("rect"),s=i.split(","),u.rect=new f(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3])),i=l.getAttribute("addDelay"),i&&(u.addDelay=parseInt(i)),t.frames[h]=u;var _=this._sprites[t.id+"_"+h];null!=_&&(u.texture=this.createSpriteTexture(_)),h++}}},s.loadFont=function(t){var e=new I;e.id="ui://"+this.id+t.id;var i,s,n=this.getDesc(t.id+".fnt"),h=n.split("\n"),r=h.length,a=0,o={},l=!1,u=0,_=0,c=!1,d=0,g=0;for(a=0;r>a;a++)if(n=h[a],0!=n.length){n=J.trim(n);for(var p=n.split(" "),m=1;m<p.length;m++){var y=p[m].split("=");o[y[0]]=y[1]}if(n=p[0],"char"==n){var v=new O;v.x=isNaN(o.x)?0:parseInt(o.x),v.y=isNaN(o.y)?0:parseInt(o.y),v.offsetX=isNaN(o.xoffset)?0:parseInt(o.xoffset),v.offsetY=isNaN(o.yoffset)?0:parseInt(o.yoffset),v.width=isNaN(o.width)?0:parseInt(o.width),v.height=isNaN(o.height)?0:parseInt(o.height),v.advance=isNaN(o.xadvance)?0:parseInt(o.xadvance),void 0!=o.chnl&&(v.channel=parseInt(o.chnl),15==v.channel?v.channel=4:1==v.channel?v.channel=3:2==v.channel?v.channel=2:v.channel=1),l?null!=s&&(v.texture=this.createSubTexture(s,new f(v.x+d,v.y+g,v.width,v.height))):o.img&&(i=this._itemsById[o.img],null!=i&&(i.load(),v.width=i.width,v.height=i.height,v.texture=i.texture)),l?v.lineHeight=u:(0==v.advance&&(0==_?v.advance=v.offsetX+v.width:v.advance=_),v.lineHeight=v.offsetY<0?v.height:v.offsetY+v.height,v.lineHeight<u&&(v.lineHeight=u)),e.glyphs[String.fromCharCode(o.id)]=v}else if("info"==n){if(l=null!=o.face,isNaN(o.size)||(u=parseInt(o.size)),c="true"==o.resizable,l){var b=this._sprites[t.id];if(null!=b){d=b.rect.x,g=b.rect.y;var w=this._itemsById[b.atlas];null!=w&&(s=this.getItemAsset(w))}}}else"common"==n&&(0!=u||isNaN(o.lineHeight)||(u=parseInt(o.lineHeight)),isNaN(o.xadvance)||(_=parseInt(o.xadvance)))}0==u&&v&&(u=v.height),e.ttf=l,e.size=u,e.resizable=c,t.bitmapFont=e},h(0,s,"customId",function(){return this._customId},function(t){null!=this._customId&&delete fairygui.UIPackage._packageInstById[this._customId],this._customId=t,null!=this._customId&&(fairygui.UIPackage._packageInstById[this._customId]=this)}),h(0,s,"id",function(){return this._id}),h(0,s,"name",function(){return this._name}),t.getById=function(t){return fairygui.UIPackage._packageInstById[t]},t.getByName=function(t){return fairygui.UIPackage._packageInstByName[t]},t.addPackage=function(e){var i=new t;return i.create(e),fairygui.UIPackage._packageInstById[i.id]=i,fairygui.UIPackage._packageInstByName[i.name]=i,i.customId=e,i},t.removePackage=function(t){var e=fairygui.UIPackage._packageInstById[t];e.dispose(),delete fairygui.UIPackage._packageInstById[e.id],null!=e._customId&&delete fairygui.UIPackage._packageInstById[e._customId],delete fairygui.UIPackage._packageInstByName[e.name]},t.createObject=function(t,e,i){var s=fairygui.UIPackage.getByName(t);return s?s.createObject(e,i):null},t.createObjectFromURL=function(t,e){var i=fairygui.UIPackage.getItemByURL(t);return i?i.owner.createObject2(i,e):null},t.getItemURL=function(t,e){var i=fairygui.UIPackage.getByName(t);if(!i)return null;var s=i._itemsByName[e];return s?"ui://"+i.id+s.id:null},t.getItemByURL=function(t){if(J.startsWith(t,"ui://")){var e=t.substr(5,8),i=t.substr(13),s=fairygui.UIPackage.getById(e);if(s)return s.getItem(i)}return null},t.getBitmapFontByURL=function(t){return fairygui.UIPackage._bitmapFonts[t]},t._constructing=0,t._packageInstById={},t._packageInstByName={},t._bitmapFonts={},t.sep0=",",t.sep1="\n",t.sep2=" ",t.sep3="=",t.__init$=function(){e=function(){function t(){this.atlas=null,this.rect=null,this.rotated=!1,this.rect=new f}return n(t,""),t}()},t}(),J=function(){function t(){}return n(t,"fairygui.utils.ToolSet"),t.getFileName=function(t){var e=t.lastIndexOf("/");return-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("\\"),-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("."),-1!=e?t.substring(0,e):t},t.startsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},t.endsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(t.length-e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},t.trim=function(t){return fairygui.utils.ToolSet.trimLeft(fairygui.utils.ToolSet.trimRight(t))},t.trimLeft=function(t){for(var e="",i=0;i<t.length&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i++);return t.substr(i)},t.trimRight=function(t){for(var e="",i=t.length-1;i>=0&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)},t.convertToHtmlColor=function(t,e){void 0===e&&(e=!1);var i;i=e?(t>>24&255).toString(16):"";var s=(t>>16&255).toString(16),n=(t>>8&255).toString(16),h=(255&t).toString(16);return 1==i.length&&(i="0"+i),1==s.length&&(s="0"+s),1==n.length&&(n="0"+n),1==h.length&&(h="0"+h),"#"+i+s+n+h},t.convertFromHtmlColor=function(t,e){return void 0===e&&(e=!1),t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16))},t.displayObjectToGObject=function(t){for(;null!=t&&!(t instanceof laya.display.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null},t.findChildNode=function(t,e){var i=t.childNodes,s=i.length;if(s>0)for(var n=0;s>n;n++){var h=i[n];if(h.nodeName==e)return h}return null},t.encodeHTML=function(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""},t.parseUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t)},t.removeUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t,!0)},t.parseEaseType=function(e){var i=t.EaseMap[e];return i||(i=d.quartOut),i},s(t,["GRAY_FILTERS_MATRIX",function(){return this.GRAY_FILTERS_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]},"defaultUBBParser",function(){return this.defaultUBBParser=new tt},"EaseMap",function(){return this.EaseMap={Linear:d.linearNone,"Elastic.In":d.elasticIn,"Elastic.Out":d.elasticOut,"Elastic.InOut":d.elasticInOut,"Quad.In":d.QuadIn,"Quad.Out":d.QuadOut,"Quad.InOut":d.QuadInOut,"Cube.In":d.cubicIn,"Cube.Out":d.cubicOut,"Cube.InOut":d.cubicInOut,"Quart.In":d.quartIn,"Quart.Out":d.quartOut,"Quart.InOut":d.quartInOut,"Quint.In":d.quintIn,"Quint.Out":d.quintOut,"Quint.InOut":d.quintInOut,"Sine.In":d.sineIn,"Sine.Out":d.sineOut,"Sine.InOut":d.sineInOut,"Bounce.In":d.bounceIn,"Bounce.Out":d.bounceOut,"Bounce.InOut":d.bounceInOut,"Circ.In":d.circIn,"Circ.Out":d.circOut,"Circ.InOut":d.circInOut,"Expo.In":d.quartIn,"Expo.Out":d.quartOut,"Expo.InOut":d.quartInOut,"Back.In":d.backIn,"Back.Out":d.backOut,"Back.InOut":d.backInOut}}]),t}(),tt=function(){function t(){this._text=null,this._readPos=0,this._handlers=null,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}n(t,"fairygui.utils.UBBParser");var e=t.prototype;return e.onTag_URL=function(t,e,i){if(e)return"</a>";if(null!=i)return'<a href="'+i+'" target="_blank">';var s=this.getTagText();return'<a href="'+s+'" target="_blank">'},e.onTag_IMG=function(t,e,i){if(e)return null;var s=this.getTagText(!0);return s?this.defaultImgWidth?'<img src="'+s+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+s+'"/>':null},e.onTag_Simple=function(t,e,i){return e?"</"+t+">":"<"+t+">"},e.onTag_COLOR=function(t,e,i){return e?"</font>":'<font color="'+i+'">'},e.onTag_FONT=function(t,e,i){return e?"</font>":'<font face="'+i+'">'},e.onTag_SIZE=function(t,e,i){return e?"</font>":("normal"==i?i=""+this.normalFontSize:"small"==i?i=""+this.smallFontSize:"large"==i?i=""+this.largeFontSize:i.length&&"+"==i.charAt(0)?i=""+(this.smallFontSize+parseInt(i.substr(1))):i.length&&"-"==i.charAt(0)&&(i=""+(this.smallFontSize-parseInt(i.substr(1)))),'<font size="'+i+'">')},e.getTagText=function(t){void 0===t&&(t=!1);var e=this._text.indexOf("[",this._readPos);if(-1==e)return null;var i=this._text.substring(this._readPos,e);return t&&(this._readPos=e),i},e.parse=function(t,e){void 0===e&&(e=!1),this._text=t;for(var i,s,n,h,r=0,a=NaN,o=0,l=!1;-1!=(a=this._text.indexOf("[",r))&&(r=a,a=this._text.indexOf("]",r),-1!=a);)l="/"==this._text.charAt(r+1),i=this._text.substring(l?r+2:r+1,a),a++,this._readPos=a,s=null,n=null,o=i.indexOf("="),-1!=o&&(s=i.substring(o+1),i=i.substring(0,o)),i=i.toLowerCase(),h=this._handlers[i],null!=h?(e?n="":(n=h.call(this,i,l,s),null==n&&(n="")),this._text=this._text.substring(0,r)+n+this._text.substring(this._readPos)):r=a;return this._text},s(t,["inst",function(){return this.inst=new t}]),t}(),et=function(t){function e(){this._name=null,this._selectedIndex=0,this._previousIndex=0,this._pageIds=null,this._pageNames=null,this._pageTransitions=null,this._playingTransition=null,this._parent=null,this._autoRadioGroupDepth=!1,e.__super.call(this),this._pageIds=[],this._pageNames=[],this._selectedIndex=-1,this._previousIndex=-1}var i;n(e,"fairygui.Controller",t);var s=e.prototype;return s.setSelectedIndex=function(t){if(void 0===t&&(t=0),this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null)}},s.setSelectedPage=function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.setSelectedIndex(e)},s.getPageName=function(t){return void 0===t&&(t=0),this._pageNames[t]},s.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},s.addPageAt=function(t,e){void 0===e&&(e=0);var i=""+fairygui.Controller._nextPageId++;e==this._pageIds.length?(this._pageIds.push(i),this._pageNames.push(t)):(this._pageIds.splice(e,0,i),this._pageNames.splice(e,0,t))},s.removePage=function(t){var e=this._pageNames.indexOf(t);-1!=e&&(this._pageIds.splice(e,1),this._pageNames.splice(e,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this))},s.removePageAt=function(t){void 0===t&&(t=0),this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this)},s.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this._parent.applyController(this)},s.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},s.getPageIndexById=function(t){return this._pageIds.indexOf(t)},s.getPageIdByName=function(t){var e=this._pageNames.indexOf(t);return-1!=e?this._pageIds[e]:null},s.getPageNameById=function(t){var e=this._pageIds.indexOf(t);return-1!=e?this._pageNames[e]:null},s.getPageId=function(t){return void 0===t&&(t=0),
this._pageIds[t]},s.setup=function(t){this._name=t.getAttribute("name"),this._autoRadioGroupDepth="true"==t.getAttribute("autoRadioGroupDepth");var e=0,s=0,n=t.getAttribute("pages");if(n){var h=n.split(","),r=h.length;for(e=0;r>e;e+=2)this._pageIds.push(h[e]),this._pageNames.push(h[e+1])}if(n=t.getAttribute("transitions"))for(this._pageTransitions=[],h=n.split(","),r=h.length,e=0;r>e;e++)if(n=h[e]){var a=new i;s=n.indexOf("="),a.transitionName=n.substr(s+1),n=n.substring(0,s),s=n.indexOf("-"),a.toIndex=parseInt(n.substring(s+1)),n=n.substring(0,s),"*"==n?a.fromIndex=-1:a.fromIndex=parseInt(n),this._pageTransitions.push(a)}this._parent&&this._pageIds.length>0?this._selectedIndex=0:this._selectedIndex=-1},h(0,s,"name",function(){return this._name},function(t){this._name=t}),h(0,s,"parent",function(){return this._parent}),h(0,s,"selectedPageId",function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},function(t){var e=this._pageIds.indexOf(t);this.selectedIndex=e}),h(0,s,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;if(this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this.event("fui_state_changed"),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null),this._pageTransitions){for(var e=this._pageTransitions.length,i=0;e>i;i++){var s=this._pageTransitions[i];if(s.toIndex==this._selectedIndex&&(-1==s.fromIndex||s.fromIndex==this._previousIndex)){this._playingTransition=this.parent.getTransition(s.transitionName);break}}this._playingTransition&&this._playingTransition.play(u.create(this,function(){this._playingTransition=null}))}}}),h(0,s,"selectedPage",function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.selectedIndex=e}),h(0,s,"previsousIndex",function(){return this._previousIndex}),h(0,s,"previousPage",function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]}),h(0,s,"pageCount",function(){return this._pageIds.length}),h(0,s,"oppositePageId",null,function(t){var e=this._pageIds.indexOf(t);e>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)}),h(0,s,"previousPageId",function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]}),e._nextPageId=0,e.__init$=function(){i=function(){function t(){this.transitionName=null,this.fromIndex=0,this.toIndex=0}return n(t,""),t}()},e}(_),it=function(t){function e(){this._gearColor=null,e.__super.call(this),this._gearColor=new ht(this)}n(e,"fairygui.GTextField",t);var s=e.prototype;return i.imps(s,{"fairygui.IColorGear":!0}),s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._gearColor.controller==e&&this._gearColor.apply()},s.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i;this.asPassword="true"==e.getAttribute("password"),i=e.getAttribute("font"),i&&(this.font=i),i=e.getAttribute("fontSize"),i&&(this.fontSize=parseInt(i)),i=e.getAttribute("color"),i&&(this.color=i),i=e.getAttribute("align"),i&&(this.align=i),i=e.getAttribute("vAlign"),i&&(this.valign=i),i=e.getAttribute("leading"),i?this.leading=parseInt(i):this.leading=3,i=e.getAttribute("letterSpacing"),i&&(this.letterSpacing=parseInt(i)),this.ubbEnabled="true"==e.getAttribute("ubb"),this.italic="true"==e.getAttribute("italic"),this.bold="true"==e.getAttribute("bold"),this.singleLine="true"==e.getAttribute("singleLine"),i=e.getAttribute("strokeColor"),i&&(this.strokeColor=i,i=e.getAttribute("strokeSize"),i?this.stroke=parseInt(i)+1:this.stroke=2)},s.setup_afterAdd=function(e){t.prototype.setup_afterAdd.call(this,e);var i=e.getAttribute("text");null!=i&&i.length>0&&(this.text=i);var s=J.findChildNode(e,"gearColor");s&&this._gearColor.setup(s)},h(0,s,"font",function(){return null},function(t){}),h(0,s,"italic",function(){return!1},function(t){}),h(0,s,"valign",function(){return null},function(t){}),h(0,s,"fontSize",function(){return 0},function(t){}),h(0,s,"color",function(){return null},function(t){}),h(0,s,"strokeColor",function(){return null},function(t){}),h(0,s,"align",function(){return null},function(t){}),h(0,s,"bold",function(){return!1},function(t){}),h(0,s,"leading",function(){return 0},function(t){}),h(0,s,"letterSpacing",function(){return 0},function(t){}),h(0,s,"asPassword",function(){return!1},function(t){}),h(0,s,"singleLine",function(){return!1},function(t){}),h(0,s,"stroke",function(){return 0},function(t){}),h(0,s,"ubbEnabled",function(){return!1},function(t){}),h(0,s,"textWidth",function(){return 0}),h(0,s,"gearColor",function(){return this._gearColor}),e}(j),st=function(t){function e(){this._sortingChildCount=0,this._opaque=!1,this._margin=null,this._trackBounds=!1,this._boundsChanged=!1,this._buildingDisplayList=!1,this._children=null,this._controllers=null,this._transitions=null,this._container=null,this._scrollPane=null,e.__super.call(this),this._children=[],this._controllers=[],this._transitions=[],this._margin=new W}n(e,"fairygui.GComponent",t);var s=e.prototype;return s.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!0,this._container=this._displayObject},s.dispose=function(){for(var e=this._children.length,i=e-1;i>=0;--i){var s=this._children[i];s.parent=null,s.dispose()}t.prototype.dispose.call(this)},s.addChild=function(t){return this.addChildAt(t,this._children.length),t},s.addChildAt=function(t,e){if(void 0===e&&(e=0),!t)throw"child is null";var i=this._children.length;if(e>=0&&i>=e){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t.parent=this;var s=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&e>s-this._sortingChildCount&&(e=s-this._sortingChildCount),e==s?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},s.getInsertPosForSortingChild=function(t){var e=this._children.length,i=0;for(i=0;e>i;i++){var s=this._children[i];if(s!=t&&t.sortingOrder<s.sortingOrder)break}return i},s.removeChild=function(t,e){void 0===e&&(e=!1);var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},s.removeChildAt=function(t,e){if(void 0===e&&(e=!1),t>=0&&t<this.numChildren){var i=this._children[t];return i.parent=null,0!=i.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),i.inContainer&&this._container.removeChild(i.displayObject),e&&i.dispose(),this.setBoundsChangedFlag(),i}throw"Invalid child index"},s.removeChildren=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=!1),(0>e||e>=this.numChildren)&&(e=this.numChildren-1);for(var s=t;e>=s;++s)this.removeChildAt(t,i)},s.getChildAt=function(t){if(void 0===t&&(t=0),t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},s.getChild=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i].name==t)return this._children[i];return null},s.getVisibleChild=function(t){for(var e=this._children.length,i=0;e>i;++i){var s=this._children[i];if(s.finalVisible&&s.name==t)return s}return null},s.getChildInGroup=function(t,e){for(var i=this._children.length,s=0;i>s;++s){var n=this._children[s];if(n.group==e&&n.name==t)return n}return null},s.getChildById=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i]._id==t)return this._children[i];return null},s.getChildIndex=function(t){return this._children.indexOf(t)},s.setChildIndex=function(t,e){void 0===e&&(e=0);var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0==t.sortingOrder){var s=this._children.length;this._sortingChildCount>0&&e>s-this._sortingChildCount-1&&(e=s-this._sortingChildCount-1),this._setChildIndex(t,i,e)}},s._setChildIndex=function(t,e,i){void 0===i&&(i=0);var s=this._children.length;if(i>s&&(i=s),e!=i&&(this._children.splice(e,1),this._children.splice(i,0,t),t.inContainer)){for(var n=0,h=0;i>h;h++){var r=this._children[h];r.inContainer&&n++}n==this._container.numChildren&&n--,this._container.setChildIndex(t.displayObject,n),this.setBoundsChangedFlag()}},s.swapChildren=function(t,e){var i=this._children.indexOf(t),s=this._children.indexOf(e);if(-1==i||-1==s)throw"Not a child of this container";this.swapChildrenAt(i,s)},s.swapChildrenAt=function(t,e){void 0===e&&(e=0);var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)},s.addController=function(t){this._controllers.push(t),t._parent=this,this.applyController(t)},s.getControllerAt=function(t){return this._controllers[t]},s.getController=function(t){for(var e=this._controllers.length,i=0;e>i;++i){var s=this._controllers[i];if(s.name==t)return s}return null},s.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw new Error("controller not exists");t._parent=null,this._controllers.splice(e,1);for(var i=this._children.length,s=0;i>s;s++){var n=this._children[s];n.handleControllerChanged(t)}},s.childStateChanged=function(t){if(!this._buildingDisplayList)if(t instanceof fairygui.GGroup)for(var e=this._children.length,i=0;e>i;i++){var s=this._children[i];s.group==t&&this.childStateChanged(s)}else if(t.displayObject)if(t.finalVisible){if(!t.displayObject.parent){for(var n=0,h=this._children.length,r=0;h>r&&(s=this._children[r],s!=t);r++)s.displayObject&&s.displayObject.parent&&n++;this._container.addChildAt(t.displayObject,n)}}else t.displayObject.parent&&this._container.removeChild(t.displayObject)},s.applyController=function(t){for(var e,i=this._children.length,s=0;i>s;s++)e=this._children[s],e.handleControllerChanged(t)},s.applyAllControllers=function(){for(var t=this._controllers.length,e=0;t>e;++e)this.applyController(this._controllers[e])},s.adjustRadioGroupDepth=function(t,e){var i,s=this._children.length,n=NaN,h=-1,r=-1;for(n=0;s>n;n++)i=this._children[n],i==t?h=n:i instanceof fairygui.GButton&&i.relatedController==e&&n>r&&(r=n);r>h&&this.swapChildrenAt(h,r)},s.getTransitionAt=function(t){return this._transitions[t]},s.getTransition=function(t){for(var e=this._transitions.length,i=0;e>i;++i){var s=this._transitions[i];if(s.name==t)return s}return null},s.isChildInView=function(t){return null!=this._displayObject.mask?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null!=this._scrollPane?this._scrollPane.isChildInView(t):!0},s.getFirstChildInView=function(){for(var t=this._children.length,e=0;t>e;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},s.updateOpaque=function(){this._displayObject.hitArea||(this._displayObject.hitArea=new f),this._displayObject.hitArea.setTo(0,0,this.width,this.height)},s.updateMask=function(){var t=this._margin.left,e=this._margin.top,i=this.width-(this._margin.left+this._margin.right),s=this.height-(this._margin.top+this._margin.bottom);null==this._displayObject.mask?(this._displayObject.mask=new g,this._displayObject.mask.graphics.drawRect(t,e,i,s,"#000000")):(this._displayObject.mask.graphics.clear(),this._displayObject.mask.graphics.drawRect(t,e,i,s,"#000000"))},s.setupScroll=function(t,e,i,s,n,h){this._container=new g,this._displayObject.addChild(this._container),this._scrollPane=new U(this,e,t,i,s,n,h),this.setBoundsChangedFlag()},s.setupOverflow=function(t){1==t?(this._container=new g,this._displayObject.addChild(this._container),this.updateMask(),this._container.pos(this._margin.left,this._margin.top)):0==this._margin.left&&0==this._margin.top||(this._container=new g,this._displayObject.addChild(this._container),this._container.pos(this._margin.left,this._margin.top)),this.setBoundsChangedFlag()},s.handleSizeChanged=function(){this._scrollPane?this._scrollPane.setSize(this.width,this.height):null!=this._displayObject.mask&&this.updateMask(),this.displayObject.size(this.width,this.height),this._opaque&&this.updateOpaque(),this._displayObject.scaleX=this.scaleX,this._displayObject.scaleY=this.scaleY},s.handleGrayChanged=function(){var t=this.getController("grayed");if(null!=t)return void(t.selectedIndex=this.grayed?1:0);for(var e=this.grayed,i=this._children.length,s=0;i>s;++s)this._children[s].grayed=e},s.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,i.timer.callLater(this,this.__render)))},s.__render=function(){this._boundsChanged&&this.updateBounds()},s.ensureBoundsCorrect=function(){this._boundsChanged&&this.updateBounds()},s.updateBounds=function(){var t=NaN,e=NaN,i=NaN,s=0;if(this._children.length>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;var n=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,r=0,a=this._children.length;for(o=0;a>o;o++)l=this._children[o],l.ensureSizeCorrect();for(var o=0;a>o;o++){var l=this._children[o];r=l.x,t>r&&(t=r),r=l.y,e>r&&(e=r),r=l.x+l.actualWidth,r>n&&(n=r),r=l.y+l.actualHeight,r>h&&(h=r)}i=n-t,s=h-e}else t=0,e=0,i=0,s=0;this.setBounds(t,e,i,s)},s.setBounds=function(t,e,i,s){void 0===s&&(s=0),this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+s))},s.getSnappingPosition=function(t,e,i){i||(i=new a);var s=this._children.length;if(0==s)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();var n=null,h=null,r=0;if(0!=e){for(;s>r;r++)if(n=this._children[r],e<n.y){if(0==r){e=0;break}h=this._children[r-1],e=e<h.y+h.actualHeight/2?h.y:n.y;break}r==s&&(e=n.y)}if(0!=t){for(r>0&&r--;s>r;r++)if(n=this._children[r],t<n.x){if(0==r){t=0;break}h=this._children[r-1],t=t<h.x+h.actualWidth/2?h.x:n.x;break}r==s&&(t=n.x)}return i.x=t,i.y=e,i},s.childSortingOrderChanged=function(t,e,i){if(void 0===i&&(i=0),0==i)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==e&&this._sortingChildCount++;var s=this._children.indexOf(t),n=this.getInsertPosForSortingChild(t);n>s?this._setChildIndex(t,s,n-1):this._setChildIndex(t,s,n)}},s.constructFromResource=function(t){this._packageItem=t,this.constructFromXML(this._packageItem.owner.getItemAsset(this._packageItem))},s.constructFromXML=function(t){this._underConstruct=!0;var e,i;e=t.getAttribute("size"),i=e.split(","),this._sourceWidth=parseInt(i[0]),this._sourceHeight=parseInt(i[1]),this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),e=t.getAttribute("opaque"),this.opaque="false"!=e;var s=0;if(e=t.getAttribute("overflow"),s=e?N.parse(e):0,e=t.getAttribute("margin"),e&&this._margin.parse(e),2==s){var n=0;e=t.getAttribute("scroll"),n=e?$.parse(e):1;var h=0;e=t.getAttribute("scrollBar"),h=e?Y.parse(e):0;var r=NaN;e=t.getAttribute("scrollBarFlags"),r=e?parseInt(e):0;var a=new W;e=t.getAttribute("scrollBarMargin"),e&&a.parse(e);var o,l;e=t.getAttribute("scrollBarRes"),e&&(i=e.split(","),o=i[0],l=i[1]),this.setupScroll(a,n,h,r,o,l)}else this.setupOverflow(s);this._buildingDisplayList=!0;var u=t.childNodes;if(u){for(var _,c,d=u.length,g=0;d>g;g++){var f=u[g];"displayList"!=f.nodeName?"controller"==f.nodeName&&(c=new et,this._controllers.push(c),c._parent=this,c.setup(f)):_=f.childNodes}if(_.length>0)for(var p,m=_.length,y=0;m>y;y++)f=_[y],1==f.nodeType&&(p=this.constructChild(f),p&&(p._underConstruct=!0,p._constructingData=f,p.setup_beforeAdd(f),this.addChild(p)));for(this.relations.setup(t),m=this._children.length,y=0;m>y;y++)p=this._children[y],p.relations.setup(p._constructingData);for(y=0;m>y;y++)p=this._children[y],p.setup_afterAdd(p._constructingData),p._underConstruct=!1,p._constructingData=null;var v;for(g=0;d>g;g++)f=u[g],"transition"==f.nodeName&&(v=new q(this),this._transitions.push(v),v.setup(f));this._transitions.length>0&&(this.displayObject.on("display",this,this.___added),this.displayObject.on("undisplay",this,this.___removed))}for(this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,d=this._children.length,g=0;d>g;g++){var b=this._children[g];null!=b.displayObject&&b.finalVisible&&this._container.addChild(b.displayObject)}},s.___added=function(){for(var t=this._transitions.length,e=0;t>e;++e){var i=this._transitions[e];i.autoPlay&&i.play(null,i.autoPlayRepeat,i.autoPlayDelay)}},s.___removed=function(){for(var t=this._transitions.length,e=0;t>e;++e){var i=this._transitions[e];i.stop(!1,!0)}},s.constructChild=function(t){var e,i=t.getAttribute("pkg"),s=this._packageItem.owner;if(i&&i!=s.id){if(e=Z.getById(i),!e)return null}else e=s;var n=t.getAttribute("src");if(n){var h=e.getItem(n);if(!h)return null;var r=e.createObject2(h);return r}var a=t.nodeName;return r="text"==a&&"true"==t.getAttribute("input")?new Ct:K.newObject2(a)},h(0,s,"displayListContainer",function(){return this._container}),h(0,s,"numChildren",function(){return this._children.length}),h(0,s,"viewWidth",function(){return null!=this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},function(t){null!=this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right}),h(0,s,"controllers",function(){return this._controllers}),h(0,s,"scrollPane",function(){return this._scrollPane}),h(0,s,"opaque",function(){return this._opaque},function(t){this._opaque!=t&&(this._opaque=t,this._opaque?this.updateOpaque():this._displayObject.hitArea=null)}),h(0,s,"margin",function(){return this._margin},function(t){this._margin.copy(t),this._displayObject.mask&&this._container.pos(this._margin.left,this._margin.top),this.handleSizeChanged()}),h(0,s,"viewHeight",function(){return null!=this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},function(t){null!=this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom}),e}(j),nt=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}var i;n(e,"fairygui.GearAnimation",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.playing,this._owner.frame),this._storage={}},s.addStatus=function(t,e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s);var n=e.split(",");s.frame=parseInt(n[0]),s.playing="p"==n[1]},s.apply=function(){this._owner._gearLocked=!0;var t;this.connected?(t=this._storage[this._controller.selectedPageId],t||(t=this._default)):t=this._default,this._owner.frame=t.frame,this._owner.playing=t.playing,this._owner._gearLocked=!1},s.updateState=function(){if(!this._owner._gearLocked){var t,e=this._owner;this.connected?(t=this._storage[this._controller.selectedPageId],t||(t=new i,this._storage[this._controller.selectedPageId]=t)):t=this._default,t.frame=e.frame,t.playing=e.playing}},e.__init$=function(){i=function(){function t(t,e){this.playing=!1,this.frame=NaN,void 0===t&&(t=!0),void 0===e&&(e=0),this.playing=t,this.frame=e}return n(t,""),t}()},e}(B),ht=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}n(e,"fairygui.GearColor",t);var i=e.prototype;return i.init=function(){this._default=this._owner.color,this._storage={}},i.addStatus=function(t,e){null==t?this._default=e:this._storage[t]=e},i.apply=function(){if(this._owner._gearLocked=!0,this.connected){var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.color=t:this._owner.color=this._default}else this._owner.color=this._default;this._owner._gearLocked=!1},i.updateState=function(){this._owner._gearLocked||(this.connected?this._storage[this._controller.selectedPageId]=this._owner.color:this._default=this._owner.color)},e}(B),rt=function(t){function e(){this._type=NaN,this._lineSize=NaN,this._lineColor=null,this._fillColor=null,e.__super.call(this),this._type=0,this._lineSize=1,this._lineColor="#000000",this._fillColor="#FFFFFF"}n(e,"fairygui.GGraph",t);var i=e.prototype;return i.drawRect=function(t,e,i){this._type=1,this._lineSize=t,this._lineColor=e,this._fillColor=i,this.drawCommon()},i.drawEllipse=function(t,e,i){this._type=2,this._lineSize=t,this._lineColor=e,this._fillColor=i,this.drawCommon()},i.drawCommon=function(){this._displayObject.mouseEnabled=this.touchable;var t=this._displayObject.graphics;t.clear();var e=this.width*this.scaleX,i=this.height*this.scaleY;if(0!=e&&0!=i){var s=this._fillColor,n=this._lineColor;if(o.isWebGL&&J.startsWith(s,"rgba")){var h=s.substring(5,s.lastIndexOf(")")).split(","),r=parseFloat(h[3]);0==r?s=null:(s=m.toHexColor((parseInt(h[0])<<16)+(parseInt(h[1])<<8)+parseInt(h[2])),this.alpha=r)}1==this._type?t.drawRect(0,0,this.width,this.height,s,this._lineSize>0?n:null,this._lineSize):t.drawCircle(this.width/2,this.height/2,this.width/2,s,this._lineSize>0?n:null,this._lineSize)}},i.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},i.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)},i.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);e++,this._parent.addChildAt(t,e)},i.setNativeObject=function(t){this._type=0,this._displayObject.mouseEnabled=this.touchable,this._displayObject.graphics.clear(),this._displayObject.addChild(t)},i.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!1},i.handleSizeChanged=function(){0!=this._type&&this.drawCommon(),this._displayObject.size(this.width,this.height)},i.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i=e.getAttribute("type");if(null!=i&&"empty"!=i){var s;if(s=e.getAttribute("lineSize"),s&&(this._lineSize=parseInt(s)),s=e.getAttribute("lineColor")){var n=J.convertFromHtmlColor(s,!0),h=(n>>24&255)/255;1!=h?this._lineColor="rgba("+(n>>16&255)+","+(n>>8&255)+","+(255&n)+","+h+")":this._lineColor=m.toHexColor(16777215&n)}s=e.getAttribute("fillColor"),s&&(n=J.convertFromHtmlColor(s,!0),h=(n>>24&255)/255,1!=h?this._fillColor="rgba("+(n>>16&255)+","+(n>>8&255)+","+(255&n)+","+h+")":this._fillColor=m.toHexColor(16777215&n)),"rect"==i?this._type=1:this._type=2,this.drawCommon()}},e}(j),at=function(t){function e(t){e.__super.call(this,t)}n(e,"fairygui.GearDisplay",t);var i=e.prototype;return i.apply=function(){this.connected?this._owner.internalVisible++:this._owner.internalVisible=0},h(0,i,"connected",function(){return this._controller&&!this._pageSet.empty?this._pageSet.containsId(this._controller.selectedPageId):!0}),e}(B),ot=function(t){function e(t){this._storage=null,this._default=null,this._tweenValue=null,this._tweener=null,e.__super.call(this,t)}var i;n(e,"fairygui.GearLook",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.alpha,this._owner.rotation,this._owner.grayed),this._storage={}},s.addStatus=function(t,e){var s,n=e.split(",");null==t?s=this._default:(s=new i,this._storage[t]=s),s.alpha=parseFloat(n[0]),s.rotation=parseInt(n[1]),s.grayed="1"==n[2]},s.apply=function(){var t,e=this.connected;if(e?(t=this._storage[this._controller.selectedPageId],t||(t=this._default)):t=this._default,this._tweener&&this._tweener.complete(),this._tween&&!Z._constructing&&!B.disableAllTweenEffect&&e&&this._pageSet.containsId(this._controller.previousPageId)){this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner._gearLocked=!1;var i=t.alpha!=this._owner.alpha,s=t.rotation!=this._owner.rotation;(i||s)&&(this._owner.internalVisible++,null==this._tweenValue&&(this._tweenValue=new a),this._tweenValue.x=this._owner.alpha,this._tweenValue.y=this._owner.rotation,this._tweener=c.to(this._tweenValue,{x:t.alpha,y:t.rotation},1e3*this._tweenTime,this._easeType,u.create(this,this.__tweenComplete),1e3*this._delay),this._tweener.update=u.create(this,this.__tweenUpdate,[i,s],!1))}else this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.alpha=t.alpha,this._owner.rotation=t.rotation,this._owner._gearLocked=!1},s.__tweenUpdate=function(t,e){this._owner._gearLocked=!0,t&&(this._owner.alpha=this._tweenValue.x),e&&(this._owner.rotation=this._tweenValue.y),this._owner._gearLocked=!1},s.__tweenComplete=function(){this._owner.internalVisible--,this._tweener=null},s.updateState=function(){if(!this._owner._gearLocked){var t;this.connected?(t=this._storage[this._controller.selectedPageId],t||(t=new i,this._storage[this._controller.selectedPageId]=t)):t=this._default,t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed}},e.__init$=function(){i=function(){function t(t,e,i){this.alpha=NaN,this.rotation=NaN,this.grayed=!1,void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),this.alpha=t,this.rotation=e,this.grayed=i}return n(t,""),t}()},e}(B),lt=function(t){function e(){this._updating=!1,this._empty=!1,e.__super.call(this)}n(e,"fairygui.GGroup",t);var i=e.prototype;return i.updateBounds=function(){if(!this._updating&&this.parent){var t,e=this._parent.numChildren,i=0,s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=0;for(this._empty=!0,i=0;e>i;i++)t=this._parent.getChildAt(i),t.group==this&&(a=t.x,s>a&&(s=a),a=t.y,n>a&&(n=a),a=t.x+t.width,a>h&&(h=a),a=t.y+t.height,a>r&&(r=a),this._empty=!1);this._updating=!0,this._empty?this.setSize(0,0):(this.setXY(s,n),this.setSize(h-s,r-n)),this._updating=!1}},i.moveChildren=function(t,e){if(!this._updating&&this.parent){this._updating=!0;var i,s=this._parent.numChildren,n=0;for(n=0;s>n;n++)i=this._parent.getChildAt(n),i.group==this&&i.setXY(i.x+t,i.y+e);this._updating=!1}},i.updateAlpha=function(){if(t.prototype.updateAlpha.call(this),!this._underConstruct){var e,i=this._parent.numChildren,s=NaN;for(s=0;i>s;s++)e=this._parent.getChildAt(s),e.group==this&&(e.alpha=this.alpha)}},e}(j),ut=function(t){function e(){this.image=null,this._color=null,this._flip=0,this._gearColor=null,e.__super.call(this),this._color="#FFFFFF",this._gearColor=new ht(this)}n(e,"fairygui.GImage",t);var s=e.prototype;return i.imps(s,{"fairygui.IColorGear":!0}),s.applyColor=function(){},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._gearColor.controller==e&&this._gearColor.apply()},s.createDisplayObject=function(){this._displayObject=this.image=new Ot,this._displayObject.$owner=this},s.constructFromResource=function(t){this._packageItem=t,t.load(),this._sourceWidth=this._packageItem.width,this._sourceHeight=this._packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.image.scale9Grid=t.scale9Grid,this.image.scaleByTile=t.scaleByTile,this.image.texture=t.texture,this.setSize(this._sourceWidth,this._sourceHeight)},s.handleXYChanged=function(){t.prototype.handleXYChanged.call(this),-1==this.image.scaleX&&(this.image.x+=this.width),-1==this.image.scaleY&&(this.image.y+=this.height)},s.handleSizeChanged=function(){null!=this.image.texture&&(this.image.scale(Math.abs(this.scaleX),Math.abs(this.scaleY)),this.image.scaleTexture(this.width/this._sourceWidth,this.height/this._sourceHeight))},s.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i;i=e.getAttribute("color"),i&&(this.color=i),i=e.getAttribute("flip"),i&&(this.flip=T.parse(i))},s.setup_afterAdd=function(e){t.prototype.setup_afterAdd.call(this,e);var i=J.findChildNode(e,"gearColor");i&&this._gearColor.setup(i)},h(0,s,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,null!=this._gearColor.controller&&this._gearColor.updateState(),this.applyColor())}),h(0,s,"gearColor",function(){return this._gearColor}),h(0,s,"flip",function(){return this._flip},function(t){this._flip!=t&&(this._flip=t,this.image.scaleX=this.image.scaleY=1,1!=this._flip&&3!=this._flip||(this.image.scaleX=-1),2!=this._flip&&3!=this._flip||(this.image.scaleY=-1),this.handleXYChanged())}),e}(j),_t=function(t){function e(t){this._storage=null,this._default=null,this._tweenValue=null,this._tweener=null,e.__super.call(this,t)}var i;n(e,"fairygui.GearSize",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY),this._storage={}},s.addStatus=function(t,e){var s,n=e.split(",");null==t?s=this._default:(s=new i,this._storage[t]=s),s.width=parseInt(n[0]),s.height=parseInt(n[1]),n.length>2&&(s.scaleX=parseFloat(n[2]),s.scaleY=parseFloat(n[3]))},s.apply=function(){var t,e=this.connected;if(e?(t=this._storage[this._controller.selectedPageId],t||(t=this._default)):t=this._default,this._tweener&&this._tweener.complete(),this._tween&&!Z._constructing&&!B.disableAllTweenEffect&&e&&this._pageSet.containsId(this._controller.previousPageId)){var s=t.width!=this._owner.width||t.height!=this._owner.height,n=t.scaleX!=this._owner.scaleX||t.scaleY!=this._owner.scaleY;(s||n)&&(this._owner.internalVisible++,null==this._tweenValue&&(this._tweenValue=new i),this._tweenValue.width=this._owner.width,this._tweenValue.height=this._owner.height,this._tweenValue.scaleX=this._owner.scaleX,this._tweenValue.scaleY=this._owner.scaleY,this._tweener=c.to(this._tweenValue,{width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY},1e3*this._tweenTime,this._easeType,u.create(this,this.__tweenComplete),1e3*this._delay),this._tweener.update=u.create(this,this.__tweenUpdate,[s,n],!1))}else this._owner._gearLocked=!0,this._owner.setSize(t.width,t.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(t.scaleX,t.scaleY),this._owner._gearLocked=!1},s.__tweenUpdate=function(t,e){this._owner._gearLocked=!0,t&&this._owner.setSize(this._tweenValue.width,this._tweenValue.height,this._owner.gearXY.controller==this._controller),e&&this._owner.setScale(this._tweenValue.scaleX,this._tweenValue.scaleY),this._owner._gearLocked=!1},s.__tweenComplete=function(){this._owner.internalVisible--,this._tweener=null},s.updateState=function(){if(!this._owner._gearLocked){var t;this.connected?(t=this._storage[this._controller.selectedPageId],t||(t=new i,this._storage[this._controller.selectedPageId]=t)):t=this._default,t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY}},s.updateFromRelations=function(t,e){for(var i in this._storage){var s=this._storage[i];s.width+=t,s.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()},e.__init$=function(){i=function(){function t(t,e,i,s){this.width=NaN,this.height=NaN,this.scaleX=NaN,this.scaleY=NaN,void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.width=t,this.height=e,this.scaleX=i,this.scaleY=s}return n(t,""),t}()},e}(B),ct=function(t){function e(t){this._storage=null,this._default=null,this._tweenValue=null,this._tweener=null,e.__super.call(this,t)}n(e,"fairygui.GearXY",t);var i=e.prototype;return i.init=function(){this._default=new a(this._owner.x,this._owner.y),this._storage={}},i.addStatus=function(t,e){var i,s=e.split(",");null==t?i=this._default:(i=new a,this._storage[t]=i),i.x=parseInt(s[0]),i.y=parseInt(s[1])},i.apply=function(){var t,e=this.connected;e?(t=this._storage[this._controller.selectedPageId],t||(t=this._default)):t=this._default,this._tweener&&this._tweener.complete(),this._tween&&!Z._constructing&&!B.disableAllTweenEffect&&e&&this._pageSet.containsId(this._controller.previousPageId)?this._owner.x==t.x&&this._owner.y==t.y||(this._owner.internalVisible++,null==this._tweenValue&&(this._tweenValue=new a),this._tweenValue.x=this._owner.x,this._tweenValue.y=this._owner.y,this._tweener=c.to(this._tweenValue,{x:t.x,y:t.y},1e3*this._tweenTime,this._easeType,u.create(this,this.__tweenComplete),1e3*this._delay),this._tweener.update=u.create(this,this.__tweenUpdate,null,!1)):(this._owner._gearLocked=!0,
this._owner.setXY(t.x,t.y),this._owner._gearLocked=!1)},i.__tweenUpdate=function(){this._owner._gearLocked=!0,this._owner.setXY(this._tweenValue.x,this._tweenValue.y),this._owner._gearLocked=!1},i.__tweenComplete=function(){this._owner.internalVisible--,this._tweener=null},i.updateState=function(){if(!this._owner._gearLocked){var t;this.connected?(t=this._storage[this._controller.selectedPageId],t||(t=new a,this._storage[this._controller.selectedPageId]=t)):t=this._default,t.x=this._owner.x,t.y=this._owner.y}},i.updateFromRelations=function(t,e){for(var i in this._storage){var s=this._storage[i];s.x+=t,s.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()},e}(B),dt=function(t){function e(){this._gearAnimation=null,this._gearColor=null,this._url=null,this._align=null,this._valign=null,this._autoSize=!1,this._fill=0,this._showErrorSign=!1,this._playing=!1,this._frame=0,this._color=null,this._contentItem=null,this._contentSourceWidth=0,this._contentSourceHeight=0,this._contentWidth=0,this._contentHeight=0,this._content=null,this._errorSign=null,this._updatingLayout=!1,e.__super.call(this),this._playing=!0,this._url="",this._align="left",this._valign="top",this._showErrorSign=!0,this._color="#FFFFFF",this._gearAnimation=new nt(this),this._gearColor=new ht(this)}n(e,"fairygui.GLoader",t);var r=e.prototype;return i.imps(r,{"fairygui.IAnimationGear":!0,"fairygui.IColorGear":!0}),r.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!0},r.dispose=function(){if(null==this._contentItem&&this._content instanceof fairygui.display.Image){var e=this._content.texture;null!=e&&this.freeExternal(e)}t.prototype.dispose.call(this)},r.applyColor=function(){},r.loadContent=function(){this.clearContent(),this._url&&(J.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},r.loadFromPackage=function(t){this._contentItem=Z.getItemByURL(t),null!=this._contentItem?(this._contentItem.load(),0==this._contentItem.type?null==this._contentItem.texture?this.setErrorState():(this._content instanceof fairygui.display.Image?this._displayObject.addChild(this._content):(this._content=new Ot,this._displayObject.addChild(this._content)),this._content.texture=this._contentItem.texture,this._content.scale9Grid=this._contentItem.scale9Grid,this._content.scaleByTile=this._contentItem.scaleByTile,this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout()):2==this._contentItem.type?(this._content instanceof fairygui.display.MovieClip?this._displayObject.addChild(this._content):(this._content=new kt,this._displayObject.addChild(this._content)),this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this._content.interval=this._contentItem.interval,this._content.frames=this._contentItem.frames,this._content.boundsRect=new f(0,0,this._contentSourceWidth,this._contentSourceHeight),this.updateLayout()):this.setErrorState()):this.setErrorState()},r.loadExternal=function(){i.loader.load(this._url,u.create(this,this.__getResCompleted))},r.freeExternal=function(t){},r.onExternalLoadSuccess=function(t){this._content instanceof fairygui.display.Image?this._displayObject.addChild(this._content):(this._content=new Ot,this._displayObject.addChild(this._content)),this._content.texture=t,this._content.scale9Grid=null,this._content.scaleByTile=!1,this._contentSourceWidth=t.width,this._contentSourceHeight=t.height,this.updateLayout()},r.onExternalLoadFailed=function(){this.setErrorState()},r.__getResCompleted=function(t){null!=t?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},r.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=Q.loaderErrorSign&&(this._errorSign=fairygui.GLoader._errorSignPool.getObject(Q.loaderErrorSign)),null!=this._errorSign&&(this._errorSign.width=this.width,this._errorSign.height=this.height,this._displayObject.addChild(this._errorSign.displayObject)))},r.clearErrorState=function(){null!=this._errorSign&&(this._displayObject.removeChild(this._errorSign.displayObject),fairygui.GLoader._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},r.updateLayout=function(){if(null==this._content)return void(this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1));if(this._content.x=0,this._content.y=0,this._content.scaleX=1,this._content.scaleY=1,this._contentWidth=this._contentSourceWidth,this._contentHeight=this._contentSourceHeight,this._autoSize)this._updatingLayout=!0,0==this._contentWidth&&(this._contentWidth=50),0==this._contentHeight&&(this._contentHeight=30),this.setSize(this._contentWidth,this._contentHeight),this._updatingLayout=!1;else{var t=1,e=1;3!=this._fill&&4!=this._fill||(t=this.width/this._contentSourceWidth,e=this.height/this._contentSourceHeight,1==t&&1==e||(3==this._fill&&(t>e?t=e:e=t),this._contentWidth=this._contentSourceWidth*t,this._contentHeight=this._contentSourceHeight*e)),this._content instanceof fairygui.display.Image?(this._content.width=this._contentWidth,this._content.height=this._contentHeight):(this._content.scaleX=t,this._content.scaleY=e),"center"==this._align?this._content.x=Math.floor((this.width-this._contentWidth)/2):"right"==this._align&&(this._content.x=this.width-this._contentWidth),"middle"==this._valign?this._content.y=Math.floor((this.height-this._contentHeight)/2):"bottom"==this._valign&&(this._content.y=this.height-this._contentHeight)}},r.clearContent=function(){if(this.clearErrorState(),null!=this._content&&null!=this._content.parent&&this._displayObject.removeChild(this._content),null==this._contentItem&&this._content instanceof fairygui.display.Image){var t=this._content.texture;null!=t&&this.freeExternal(t)}this._contentItem=null},r.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._gearAnimation.controller==e&&this._gearAnimation.apply(),this._gearColor.controller==e&&this._gearColor.apply()},r.handleSizeChanged=function(){this._updatingLayout||this.updateLayout(),this._displayObject.size(this.width,this.height),this._displayObject.scale(this.scaleX,this.scaleY)},r.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i;i=e.getAttribute("url"),i&&(this._url=i),i=e.getAttribute("align"),i&&(this._align=i),i=e.getAttribute("vAlign"),i&&(this._valign=i),i=e.getAttribute("fill"),i&&(this._fill=H.parse(i)),this._autoSize="true"==e.getAttribute("autoSize"),i=e.getAttribute("errorSign"),i&&(this._showErrorSign="true"==i),this._playing="false"!=e.getAttribute("playing"),i=e.getAttribute("color"),i&&(this.color=i),this._url&&this.loadContent()},r.setup_afterAdd=function(e){t.prototype.setup_afterAdd.call(this,e);for(var i=e.childNodes,s=i.length,n=0;s>n;n++){var h=i[n];if("gearAni"==h.nodeName){this._gearAnimation.setup(h);break}if("gearColor"==h.nodeName){this._gearColor.setup(h);break}}},h(0,r,"showErrorSign",function(){return this._showErrorSign},function(t){this._showErrorSign=t}),h(0,r,"url",function(){return this._url},function(t){this._url!=t&&(this._url=t,this.loadContent())}),h(0,r,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.updateLayout())}),h(0,r,"frame",function(){return this._frame},function(t){this._frame!=t&&(this._frame=t,this._content instanceof fairygui.display.MovieClip&&(this._content.currentFrame=t),null!=this._gearAnimation.controller&&this._gearAnimation.updateState())}),h(0,r,"playing",function(){return this._playing},function(t){this._playing!=t&&(this._playing=t,this._content instanceof fairygui.display.MovieClip&&(this._content.playing=t),null!=this._gearAnimation.controller&&this._gearAnimation.updateState())}),h(0,r,"verticalAlign",function(){return this._valign},function(t){this._valign!=t&&(this._valign=t,this.updateLayout())}),h(0,r,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,null!=this._gearColor.controller&&this._gearColor.updateState(),this.applyColor())}),h(0,r,"fill",function(){return this._fill},function(t){this._fill!=t&&(this._fill=t,this.updateLayout())}),h(0,r,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}),h(0,r,"content",function(){return this._content}),h(0,r,"gearAnimation",function(){return this._gearAnimation}),h(0,r,"gearColor",function(){return this._gearColor}),s(e,["_errorSignPool",function(){return this._errorSignPool=new F}]),e}(j),gt=function(t){function e(){this.movieClip=null,this._gearAnimation=null,this._gearColor=null,e.__super.call(this),this._gearAnimation=new nt(this),this._gearColor=new ht(this)}n(e,"fairygui.GMovieClip",t);var s=e.prototype;return i.imps(s,{"fairygui.IAnimationGear":!0,"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.movieClip=new kt,this._displayObject.$owner=this},s.setPlaySettings=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),this.movieClip.setPlaySettings(t,e,i,s,n)},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._gearAnimation.controller==e&&this._gearAnimation.apply(),this._gearColor.controller==e&&this._gearColor.apply()},s.handleSizeChanged=function(){this.displayObject.scaleX=this.width/this._sourceWidth*this.scaleX,this.displayObject.scaleY=this.height/this._sourceHeight*this.scaleY},s.constructFromResource=function(t){this._packageItem=t,this._sourceWidth=this._packageItem.width,this._sourceHeight=this._packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),t.load(),this.movieClip.interval=this._packageItem.interval,this.movieClip.frames=this._packageItem.frames,this.movieClip.boundsRect=new f(0,0,this.sourceWidth,this.sourceHeight)},s.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i;i=e.getAttribute("frame"),i&&(this.movieClip.currentFrame=parseInt(i)),i=e.getAttribute("playing"),this.movieClip.playing="false"!=i,i=e.getAttribute("color"),i&&(this.color=i)},s.setup_afterAdd=function(e){t.prototype.setup_afterAdd.call(this,e);for(var i=e.childNodes,s=i.length,n=0;s>n;n++){var h=i[n];if("gearAni"==h.nodeName){this._gearAnimation.setup(h);break}if("gearColor"==h.nodeName){this._gearColor.setup(h);break}}},h(0,s,"color",function(){return"#FFFFFF"},function(t){}),h(0,s,"gearColor",function(){return this._gearColor}),h(0,s,"playing",function(){return this.movieClip.playing},function(t){this.movieClip.playing!=t&&(this.movieClip.playing=t,this._gearAnimation.controller&&this._gearAnimation.updateState())}),h(0,s,"frame",function(){return this.movieClip.currentFrame},function(t){this.movieClip.currentFrame!=t&&(this.movieClip.currentFrame=t,this._gearAnimation.controller&&this._gearAnimation.updateState())}),h(0,s,"gearAnimation",function(){return this._gearAnimation}),e}(j),ft=function(t){function e(){this.textField=null,this._font=null,this._color=null,this._text=null,this._ubbEnabled=!1,this._singleLine=!1,this._letterSpacing=0,this._autoSize=0,this._widthAutoSize=!1,this._heightAutoSize=!1,this._updatingSize=!1,this._sizeDirty=!1,this._textWidth=0,this._textHeight=0,this._changed=!1,this._bitmapFont=null,this._lines=null,e.__super.call(this),this._text="",this._color="#000000",this.setAutoSize(1),this.textField.align="left",this.textField.font=Q.defaultFont}var s;n(e,"fairygui.GBasicTextField",t);var r=e.prototype;return r.createDisplayObject=function(){fairygui.GObject.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!1,this.textField=new v,this._displayObject.addChild(this.textField)},r.setAutoSize=function(t){this._autoSize=t,this._widthAutoSize=1==t,this._heightAutoSize=1==t||2==t,this.textField.wordWrap=!this._widthAutoSize,this._heightAutoSize?this._widthAutoSize||(this.textField.width=this.width):this.textField.size(this.width,this.height)},r.ensureSizeCorrect=function(){this._sizeDirty&&this._changed&&this.applyChange()},r.markChanged=function(){this._changed||(this._changed=!0,i.timer.callLater(this,this.applyChange)),this._sizeDirty||!this._widthAutoSize&&!this._heightAutoSize||(this._sizeDirty=!0,this._displayObject.event("fui_size_delay_change"))},r.applyChange=function(t){void 0===t&&(t=!1),(this._changed||t)&&(this._changed=!1,this._sizeDirty=!1,null!=this._bitmapFont?this.renderWithBitmapFont():(this._widthAutoSize||this._heightAutoSize)&&this.updateSize())},r.updateSize=function(){this._textWidth=Math.ceil(this.textField.textWidth),this._textHeight=Math.ceil(this.textField.textHeight);var t=NaN,e=0;this._widthAutoSize?(t=this._textWidth,this.textField.width!=t&&(this.textField.width=t)):t=this.width,this._heightAutoSize?(e=this._textHeight,this._widthAutoSize||this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)):(e=this.height,this._textHeight>e&&(this._textHeight=e),this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)),this._updatingSize=!0,this.setSize(t,e),this._updatingSize=!1},r.renderWithBitmapFont=function(){var t=this._displayObject.graphics;t.clear(),this._lines?s.returnList(this._lines):this._lines=[];for(var e,i=this.letterSpacing,n=this.leading-1,h=this.width-4,r=0,a=0,o=0,l=0,u=0,_=0,c=0,d=0,g=0,f="",p=2,m=0,y=0,v=!this._widthAutoSize&&!this._singleLine,b=this._bitmapFont.resizable?this.fontSize/this._bitmapFont.size:1,w=this._text.length,C=0;w>C;++C){var x=this._text.charAt(C),S=x.charCodeAt(C);if("\n"!=x){if(S>256||32>=S?(_>0&&(d=r),_=0):(0==_&&(c=r),_++)," "==x)l=Math.ceil(this.fontSize/2),u=Math.ceil(this.fontSize);else{var I=this._bitmapFont.glyphs[x];I?(l=Math.ceil(I.advance*b),u=Math.ceil(I.lineHeight*b)):" "==x?(l=Math.ceil(this._bitmapFont.size*b/2),u=Math.ceil(this._bitmapFont.size*b)):(l=0,u=0)}if(u>o&&(o=u),u>a&&(a=u),0!=r&&(r+=i),r+=l,!v||h>=r)f+=x;else{if(e=s.borrow(),e.height=a,e.textHeight=o,0==f.length)e.text=x;else if(_>0&&d>0){f+=x;var O=f.length-_;e.text=J.trimRight(f.substr(0,O)),e.width=d,f=f.substr(O+1),r-=c}else e.text=f,e.width=r-(l+i),f=x,r=l,a=u,o=u;e.y=p,p+=e.height+n,e.width>m&&(m=e.width),_=0,c=0,d=0,this._lines.push(e)}}else f+=x,e=s.borrow(),e.width=r,0==o&&(0==g&&(g=Math.ceil(this.fontSize*b)),0==a&&(a=g),o=a),e.height=a,g=a,e.textHeight=o,e.text=f,e.y=p,p+=e.height+n,e.width>m&&(m=e.width),this._lines.push(e),f="",r=0,a=0,o=0,_=0,c=0,d=0}(f.length>0||this._lines.length>0&&J.endsWith(this._lines[this._lines.length-1].text,"\n"))&&(e=s.borrow(),e.width=r,0==a&&(a=g),0==o&&(o=a),e.height=a,e.textHeight=o,e.text=f,e.y=p,e.width>m&&(m=e.width),this._lines.push(e)),m>0&&(m+=4);var k=this._lines.length;0==k?y=0:(e=this._lines[this._lines.length-1],y=e.y+e.height+2);var P=NaN,A=0;if(P=this._widthAutoSize?0==m?0:m:this.width,A=this._heightAutoSize?0==y?0:y:this.height,this._updatingSize=!0,this.setSize(P,A),this._updatingSize=!1,this.doAlign(),0!=P&&0!=A){var H=2,T=0,j=0;h=this.width-4;for(var B=this._lines.length,F=0;B>F;F++){e=this._lines[F],H=2,T="center"==this.align?(h-e.width)/2:"right"==this.align?h-e.width:0,w=e.text.length;for(var z=0;w>z;z++)x=e.text.charAt(z),I=this._bitmapFont.glyphs[x],null!=I?(j=(e.height+e.textHeight)/2-Math.ceil(I.lineHeight*b),t.drawTexture(I.texture,H+T+Math.ceil(I.offsetX*b),e.y+j+Math.ceil(I.offsetY*b),I.texture.width*b,I.texture.height*b),H+=i+Math.ceil(I.advance*b)):H+=" "==x?i+Math.ceil(this._bitmapFont.size*b/2):i}}},r.handleSizeChanged=function(){this._updatingSize||(null!=this._bitmapFont?this._widthAutoSize?this.doAlign():this.markChanged():this._widthAutoSize||(this._heightAutoSize?(this.textField.width=this.width,this.markChanged()):this.textField.size(this.width,this.height)))},r.handleGrayChanged=function(){fairygui.GObject.prototype.handleGrayChanged.call(this),this.grayed?this.textField.color="#AAAAAA":this.textField.color=this._color},r.doAlign=function(){if("top"==this.valign||0==this._textHeight)this._yOffset=2;else{var t=this.height-this._textHeight;0>t&&(t=0),"middle"==this.valign?this._yOffset=Math.floor(t/2):this._yOffset=Math.floor(t)}this.handleXYChanged()},r.setup_beforeAdd=function(e){t.prototype.setup_beforeAdd.call(this,e);var i;i=e.getAttribute("autoSize"),i&&this.setAutoSize(x.parse(i)),this._sizeDirty=!1},h(0,r,"leading",function(){return this.textField.leading},function(t){this.textField.leading=t,this.markChanged()}),h(0,r,"text",function(){return this._text},function(t){this._text=t,null==this._text&&(this._text=""),null==this._bitmapFont&&(this._widthAutoSize&&(this.textField.width=1e4),this._ubbEnabled?this.textField.text=J.removeUBB(J.encodeHTML(this._text)):this.textField.text=this._text),this.parent&&this.parent._underConstruct?this.applyChange(!0):this.markChanged()}),h(0,r,"font",function(){return this.textField.font},function(t){this._font=t,J.startsWith(this._font,"ui://")?this._bitmapFont=Z.getBitmapFontByURL(this._font):(this._bitmapFont=null,this._font?this.textField.font=this._font:this.textField.font=Q.defaultFont),null!=this._bitmapFont&&null!=this.textField.parent?this._displayObject.removeChild(this.textField):null==this._bitmapFont&&null==this.textField.parent&&(this._displayObject.graphics.clear(),this._displayObject.addChild(this.textField)),this.markChanged()}),h(0,r,"valign",function(){return this.textField.valign},function(t){this.textField.valign=t,this.markChanged()}),h(0,r,"fontSize",function(){return this.textField.fontSize},function(t){this.textField.fontSize=t,this.markChanged()}),h(0,r,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this._gearColor.controller&&this._gearColor.updateState(),this.grayed?this.textField.color="#AAAAAA":this.textField.color=this._color)}),h(0,r,"strokeColor",function(){return this.textField.strokeColor},function(t){this.textField.strokeColor=t}),h(0,r,"align",function(){return this.textField.align},function(t){this.textField.align=t,this.markChanged()}),h(0,r,"bold",function(){return this.textField.bold},function(t){this.textField.bold=t}),h(0,r,"letterSpacing",function(){return this._letterSpacing},function(t){this._letterSpacing=t,this.markChanged()}),h(0,r,"italic",function(){return this.textField.italic},function(t){this.textField.italic=t}),h(0,r,"asPassword",function(){return this.textField.asPassword},function(t){this.textField.asPassword=t,this.markChanged()}),h(0,r,"singleLine",function(){return this._singleLine},function(t){this._singleLine=t,this.markChanged()}),h(0,r,"stroke",function(){return this.textField.stroke},function(t){this.textField.stroke=t}),h(0,r,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),h(0,r,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&(this.setAutoSize(t),this.markChanged())}),h(0,r,"textWidth",function(){return this._changed&&this.applyChange(),this._textWidth}),e.GUTTER_X=2,e.GUTTER_Y=2,e.__init$=function(){s=function(){function t(){this.width=0,this.height=0,this.textHeight=0,this.text=null,this.y=0}return n(t,""),t.borrow=function(){if(t.pool.length){var e=t.pool.pop();return e.width=0,e.height=0,e.textHeight=0,e.text=null,e.y=0,e}return new t},t.returns=function(e){t.pool.push(e)},t.returnList=function(e){for(var i=e.length,s=0;i>s;s++){var n=e[s];t.pool.push(n)}e.length=0},t.pool=[],t}()},e}(it),pt=function(t){function e(){this._titleObject=null,this._iconObject=null,this._relatedController=null,this._mode=0,this._selected=!1,this._title=null,this._selectedTitle=null,this._icon=null,this._selectedIcon=null,this._sound=null,this._soundVolumeScale=NaN,this._pageOption=null,this._buttonController=null,this._changeStateOnClick=!1,this._linkedPopup=null,this._downEffect=NaN,this._downEffectValue=NaN,this._down=!1,this._over=!1,e.__super.call(this),this._mode=0,this._title="",this._icon="",this._sound=Q.buttonSound,this._soundVolumeScale=Q.buttonSoundVolumeScale,this._pageOption=new V,this._changeStateOnClick=!0,this._downEffect=0,this._downEffectValue=.8}n(e,"fairygui.GButton",t);var s=e.prototype;return s.fireClick=function(t){void 0===t&&(t=!0),t&&0==this._mode&&(this.setState("over"),i.timer.once(100,this,this.setState,["down"]),i.timer.once(200,this,this.setState,["up"])),this.__click(A.createEvent("click",this.displayObject))},s.setState=function(t){if(this._buttonController&&(this._buttonController.selectedPage=t),1==this._downEffect){var e=this.numChildren;if("down"==t||"selectedOver"==t||"selectedDisabled"==t)for(var i=255*this._downEffectValue,s=m.toHexColor((i<<16)+(i<<8)+i),n=0;e>n;n++){var h=this.getChildAt(n);(h instanceof fairygui.GImage||h instanceof fairygui.GLoader||h instanceof fairygui.GMovieClip||h instanceof fairygui.GTextField)&&(h.color=s)}else for(n=0;e>n;n++)h=this.getChildAt(n),(h instanceof fairygui.GImage||h instanceof fairygui.GLoader||h instanceof fairygui.GMovieClip||h instanceof fairygui.GTextField)&&(h.color="#FFFFFF")}else 2==this._downEffect&&("down"==t||"selectedOver"==t||"selectedDisabled"==t?this.setScale(this._downEffectValue,this._downEffectValue):this.setScale(1,1))},s.handleControllerChanged=function(t){fairygui.GObject.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._pageOption.id==t.selectedPageId)},s.handleGrayChanged=function(){this._buttonController&&this._buttonController.hasPage("disabled")?this.grayed?this._selected&&this._buttonController.hasPage("selectedDisabled")?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState("down"):this.setState("up"):t.prototype.handleGrayChanged.call(this)},s.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),e=J.findChildNode(e,"Button");var i;i=e.getAttribute("mode"),i&&(this._mode=S.parse(i)),i=e.getAttribute("sound"),null!=i&&(this._sound=i),i=e.getAttribute("volume"),i&&(this._soundVolumeScale=parseInt(i)/100),i=e.getAttribute("downEffect"),i&&(this._downEffect="dark"==i?1:"scale"==i?2:0,i=e.getAttribute("downEffectValue"),this._downEffectValue=parseFloat(i)),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),0==this._mode&&this.setState("up"),this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown),this.on("click",this,this.__click)},s.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),2==this._downEffect&&this.setPivot(.5,.5),t=J.findChildNode(t,"Button")){var e;this.title=t.getAttribute("title"),this.icon=t.getAttribute("icon"),e=t.getAttribute("selectedTitle"),e&&(this.selectedTitle=e),e=t.getAttribute("selectedIcon"),e&&(this.selectedIcon=e),e=t.getAttribute("titleColor"),e&&(this.titleColor=e),e=t.getAttribute("controller"),e?this._relatedController=this._parent.getController(e):this._relatedController=null,this._pageOption.id=t.getAttribute("page"),this.selected="true"==t.getAttribute("checked")}},s.__rollover=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!0,this._down||this.setState(this._selected?"selectedOver":"over"))},s.__rollout=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!1,this._down||this.setState(this._selected?"down":"up"))},s.__mousedown=function(t){this._down=!0,xt.inst.checkPopups(t.target),i.stage.on("mouseup",this,this.__mouseup),0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("selectedDisabled"):this.setState("down")),null!=this._linkedPopup&&(this._linkedPopup instanceof fairygui.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},s.__mouseup=function(){this._down&&(i.stage.off("mouseup",this,this.__mouseup),this._down=!1,0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("disabled"):this._over?this.setState("over"):this.setState("up")))},s.__click=function(t){if(this._sound){var e=Z.getItemByURL(this._sound);if(e){var i=e.owner.getItemAsset(e);i&&xt.inst.playOneShotSound(i,this._soundVolumeScale)}}this._changeStateOnClick&&(1==this._mode?(this.selected=!this._selected,A.dispatch("fui_state_changed",this.displayObject,t)):2==this._mode&&(this._selected||(this.selected=!0,A.dispatch("fui_state_changed",this.displayObject,t))))},h(0,s,"icon",function(){return this._icon},function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject instanceof fairygui.GLoader?this._iconObject.url=t:this._iconObject instanceof fairygui.GLabel?this._iconObject.icon=t:this._iconObject instanceof fairygui.GButton&&(this._iconObject.icon=t)}),h(0,s,"sound",function(){return this._sound},function(t){this._sound=t}),h(0,s,"text",function(){return this.title},function(t){this.title=t}),h(0,s,"selectedIcon",function(){return this._selectedIcon},function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject instanceof fairygui.GLoader?this._iconObject.url=t:this._iconObject instanceof fairygui.GLabel?this._iconObject.icon=t:this._iconObject instanceof fairygui.GButton&&(this._iconObject.icon=t)}),h(0,s,"selected",function(){return this._selected},function(t){if(0!=this._mode&&this._selected!=t){if(this._selected=t,this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this._selected?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState(this._over?"selectedOver":"down"):this.setState(this._over?"over":"up"),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var e=this._selected?this._selectedIcon:this._icon;this._iconObject instanceof fairygui.GLoader?this._iconObject.url=e:this._iconObject instanceof fairygui.GLabel?this._iconObject.icon=e:this._iconObject instanceof fairygui.GButton&&(this._iconObject.icon=e)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._pageOption.id,this._relatedController._autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):1==this._mode&&this._relatedController.selectedPageId==this._pageOption.id&&(this._relatedController.oppositePageId=this._pageOption.id))}}),h(0,s,"title",function(){return this._title},function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}),h(0,s,"selectedTitle",function(){return this._selectedTitle},function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}),h(0,s,"soundVolumeScale",function(){return this._soundVolumeScale},function(t){this._soundVolumeScale=t}),h(0,s,"titleColor",function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject.color:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor:this._titleObject instanceof fairygui.GButton?this._titleObject.titleColor:"#000000"},function(t){this._titleObject instanceof fairygui.GTextField?this._titleObject.color=t:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor=t:this._titleObject instanceof fairygui.GButton&&(this._titleObject.titleColor=t)}),h(0,s,"mode",function(){return this._mode},function(t){this._mode!=t&&(0==t&&(this.selected=!1),this._mode=t)}),h(0,s,"relatedController",function(){return this._relatedController},function(t){t!=this._relatedController&&(this._relatedController=t,this._pageOption.controller=t,this._pageOption.clear())}),h(0,s,"pageOption",function(){return this._pageOption}),h(0,s,"changeStateOnClick",function(){return this._changeStateOnClick},function(t){this._changeStateOnClick=t}),h(0,s,"linkedPopup",function(){return this._linkedPopup},function(t){this._linkedPopup=t}),e.UP="up",e.DOWN="down",e.OVER="over",e.SELECTED_OVER="selectedOver",e.DISABLED="disabled",e.SELECTED_DISABLED="selectedDisabled",e}(st),mt=function(t){function e(){this._titleObject=null,this._dropdownObject=null,this._list=null,this._visibleItemCount=0,this._items=null,this._values=null,this._itemsUpdated=!1,this._selectedIndex=0,this._buttonController=null,this._over=!1,this._down=!1,e.__super.call(this),this._visibleItemCount=Q.defaultComboBoxVisibleItemCount,this._itemsUpdated=!0,this._selectedIndex=-1,this._items=[],this._values=[]}n(e,"fairygui.GComboBox",t);var s=e.prototype;return s.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},s.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),e=J.findChildNode(e,"ComboBox");var i;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),i=e.getAttribute("dropdown")){if(this._dropdownObject=Z.createObjectFromURL(i),!this._dropdownObject)return void w.print("下拉框必须为元件");if(this._dropdownObject.name="this._dropdownObject",this._list=this._dropdownObject.getChild("list").asList,null==this._list)return void w.print(this.resourceURL+": 下拉框的弹出元件里必须包含名为list的列表");this._list.on("fui_click_item",this,this.__clickItem),this._list.addRelation(this._dropdownObject,14),this._list.removeRelation(this._dropdownObject,15),this._dropdownObject.addRelation(this._list,15),this._dropdownObject.removeRelation(this._list,14),this._dropdownObject.displayObject.on("undisplay",this,this.__popupWinClosed)}this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown)},s.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=J.findChildNode(t,"ComboBox")){var e;e=t.getAttribute("titleColor"),e&&(this.titleColor=e),e=t.getAttribute("visibleItemCount"),e&&(this._visibleItemCount=parseInt(e));for(var i=t.childNodes,s=i.length,n=0;s>n;n++){var h=i[n];"item"==h.nodeName&&(this._items.push(h.getAttribute("title")),this._values.push(h.getAttribute("value")))}e=t.getAttribute("title"),e?(this.text=e,this._selectedIndex=this._items.indexOf(e)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1}},s.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildren();for(var t=this._items.length,e=0;t>e;e++){var i=this._list.addItemFromPool();i.name=e<this._values.length?this._values[e]:"",i.text=this._items[e]}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this._dropdownObject.width=this.width,this.root.togglePopup(this._dropdownObject,this,!0),this._dropdownObject.parent&&this.setState("down")},s.__popupWinClosed=function(){this._over?this.setState("over"):this.setState("up")},s.__clickItem=function(t,e){i.timer.callLater(this,this.__clickItem2,[this._list.getChildIndex(t),e])},s.__clickItem2=function(t,e){this._dropdownObject.parent instanceof fairygui.GRoot&&this._dropdownObject.parent.hidePopup(),this._selectedIndex=t,this._selectedIndex>=0?this.text=this._items[this._selectedIndex]:this.text="",A.dispatch("fui_state_changed",this.displayObject,e)},s.__rollover=function(){this._over=!0,this._down||this._dropdownObject&&this._dropdownObject.parent||this.setState("over")},s.__rollout=function(){this._over=!1,this._down||this._dropdownObject&&this._dropdownObject.parent||this.setState("up")},s.__mousedown=function(t){this._down=!0,xt.inst.checkPopups(t.target),i.stage.on("mouseup",this,this.__mouseup),this._dropdownObject&&this.showDropdown()},s.__mouseup=function(){this._down&&(this._down=!1,i.stage.off("mouseup",this,this.__mouseup),this._dropdownObject&&!this._dropdownObject.parent&&(this._over?this.setState("over"):this.setState("up")))},h(0,s,"text",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t)}),h(0,s,"titleColor",function(){return this._titleObject?this._titleObject.color:"#000000";
},function(t){this._titleObject&&(this._titleObject.color=t)}),h(0,s,"value",function(){return this._values[this._selectedIndex]},function(t){this.selectedIndex=this._values.indexOf(t)}),h(0,s,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.selectedIndex>=0&&this.selectedIndex<this._items.length?this.text=this._items[this._selectedIndex]:this.text="")}),h(0,s,"visibleItemCount",function(){return this._visibleItemCount},function(t){this._visibleItemCount=t}),h(0,s,"items",function(){return this._items},function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex]):this.text="",this._itemsUpdated=!0}),h(0,s,"values",function(){return this._values},function(t){t?this._values=t.concat():this._values.length=0}),e}(st),yt=function(t){function e(){this._titleObject=null,this._iconObject=null,e.__super.call(this)}n(e,"fairygui.GLabel",t);var i=e.prototype;return i.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},i.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=J.findChildNode(t,"Label")){this.text=t.getAttribute("title"),this.icon=t.getAttribute("icon");var e;e=t.getAttribute("titleColor"),e&&(this.titleColor=e),this._titleObject instanceof fairygui.GTextInput&&(e=t.getAttribute("promptText"),e&&(this._titleObject.promptText=e))}},h(0,i,"icon",function(){return this._iconObject instanceof fairygui.GLoader?this._iconObject.url:this._iconObject instanceof fairygui.GLabel?this._iconObject.icon:this._iconObject instanceof fairygui.GButton?this._iconObject.icon:null},function(t){this._iconObject instanceof fairygui.GLoader?this._iconObject.url=t:this._iconObject instanceof fairygui.GLabel?this._iconObject.icon=t:this._iconObject instanceof fairygui.GButton&&(this._iconObject.icon=t)}),h(0,i,"text",function(){return this.title},function(t){this.title=t}),h(0,i,"title",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t)}),h(0,i,"editable",function(){return this._titleObject&&this._titleObject instanceof fairygui.GTextInput?this._titleObject.asTextInput.editable:!1},function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)}),h(0,i,"titleColor",function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject.color:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor:this._titleObject instanceof fairygui.GButton?this._titleObject.titleColor:"#000000"},function(t){this._titleObject instanceof fairygui.GTextField?this._titleObject.color=t:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor=t:this._titleObject instanceof fairygui.GButton&&(this._titleObject.titleColor=t)}),e}(st),vt=function(t){function e(){this.itemRenderer=null,this._layout=0,this._lineItemCount=0,this._lineGap=0,this._columnGap=0,this._defaultItem=null,this._autoResizeItem=!1,this._selectionMode=0,this._lastSelectedIndex=0,this._pool=null,this._virtual=!1,this._loop=!1,this._numItems=0,this._firstIndex=0,this._viewCount=0,this._curLineItemCount=0,this._itemSize=null,this._virtualListChanged=NaN,this._eventLocked=!1,e.__super.call(this),this._trackBounds=!0,this._pool=new F,this._layout=0,this._autoResizeItem=!0,this._lastSelectedIndex=-1,this._selectionMode=0,this.opaque=!0}n(e,"fairygui.GList",t);var s=e.prototype;return s.dispose=function(){this._pool.clear(),t.prototype.dispose.call(this)},s.getFromPool=function(t){t||(t=this._defaultItem);var e=this._pool.getObject(t);return null!=e&&(e.visible=!0),e},s.returnToPool=function(t){t.displayObject.cacheAsBitmap=!1,this._pool.returnObject(t)},s.addChildAt=function(e,i){if(void 0===i&&(i=0),this._autoResizeItem&&(0==this._layout?e.width=this.viewWidth:1==this._layout&&(e.height=this.viewHeight)),t.prototype.addChildAt.call(this,e,i),e instanceof fairygui.GButton){var s=e;s.selected=!1,s.changeStateOnClick=!1}return e.on("click",this,this.__clickItem),e},s.addItem=function(t){return t||(t=this._defaultItem),this.addChild(Z.createObjectFromURL(t))},s.addItemFromPool=function(t){return this.addChild(this.getFromPool(t))},s.removeChildAt=function(e,i){void 0===i&&(i=!1);var s=t.prototype.removeChildAt.call(this,e,i);return s.off("click",this,this.__clickItem),s},s.removeChildToPoolAt=function(e){void 0===e&&(e=0);var i=t.prototype.removeChildAt.call(this,e);this.returnToPool(i)},s.removeChildToPool=function(t){this.removeChild(t),this.returnToPool(t)},s.removeChildrenToPool=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),(0>e||e>=this._children.length)&&(e=this._children.length-1);for(var i=t;e>=i;++i)this.removeChildToPoolAt(t)},s.getSelection=function(){for(var t=[],e=this._children.length,i=0;e>i;i++){var s=this._children[i].asButton;if(null!=s&&s.selected){var n=this._firstIndex+i;this._loop&&this._numItems>0&&(n%=this._numItems),t.push(n)}}return t},s.addSelection=function(t,e){if(void 0===e&&(e=!1),3!=this._selectionMode){if(0==this._selectionMode&&this.clearSelection(),e&&this.scrollToView(t),this._loop&&this._numItems>0){var i=this._firstIndex%this._numItems;t=t>=i?this._firstIndex+(t-i):this._firstIndex+this._numItems+(i-t)}else t-=this._firstIndex;if(!(0>t||t>=this._children.length)){var s=this.getChildAt(t).asButton;null==s||s.selected||(s.selected=!0)}}},s.removeSelection=function(t){if(void 0===t&&(t=0),3!=this._selectionMode){if(this._loop&&this._numItems>0){var e=this._firstIndex%this._numItems;t=t>=e?this._firstIndex+(t-e):this._firstIndex+this._numItems+(e-t)}else t-=this._firstIndex;if(!(t>=this._children.length)){var i=this.getChildAt(t).asButton;null!=i&&i.selected&&(i.selected=!1)}}},s.clearSelection=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!1)}},s.selectAll=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!0)}},s.selectNone=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!1)}},s.selectReverse=function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;null!=i&&(i.selected=!i.selected)}},s.handleArrowKey=function(t){void 0===t&&(t=0);var e=this.selectedIndex;if(-1!=e)switch(t){case 1:if(0==this._layout||3==this._layout)e--,e>=0&&(this.clearSelection(),this.addSelection(e,!0));else if(2==this._layout){for(var i=this._children[e],s=0,n=e-1;n>=0;n--){var h=this._children[n];if(h.y!=i.y){i=h;break}s++}for(;n>=0;n--)if(h=this._children[n],h.y!=i.y){this.clearSelection(),this.addSelection(n+s+1,!0);break}}break;case 3:if(1==this._layout||2==this._layout)e++,e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(3==this._layout){i=this._children[e],s=0;var r=this._children.length;for(n=e+1;r>n;n++){if(h=this._children[n],h.x!=i.x){i=h;break}s++}for(;r>n;n++)if(h=this._children[n],h.x!=i.x){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 5:if(0==this._layout||3==this._layout)e++,e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(2==this._layout){for(i=this._children[e],s=0,r=this._children.length,n=e+1;r>n;n++){if(h=this._children[n],h.y!=i.y){i=h;break}s++}for(;r>n;n++)if(h=this._children[n],h.y!=i.y){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 7:if(1==this._layout||2==this._layout)e--,e>=0&&(this.clearSelection(),this.addSelection(e,!0));else if(3==this._layout){for(i=this._children[e],s=0,n=e-1;n>=0;n--){if(h=this._children[n],h.x!=i.x){i=h;break}s++}for(;n>=0;n--)if(h=this._children[n],h.x!=i.x){this.clearSelection(),this.addSelection(n+s+1,!0);break}}}},s.__clickItem=function(t){if(null==this._scrollPane||!this._scrollPane._isMouseMoved){var e=j.cast(t.currentTarget);this.setSelectionOnEvent(e,t),this.scrollPane&&this.scrollPane.scrollToView(e,!0),this.displayObject.event("fui_click_item",[e,A.createEvent("fui_click_item",this.displayObject,t)])}},s.setSelectionOnEvent=function(t,e){if(t instanceof fairygui.GButton&&3!=this._selectionMode){var i=!1,s=t,n=this.getChildIndex(t);if(0==this._selectionMode)s.selected||(this.clearSelectionExcept(s),s.selected=!0);else if(e.shiftKey){if(!s.selected)if(-1!=this._lastSelectedIndex){var h=Math.min(this._lastSelectedIndex,n),r=Math.max(this._lastSelectedIndex,n);r=Math.min(r,this._children.length-1);for(var a=h;r>=a;a++){var o=this.getChildAt(a).asButton;null==o||o.selected||(o.selected=!0)}i=!0}else s.selected=!0}else e.ctrlKey||2==this._selectionMode?s.selected=!s.selected:s.selected?this.clearSelectionExcept(s):(this.clearSelectionExcept(s),s.selected=!0);i||(this._lastSelectedIndex=n)}},s.clearSelectionExcept=function(t){for(var e=this._children.length,i=0;e>i;i++){var s=this._children[i].asButton;null!=s&&s!=t&&s.selected&&(s.selected=!1)}},s.resizeToFit=function(t,e){void 0===t&&(t=1e6),void 0===e&&(e=0),this.ensureBoundsCorrect();var i=this.numItems;if(t>i&&(t=i),this._virtual){var s=Math.ceil(t/this._curLineItemCount);0==this._layout||2==this._layout?this.viewHeight=s*this._itemSize.y+Math.max(0,s-1)*this._lineGap:this.viewWidth=s*this._itemSize.x+Math.max(0,s-1)*this._columnGap}else if(0==t)0==this._layout||2==this._layout?this.viewHeight=e:this.viewWidth=e;else{for(var n=t-1,h=null;n>=0&&(h=this.getChildAt(n),!h.visible);)n--;if(0>n)0==this._layout||2==this._layout?this.viewHeight=e:this.viewWidth=e;else{var r=0;0==this._layout||2==this._layout?(r=h.y+h.height,e>r&&(r=e),this.viewHeight=r):(r=h.x+h.width,e>r&&(r=e),this.viewWidth=r)}}},s.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;t>i;i++){var s=this.getChildAt(i);s.width>e&&(e=s.width)}return e},s.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._autoResizeItem&&this.adjustItemsSize(),2!=this._layout&&3!=this._layout||(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},s.adjustItemsSize=function(){if(0==this._layout)for(var t=this._children.length,e=this.viewWidth,i=0;t>i;i++){var s=this.getChildAt(i);s.width=e}else if(1==this._layout){t=this._children.length;var n=this.viewHeight;for(i=0;t>i;i++)s=this.getChildAt(i),s.height=n}},s.getSnappingPosition=function(e,i,s){if(this._virtual){if(s||(s=new a),0==this._layout||2==this._layout){var n=Math.floor(i/(this._itemSize.y+this._lineGap));i>n*(this._itemSize.y+this._lineGap)+this._itemSize.y/2&&n++,s.x=e,s.y=n*(this._itemSize.y+this._lineGap)}else n=Math.floor(e/(this._itemSize.x+this._columnGap)),e>n*(this._itemSize.x+this._columnGap)+this._itemSize.x/2&&n++,s.x=n*(this._itemSize.x+this._columnGap),s.y=i;return s}return t.prototype.getSnappingPosition.call(this,e,i,s)},s.scrollToView=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),this._virtual)null!=this.scrollPane?this.scrollPane.scrollToView(this.getItemRect(t),e,i):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(this.getItemRect(t),e,i);else{var s=this.getChildAt(t).asButton;null!=s&&(null!=this.scrollPane?this.scrollPane.scrollToView(s,e,i):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(s,e,i))}},s.getFirstChildInView=function(){var e=t.prototype.getFirstChildInView.call(this);return-1!=e?(e+=this._firstIndex,this._loop&&this._numItems>0&&(e%=this._numItems),e):-1},s.setVirtual=function(){this._setVirtual(!1)},s.setVirtualAndLoop=function(){this._setVirtual(!0)},s._setVirtual=function(t){if(!this._virtual){if(null==this.scrollPane)throw new Error("Virtual list must be scrollable!");if(t){if(2==this._layout||3==this._layout)throw new Error("Only single row or single column layout type is supported for loop list!");this.scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=t,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new a;var e=this.getFromPool(null);this._itemSize.x=e.width,this._itemSize.y=e.height,this.returnToPool(e)}0==this._layout||2==this._layout?this.scrollPane.scrollSpeed=this._itemSize.y:this.scrollPane.scrollSpeed=this._itemSize.x,this.on("fui_scroll",this,this.__scrolled),this.setVirtualListChangedFlag(!0)}},s.__parentSizeChanged=function(){this.setVirtualListChangedFlag()},s.setVirtualListChangedFlag=function(t){void 0===t&&(t=!1),t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),i.timer.callLater(this,this.refreshVirtualList)},s.refreshVirtualList=function(){if(0!=this._virtualListChanged){var t=2==this._virtualListChanged;if(this._virtualListChanged=0,this._eventLocked=!0,t)if(0==this._layout||2==this._layout){0==this._layout?this._curLineItemCount=1:0!=this._lineItemCount?this._curLineItemCount=this._lineItemCount:this._curLineItemCount=Math.floor((this.scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._viewCount=(Math.ceil((this.scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap))+1)*this._curLineItemCount;var e=this._children.length;if(e<this._viewCount)for(var i=e;i<this._viewCount;i++)this.addItemFromPool();else e>this._viewCount&&this.removeChildrenToPool(this._viewCount,e)}else if(1==this._layout?this._curLineItemCount=1:0!=this._lineItemCount?this._curLineItemCount=this._lineItemCount:this._curLineItemCount=Math.floor((this.scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._viewCount=(Math.ceil((this.scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap))+1)*this._curLineItemCount,e=this._children.length,e<this._viewCount)for(i=e;i<this._viewCount;i++)this.addItemFromPool();else e>this._viewCount&&this.removeChildrenToPool(this._viewCount,e);if(this.ensureBoundsCorrect(),0==this._layout||2==this._layout){if(null!=this.scrollPane){var s=NaN;if(0==this._layout)s=this._numItems*this._itemSize.y+Math.max(0,this._numItems-1)*this._lineGap,this._loop&&s>0&&(s=5*s+4*this._lineGap);else{var n=Math.ceil(this._numItems/this._curLineItemCount);s=n*this._itemSize.y+Math.max(0,n-1)*this._lineGap}this.scrollPane.setContentSize(this.scrollPane.contentWidth,s)}}else if(null!=this.scrollPane){var h=NaN;1==this._layout?(h=this._numItems*this._itemSize.x+Math.max(0,this._numItems-1)*this._columnGap,this._loop&&h>0&&(h=5*h+4*this._columnGap)):(n=Math.ceil(this._numItems/this._curLineItemCount),h=n*this._itemSize.x+Math.max(0,n-1)*this._columnGap),this.scrollPane.setContentSize(h,this.scrollPane.contentHeight)}this._eventLocked=!1,this.__scrolled(null)}},s.renderItems=function(t,e){for(var i=0;i<this._viewCount;i++){var s=this.getChildAt(i),n=this._firstIndex+i;this._loop&&this._numItems>0&&(n%=this._numItems),n<this._numItems?(s.visible=!0,i>=t&&e>i&&this.itemRenderer.runWith([n,s])):s.visible=!1}},s.getItemRect=function(t){var e,i=Math.floor(t/this._curLineItemCount),s=t%this._curLineItemCount;switch(this._layout){case 0:e=new f(0,i*this._itemSize.y+Math.max(0,i-1)*this._lineGap,this.viewWidth,this._itemSize.y);break;case 2:e=new f(s*this._itemSize.x+Math.max(0,s-1)*this._columnGap,i*this._itemSize.y+Math.max(0,i-1)*this._lineGap,this._itemSize.x,this._itemSize.y);break;case 1:e=new f(i*this._itemSize.x+Math.max(0,i-1)*this._columnGap,0,this._itemSize.x,this.viewHeight);break;case 3:e=new f(i*this._itemSize.x+Math.max(0,i-1)*this._columnGap,s*this._itemSize.y+Math.max(0,s-1)*this._lineGap,this._itemSize.x,this._itemSize.y)}return e},s.__scrolled=function(t){if(!this._eventLocked){if(0==this._layout||2==this._layout){this._loop&&(0==this.scrollPane.percY?this.scrollPane.posY=this._numItems*(this._itemSize.y+this._lineGap):1==this.scrollPane.percY&&(this.scrollPane.posY=this.scrollPane.contentHeight-this._numItems*(this._itemSize.y+this._lineGap)-this.viewHeight));for(var e=Math.floor((this.scrollPane.posY+this._lineGap)/(this._itemSize.y+this._lineGap)),i=e*this._curLineItemCount,s=0;s<this._viewCount;s++){var n=this.getChildAt(s);n.y=(e+Math.floor(s/this._curLineItemCount))*(this._itemSize.y+this._lineGap)}if(i>=this._numItems&&(i-=this._numItems),i!=this._firstIndex||null==t){var h=this._firstIndex;if(this._firstIndex=i,null==t||h+this._viewCount<i||h>i+this._viewCount){for(s=0;s<this._viewCount;s++)n=this.getChildAt(s),n instanceof fairygui.GButton&&(n.selected=!1);this.renderItems(0,this._viewCount)}else if(h>i){var r=h-i,a=this._viewCount-r;for(s=a-1;s>=0;s--){var o=this.getChildAt(s),l=this.getChildAt(s+r);l instanceof fairygui.GButton&&(l.selected=!1);var u=o.y;o.y=l.y,l.y=u,this.swapChildrenAt(s+r,s)}this.renderItems(0,r)}else{for(r=i-h,a=this._viewCount-r,s=0;a>s;s++)o=this.getChildAt(s),l=this.getChildAt(s+r),o instanceof fairygui.GButton&&(o.selected=!1),u=o.y,o.y=l.y,l.y=u,this.swapChildrenAt(s+r,s);this.renderItems(a,this._viewCount)}}}else{for(this._loop&&(0==this.scrollPane.percX?this.scrollPane.posX=this._numItems*(this._itemSize.x+this._columnGap):1==this.scrollPane.percX&&(this.scrollPane.posX=this.scrollPane.contentWidth-this._numItems*(this._itemSize.x+this._columnGap)-this.viewWidth)),e=Math.floor((this.scrollPane.posX+this._columnGap)/(this._itemSize.x+this._columnGap)),i=e*this._curLineItemCount,s=0;s<this._viewCount;s++)n=this.getChildAt(s),n.x=(e+Math.floor(s/this._curLineItemCount))*(this._itemSize.x+this._columnGap);if(i>=this._numItems&&(i-=this._numItems),i!=this._firstIndex||null==t)if(h=this._firstIndex,this._firstIndex=i,null==t||h+this._viewCount<i||h>i+this._viewCount){for(s=0;s<this._viewCount;s++)n=this.getChildAt(s),o instanceof fairygui.GButton&&(o.selected=!1);this.renderItems(0,this._viewCount)}else if(h>i){for(r=h-i,a=this._viewCount-r,s=a-1;s>=0;s--)o=this.getChildAt(s),l=this.getChildAt(s+r),l instanceof fairygui.GButton&&(l.selected=!1),u=o.x,o.x=l.x,l.x=u,this.swapChildrenAt(s+r,s);this.renderItems(0,r)}else{for(r=i-h,a=this._viewCount-r,s=0;a>s;s++)o=this.getChildAt(s),l=this.getChildAt(s+r),o instanceof fairygui.GButton&&(o.selected=!1),u=o.x,o.x=l.x,l.x=u,this.swapChildrenAt(s+r,s);this.renderItems(a,this._viewCount)}}this._boundsChanged=!1}},s.updateBounds=function(){var t,e=this._children.length,i=0,s=0,n=0,h=0,r=0,a=NaN,o=0;for(i=0;e>i;i++)t=this.getChildAt(i),t.ensureSizeCorrect();if(0==this._layout){for(i=0;e>i;i++)t=this.getChildAt(i),t.visible&&(0!=n&&(n+=this._lineGap),t.y=n,n+=t.height,t.width>h&&(h=t.width));a=s+h,o=n}else if(1==this._layout){for(i=0;e>i;i++)t=this.getChildAt(i),t.visible&&(0!=s&&(s+=this._columnGap),t.x=s,s+=t.width,t.height>r&&(r=t.height));a=s,o=n+r}else if(2==this._layout){var l=0,u=this.viewWidth;for(i=0;e>i;i++)t=this.getChildAt(i),t.visible&&(0!=s&&(s+=this._columnGap),(0!=this._lineItemCount&&l>=this._lineItemCount||0==this._lineItemCount&&s+t.width>u&&0!=r)&&(s-=this._columnGap,s>h&&(h=s),s=0,n+=r+this._lineGap,r=0,l=0),t.setXY(s,n),s+=t.width,t.height>r&&(r=t.height),l++);o=n+r,a=h}else{l=0;var _=this.viewHeight;for(i=0;e>i;i++)t=this.getChildAt(i),t.visible&&(0!=n&&(n+=this._lineGap),(0!=this._lineItemCount&&l>=this._lineItemCount||0==this._lineItemCount&&n+t.height>_&&0!=h)&&(n-=this._lineGap,n>r&&(r=n),n=0,s+=h+this._columnGap,h=0,l=0),t.setXY(s,n),n+=t.height,t.width>h&&(h=t.width),l++);a=s+h,o=r}this.setBounds(0,0,a,o)},s.setup_beforeAdd=function(t){fairygui.GObject.prototype.setup_beforeAdd.call(this,t);var e,i;e=t.getAttribute("layout"),e&&(this._layout=z.parse(e));var s=0;if(e=t.getAttribute("overflow"),s=e?N.parse(e):0,e=t.getAttribute("margin"),e&&this._margin.parse(e),2==s){var n=0;e=t.getAttribute("scroll"),n=e?$.parse(e):1;var h=0;e=t.getAttribute("scrollBar"),h=e?Y.parse(e):0;var r=NaN;e=t.getAttribute("scrollBarFlags"),r=e?parseInt(e):0;var a=new W;e=t.getAttribute("scrollBarMargin"),e&&a.parse(e);var o,l;e=t.getAttribute("scrollBarRes"),e&&(i=e.split(","),o=i[0],l=i[1]),this.setupScroll(a,n,h,r,o,l)}else this.setupOverflow(s);e=t.getAttribute("lineGap"),e&&(this._lineGap=parseInt(e)),e=t.getAttribute("colGap"),e&&(this._columnGap=parseInt(e)),e=t.getAttribute("lineItemCount"),e&&(this._lineItemCount=parseInt(e)),e=t.getAttribute("selectionMode"),e&&(this._selectionMode=M.parse(e)),e=t.getAttribute("defaultItem"),e&&(this._defaultItem=e),e=t.getAttribute("autoItemSize"),this._autoResizeItem="false"!=e;for(var u=t.childNodes,_=u.length,c=0;_>c;c++){var d=u[c];if("item"==d.nodeName){var g=d.getAttribute("url");if(g||(g=this._defaultItem),g){var f=this.getFromPool(g);null!=f&&(this.addChild(f),f instanceof fairygui.GButton?(f.title=d.getAttribute("title"),f.icon=d.getAttribute("icon")):f instanceof fairygui.GLabel&&(f.title=d.getAttribute("title"),f.icon=d.getAttribute("icon")))}}}},h(0,s,"layout",function(){return this._layout},function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,s,"lineGap",function(){return this._lineGap},function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,s,"lineItemCount",function(){return this._lineItemCount},function(t){this._lineItemCount!=t&&(this._lineItemCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,s,"selectionMode",function(){return this._selectionMode},function(t){this._selectionMode=t}),h(0,s,"columnGap",function(){return this._columnGap},function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,s,"defaultItem",function(){return this._defaultItem},function(t){this._defaultItem=t}),h(0,s,"virtualItemSize",function(){return this._itemSize},function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new a),this._itemSize.setTo(t.x,t.y),this.setVirtualListChangedFlag(!0))}),h(0,s,"autoResizeItem",function(){return this._autoResizeItem},function(t){this._autoResizeItem=t}),h(0,s,"selectedIndex",function(){for(var t=this._children.length,e=0;t>e;e++){var i=this._children[e].asButton;if(null!=i&&i.selected){var s=this._firstIndex+e;return this._loop&&this._numItems>0&&(s%=this._numItems),s}}return-1},function(t){this.clearSelection(),t>=0&&t<this.numItems&&this.addSelection(t)}),h(0,s,"numItems",function(){return this._virtual?this._numItems:this._children.length},function(t){if(this._virtual)this._numItems=t,this.setVirtualListChangedFlag();else{var e=this._children.length;if(t>e)for(var i=e;t>i;i++)this.addItemFromPool();else this.removeChildrenToPool(t,e);if(null!=this.itemRenderer)for(i=0;t>i;i++)this.itemRenderer.runWith([i,this.getChildAt(i)])}}),e}(st),bt=function(t){function e(){this.div=null,this._text=null,this._ubbEnabled=!1,this._color=null,e.__super.call(this),this._text=""}n(e,"fairygui.GRichTextField",t);var s=e.prototype;return i.imps(s,{"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.div=new b,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},s.handleSizeChanged=function(){this.div.size(this.width,this.height)},h(0,s,"leading",function(){return this.div.style.leading},function(t){this.div.style.leading=t}),h(0,s,"text",function(){return this._text},function(t){this._text=t,this._ubbEnabled?this.div.innerHTML=J.parseUBB(J.encodeHTML(this._text)):this.div.innerHTML=this._text}),h(0,s,"font",function(){return this.div.style.font},function(t){this.div.style.font=t}),h(0,s,"italic",function(){return this.div.style.italic},function(t){this.div.style.italic=t}),h(0,s,"valign",function(){return this.div.style.valign},function(t){this.div.style.valign=t}),h(0,s,"fontSize",function(){return this.div.style.fontSize},function(t){this.div.style.fontSize=t}),h(0,s,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.div.color=t,this._gearColor.controller&&this._gearColor.updateState())}),h(0,s,"strokeColor",function(){return this.div.style.strokeColor},function(t){this.div.style.strokeColor=t}),h(0,s,"align",function(){return this.div.style.align},function(t){this.div.style.align=t}),h(0,s,"bold",function(){return this.div.style.bold},function(t){this.div.style.bold=t}),h(0,s,"stroke",function(){return this.div.style.stroke},function(t){this.div.style.stroke=t}),h(0,s,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),e}(it),wt=function(t){function e(){this._max=0,this._value=0,this._titleType=0,this._reverse=!1,this._titleObject=null,this._aniObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._barStartX=0,this._barStartY=0,this._tweener=null,this._tweenValue=0,e.__super.call(this),this._titleType=0,this._value=50,this._max=100}n(e,"fairygui.GProgressBar",t);var i=e.prototype;return i.tweenValue=function(t,e){this._value!=t&&(this._tweener&&this._tweener.clear(),this._tweenValue=this._value,this._value=t,this._tweener=c.to(this,{_tweenValue:t},1e3*e,fairygui.GProgressBar.easeLinear),this._tweener.update=u.create(this,this.onUpdateTween,null,!1))},i.onUpdateTween=function(){this.update(this._tweenValue)},i.update=function(t){var e=Math.min(t/this._max,1);if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*e)+"%";break;case 1:this._titleObject.text=Math.round(t)+"/"+Math.round(this._max);break;case 2:this._titleObject.text=""+Math.round(t);break;case 3:this._titleObject.text=""+Math.round(this._max)}var i=this.width-this._barMaxWidthDelta,s=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=i*e,this._barObjectH.x=this._barStartX+(i-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=s*e,this._barObjectV.y=this._barStartY+(s-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=i*e),this._barObjectV&&(this._barObjectV.height=s*e)),this._aniObject instanceof fairygui.GMovieClip&&(this._aniObject.frame=Math.round(100*e))},i.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),e=J.findChildNode(e,"ProgressBar");var i;i=e.getAttribute("titleType"),i&&(this._titleType=E.parse(i)),this._reverse="true"==e.getAttribute("reverse"),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},i.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},i.setup_afterAdd=function(t){fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=J.findChildNode(t,"ProgressBar"),t&&(this._value=parseInt(t.getAttribute("value")),this._max=parseInt(t.getAttribute("max"))),this.update(this._value)},i.dispose=function(){this._tweener&&this._tweener.clear(),t.prototype.dispose.call(this)},h(0,i,"titleType",function(){return this._titleType},function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))}),h(0,i,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update(this._value))}),h(0,i,"value",function(){return this._value},function(t){null!=this._tweener&&(this._tweener.clear(),this._tweener=null),this._value!=t&&(this._value=t,this.update(this._value))}),s(e,["easeLinear",function(){return this.easeLinear=d.linearNone}]),e}(st),Ct=function(t){function e(){this.input=null,e.__super.call(this)}n(e,"fairygui.GTextInput",t);var s=e.prototype;return i.imps(s,{"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.input=new C,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},s.handleSizeChanged=function(){this.input.size(this.width,this.height)},h(0,s,"leading",function(){return this.input.leading},function(t){this.input.leading=t}),h(0,s,"text",function(){return this.input.text},function(t){this.input.text=t}),h(0,s,"font",function(){return this.input.font},function(t){this.input.font=t}),h(0,s,"italic",function(){return this.input.italic},function(t){this.input.italic=t}),h(0,s,"valign",function(){return this.input.valign},function(t){this.input.valign=t}),h(0,s,"fontSize",function(){return this.input.fontSize},function(t){this.input.fontSize=t}),h(0,s,"color",function(){return this.input.color},function(t){this.input.color=t}),h(0,s,"strokeColor",function(){return this.input.strokeColor},function(t){this.input.strokeColor=t}),h(0,s,"align",function(){return this.input.align},function(t){this.input.align=t}),h(0,s,"bold",function(){return this.input.bold},function(t){this.input.bold=t}),h(0,s,"asPassword",function(){return this.input.asPassword},function(t){this.input.asPassword=t}),h(0,s,"singleLine",function(){return!this.input.multiline},function(t){this.input.multiline=!t}),h(0,s,"stroke",function(){return this.input.stroke},function(t){this.input.stroke=t}),h(0,s,"editable",function(){return this.input.editable},function(t){this.input.editable=t}),h(0,s,"maxChars",function(){return this.input.maxChars},function(t){this.input.maxChars=t}),h(0,s,"promptText",function(){return this.input.title},function(t){this.input.title=t}),h(0,s,"textWidth",function(){return this.input.textWidth}),e}(it),xt=function(t){function e(){this._modalLayer=null,this._popupStack=null,this._justClosedPopups=null,this._modalWaitPane=null,this._focusedObject=null,this._tooltipWin=null,this._defaultTooltipWin=null,this._volumeScale=NaN,this._checkPopups=!1,e.__super.call(this),null==fairygui.GRoot._inst&&(fairygui.GRoot._inst=this),this.opaque=!1,this._volumeScale=1,this._popupStack=[],this._justClosedPopups=[],this.displayObject.once("display",this,this.__addedToStage)}n(e,"fairygui.GRoot",t);var s=e.prototype;return s.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},s.hideWindow=function(t){t.hide()},s.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},s.bringToFront=function(t){var e=this.numChildren,i=NaN;for(i=null==this._modalLayer.parent||t.modal?e-1:this.getChildIndex(this._modalLayer)-1;i>=0;i--){var s=this.getChildAt(i);if(s==t)return;if(s instanceof fairygui.Window)break}i>=0&&this.setChildIndex(t,i)},s.showModalWait=function(t){null!=Q.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=Z.createObjectFromURL(Q.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,24),this.addChild(this._modalWaitPane),this._modalWaitPane.text=t)},s.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},s.closeAllExceptModals=function(){for(var t=this._children.slice(),e=t.length,i=0;e>i;i++){var s=t[i];s instanceof fairygui.Window&&!s.modal&&s.hide()}},s.closeAllWindows=function(){for(var t=this._children.slice(),e=t.length,i=0;e>i;i++){var s=t[i];s instanceof fairygui.Window&&s.hide()}},s.getTopWindow=function(){for(var t=this.numChildren,e=t-1;e>=0;e--){var i=this.getChildAt(e);if(i instanceof fairygui.Window)return i}return null},s.showPopup=function(t,e,s){if(this._popupStack.length>0){var n=this._popupStack.indexOf(t);if(-1!=n)for(var h=this._popupStack.length-1;h>=n;h--)this.removeChild(this._popupStack.pop())}this._popupStack.push(t),this.addChild(t),this.adjustModalLayer();var r,a=NaN,o=0;e?(r=e.localToGlobal(),a=e.width,o=e.height):r=this.globalToLocal(i.stage.mouseX,i.stage.mouseY);
var l=NaN,u=NaN;l=r.x,l+t.width>this.width&&(l=l+a-t.width),u=r.y+o,(null==s&&u+t.height>this.height||0==s)&&(u=r.y-t.height-1,0>u&&(u=0,l+=a/2)),t.x=l,t.y=u},s.togglePopup=function(t,e,i){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},s.hidePopup=function(t){if(null!=t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;i>=e;i--)this.closePopup(this._popupStack.pop())}else{var s=this._popupStack.length;for(i=s-1;i>=0;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},s.closePopup=function(t){null!=t.parent&&(t instanceof fairygui.Window?t.hide():this.removeChild(t))},s.showTooltips=function(t){if(null==this._defaultTooltipWin){var e=Q.tooltipsWin;if(!e)return void w.print("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=Z.createObjectFromURL(e)}this._defaultTooltipWin.text=t,this.showTooltipsWin(this._defaultTooltipWin)},s.showTooltipsWin=function(t,e){this.hideTooltips(),this._tooltipWin=t;var s=0,n=0;null==e?(s=i.stage.mouseX+10,n=i.stage.mouseY+20):(s=e.x,n=e.y);var h=this.globalToLocal(s,n);s=h.x,n=h.y,s+this._tooltipWin.width>this.width&&(s=s-this._tooltipWin.width-1,0>s&&(s=10)),n+this._tooltipWin.height>this.height&&(n=n-this._tooltipWin.height-1,s-this._tooltipWin.width-1>0&&(s=s-this._tooltipWin.width-1),0>n&&(n=10)),this._tooltipWin.x=s,this._tooltipWin.y=n,this.addChild(this._tooltipWin)},s.hideTooltips=function(){null!=this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},s.getObjectUnderPoint=function(t,e){return null},s.setFocus=function(t){this._focusedObject!=t&&(this._focusedObject=t,this.displayObject.event("fui_focus_changed"))},s.playOneShotSound=function(t,e){void 0===e&&(e=1);var i=this._volumeScale*e,s=t.play(0,1);s.volume=i},s.adjustModalLayer=function(){var t=this.numChildren,e=!1;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,t-1);for(var i=t-1;i>=0;i--){var s=this.getChildAt(i);if(s==this._modalLayer)e=!0;else if(s instanceof fairygui.Window&&s.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,i):i>0?e?this.setChildIndex(this._modalLayer,i):this.setChildIndex(this._modalLayer,i-1):this.addChildAt(this._modalLayer,0))}null!=this._modalLayer.parent&&this.removeChild(this._modalLayer)},s.__addedToStage=function(){i.stage.on("mousedown",this,this.__stageMouseDown),i.stage.on("mouseup",this,this.__stageMouseUp),this._modalLayer=new rt,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,null,Q.modalLayerColor),this._modalLayer.addRelation(this,24),this.displayObject.stage.on("resize",this,this.__winResize),this.__winResize()},s.checkPopups=function(t){if(!this._checkPopups&&(this._checkPopups=!0,this._justClosedPopups.length=0,this._popupStack.length>0)){for(var e=t;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var i=this._popupStack.indexOf(e.$owner);if(-1!=i){for(var s=this._popupStack.length-1;s>i;s--){var n=this._popupStack.pop();this.closePopup(n),this._justClosedPopups.push(n)}return}}e=e.parent}var h=this._popupStack.length;for(s=h-1;s>=0;s--)n=this._popupStack[s],this.closePopup(n),this._justClosedPopups.push(n);this._popupStack.length=0}},s.__stageMouseDown=function(t){for(var e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var i=e.$owner;if(i.touchable&&i.focusable){this.setFocus(i);break}}e=e.parent}null!=this._tooltipWin&&this.hideTooltips(),this.checkPopups(t.target)},s.__stageMouseUp=function(){this._checkPopups=!1},s.__winResize=function(){this.setSize(i.stage.width,i.stage.height)},h(0,s,"hasModalWindow",function(){return null!=this._modalLayer.parent}),h(0,s,"modalWaiting",function(){return this._modalWaitPane&&this._modalWaitPane.inContainer}),h(0,s,"hasAnyPopup",function(){return 0!=this._popupStack.length}),h(0,s,"focus",function(){return this._focusedObject&&!this._focusedObject.onStage&&(this._focusedObject=null),this._focusedObject},function(t){if(t&&(!t.focusable||!t.onStage))throw"invalid focus target";this.setFocus(t)}),h(0,s,"volumeScale",function(){return this._volumeScale},function(t){this._volumeScale=t}),h(1,e,"inst",function(){return null==fairygui.GRoot._inst&&new e,fairygui.GRoot._inst},fairygui.GComponent._$SET_inst),e._inst=null,e}(st),St=function(t){function e(){this._grip=null,this._arrowButton1=null,this._arrowButton2=null,this._bar=null,this._target=null,this._vertical=!1,this._scrollPerc=NaN,this._fixedGripSize=!1,this._dragOffset=null,e.__super.call(this),this._dragOffset=new laya.maths.Point,this._scrollPerc=0}n(e,"fairygui.GScrollBar",t);var r=e.prototype;return r.setScrollPane=function(t,e){this._target=t,this._vertical=e},r.constructFromXML=function(e){return t.prototype.constructFromXML.call(this,e),e=J.findChildNode(e,"ScrollBar"),e&&(this._fixedGripSize="true"==e.getAttribute("fixedGripSize")),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.on("mousedown",this,this.__gripMouseDown),this._arrowButton1&&this._arrowButton1.on("mousedown",this,this.__arrowButton1Click),this._arrowButton2&&this._arrowButton2.on("mousedown",this,this.__arrowButton2Click),void this.on("mousedown",this,this.__barMouseDown)):void w.print("需要定义bar")):void w.print("需要定义grip")},r.__gripMouseDown=function(t){this._bar&&(t.stopPropagation(),i.stage.on("mousemove",this,this.__gripMouseMove),i.stage.on("mouseup",this,this.__gripMouseUp),this.globalToLocal(i.stage.mouseX,i.stage.mouseY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y)},r.__gripMouseMove=function(){var t=this.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);if(this._vertical){var e=t.y-this._dragOffset.y;this._target.setPercY((e-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var s=t.x-this._dragOffset.x;this._target.setPercX((s-this._bar.x)/(this._bar.width-this._grip.width),!1)}},r.__gripMouseUp=function(t){this._bar&&(i.stage.off("mousemove",this,this.__gripMouseMove),i.stage.off("mouseup",this,this.__gripMouseUp))},r.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},r.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},r.__barMouseDown=function(t){var e=this._grip.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);this._vertical?e.y<0?this._target.scrollUp(4):this._target.scrollDown(4):e.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},h(0,r,"displayPerc",null,function(t){this._vertical?(this._fixedGripSize||(this._grip.height=t*this._bar.height),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=t*this._bar.width),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc)}),h(0,r,"scrollPerc",null,function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc}),h(0,r,"minSize",function(){return this._vertical?(null!=this._arrowButton1?this._arrowButton1.height:0)+(null!=this._arrowButton2?this._arrowButton2.height:0):(null!=this._arrowButton1?this._arrowButton1.width:0)+(null!=this._arrowButton2?this._arrowButton2.width:0)}),s(e,["sScrollbarHelperPoint",function(){return this.sScrollbarHelperPoint=new a}]),e}(st),It=function(t){function e(){this._max=0,this._value=0,this._titleType=0,this._titleObject=null,this._aniObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._gripObject=null,this._clickPos=null,this._clickPercent=NaN,e.__super.call(this),this._titleType=0,this._value=50,this._max=100,this._clickPos=new laya.maths.Point}n(e,"fairygui.GSlider",t);var r=e.prototype;return r.update=function(){var t=Math.min(this._value/this._max,1);this.updateWidthPercent(t)},r.updateWidthPercent=function(t){if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*t)+"%";break;case 1:this._titleObject.text=this._value+"/"+this._max;break;case 2:this._titleObject.text=""+this._value;break;case 3:this._titleObject.text=""+this._max}this._barObjectH&&(this._barObjectH.width=(this.width-this._barMaxWidthDelta)*t),this._barObjectV&&(this._barObjectV.height=(this.height-this._barMaxHeightDelta)*t),this._aniObject instanceof fairygui.GMovieClip&&(this._aniObject.frame=Math.round(100*t))},r.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),e=J.findChildNode(e,"Slider");var i;i=e.getAttribute("titleType"),i&&(this._titleType=E.parse(i)),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight),this._gripObject&&this._gripObject.on("mousedown",this,this.__gripMouseDown)},r.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},r.setup_afterAdd=function(t){fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=J.findChildNode(t,"Slider"),t&&(this._value=parseInt(t.getAttribute("value")),this._max=parseInt(t.getAttribute("max"))),this.update()},r.__gripMouseDown=function(t){this._clickPos=this.globalToLocal(i.stage.mouseX,i.stage.mouseY),this._clickPercent=this._value/this._max,i.stage.on("mousemove",this,this.__gripMouseMove),i.stage.on("mouseup",this,this.__gripMouseUp)},r.__gripMouseMove=function(t){var e=this.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GSlider.sSilderHelperPoint),s=e.x-this._clickPos.x,n=e.y-this._clickPos.y,h=NaN;h=this._barObjectH?this._clickPercent+s/this._barMaxWidth:this._clickPercent+n/this._barMaxHeight,h>1?h=1:0>h&&(h=0);var r=Math.round(this._max*h);r!=this._value&&(this._value=r,A.dispatch("fui_state_changed",this.displayObject,t)),this.updateWidthPercent(h)},r.__gripMouseUp=function(t){var e=this._value/this._max;this.updateWidthPercent(e),i.stage.off("mousemove",this,this.__gripMouseMove),i.stage.off("mouseup",this,this.__gripMouseUp)},h(0,r,"titleType",function(){return this._titleType},function(t){this._titleType=t}),h(0,r,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update())}),h(0,r,"value",function(){return this._value},function(t){this._value!=t&&(this._value=t,this.update())}),s(e,["sSilderHelperPoint",function(){return this.sSilderHelperPoint=new a}]),e}(st),Ot=(function(t){function e(){this._contentPane=null,this._modalWaitPane=null,this._closeButton=null,this._dragArea=null,this._contentArea=null,this._frame=null,this._modal=!1,this._uiSources=null,this._inited=!1,this._loading=!1,this._requestingCmd=0,this.bringToFontOnClick=!1,e.__super.call(this),this.focusable=!0,this._uiSources=[],this.bringToFontOnClick=Q.bringWindowToFrontOnClick,this.displayObject.on("display",this,this.__onShown),this.displayObject.on("undisplay",this,this.__onHidden),this.displayObject.on("mousedown",this,this.__mouseDown)}n(e,"fairygui.Window",t,"Window2");var i=e.prototype;return i.addUISource=function(t){this._uiSources.push(t)},i.show=function(){xt.inst.showWindow(this)},i.showOn=function(t){t.showWindow(this)},i.hide=function(){this.isShowing&&this.doHideAnimation()},i.hideImmediately=function(){var t=this.parent instanceof fairygui.GRoot?this.parent:null;t||(t=xt.inst),t.hideWindowImmediately(this)},i.centerOn=function(t,e){void 0===e&&(e=!1),this.setXY(Math.round((t.width-this.width)/2),Math.round((t.height-this.height)/2)),e&&(this.addRelation(t,3),this.addRelation(t,10))},i.toggleStatus=function(){this.isTop?this.hide():this.show()},i.bringToFront=function(){this.root.bringToFront(this)},i.showModalWait=function(t){void 0===t&&(t=0),0!=t&&(this._requestingCmd=t),Q.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=Z.createObjectFromURL(Q.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},i.layoutModalWaitPane=function(){if(null!=this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},i.closeModalWait=function(t){return void 0===t&&(t=0),0!=t&&this._requestingCmd!=t?!1:(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},i.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},i.onInit=function(){},i.onShown=function(){},i.onHide=function(){},i.doShowAnimation=function(){this.onShown()},i.doHideAnimation=function(){this.hideImmediately()},i.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];if(!i.loaded)return}this._loading=!1,this._init()},i._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},i.dispose=function(){null!=this.parent&&this.hideImmediately(),t.prototype.dispose.call(this)},i.closeEventHandler=function(){this.hide()},i.__onShown=function(){this._inited?this.doShowAnimation():this.init()},i.__onHidden=function(){this.closeModalWait(),this.onHide()},i.__mouseDown=function(){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},i.__dragStart=function(t){j.cast(t.currentTarget).stopDrag(),this.startDrag()},h(0,i,"contentArea",function(){return this._contentArea},function(t){this._contentArea=t}),h(0,i,"contentPane",function(){return this._contentPane},function(t){this._contentPane!=t&&(null!=this._contentPane&&this.removeChild(this._contentPane),this._contentPane=t,null!=this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,24),this._frame=this._contentPane.getChild("frame"),null!=this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))}),h(0,i,"frame",function(){return this._frame}),h(0,i,"closeButton",function(){return this._closeButton},function(t){null!=this._closeButton&&this._closeButton.offClick(this,this.closeEventHandler),this._closeButton=t,null!=this._closeButton&&this._closeButton.onClick(this,this.closeEventHandler)}),h(0,i,"dragArea",function(){return this._dragArea},function(t){this._dragArea!=t&&(null!=this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.off("fui_drag_start",this,this.__dragStart)),this._dragArea=t,null!=this._dragArea&&(this._dragArea instanceof fairygui.GGraph&&this._dragArea.asGraph.drawRect(0,null,null),this._dragArea.draggable=!0,this._dragArea.on("fui_drag_start",this,this.__dragStart)))}),h(0,i,"modal",function(){return this._modal},function(t){this._modal=t}),h(0,i,"isShowing",function(){return null!=this.parent}),h(0,i,"isTop",function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}),h(0,i,"modalWaiting",function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent}),e}(st),function(t){function e(){this._texture=null,this._scaleByTile=!1,this._scale9Grid=null,this._textureScaleX=NaN,this._textureScaleY=NaN,this._needRebuild=!1,e.__super.call(this),this.mouseEnabled=!1,this._textureScaleX=1,this._textureScaleY=1}n(e,"fairygui.display.Image",t,"Image1");var s=e.prototype;return s.scaleTexture=function(t,e){this._textureScaleX==t&&this._textureScaleY==e||(this._textureScaleX=t,this._textureScaleY=e,this.markChanged())},s.markChanged=function(){this._needRebuild||(this._needRebuild=!0,i.timer.callLater(this,this.rebuild))},s.rebuild=function(){this._needRebuild=!1;var t=this.graphics;if(t.clear(),null!=this._texture){var e=this.width*this._textureScaleX,i=this.height*this._textureScaleY,s=this._texture.width,n=this._texture.height;if(this._scaleByTile)for(var h=Math.ceil(this._textureScaleX),r=Math.ceil(this._textureScaleY),a=e-(h-1)*s,o=i-(r-1)*n,l=0;h>l;l++)for(var u=0;r>u;u++)l==h-1||u==r-1?t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,0,l==h-1?a:s,u==r-1?o:n),l*s,u*n):t.drawTexture(this._texture,l*s,u*n);else if(null!=this._scale9Grid){var _=this._scale9Grid.x,c=Math.max(s-this._scale9Grid.right,0),d=this._scale9Grid.y,g=Math.max(n-this._scale9Grid.bottom,0);_&&d&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,0,_,d),0,0,_,d),c&&d&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,s-c,0,c,d),e-c,0,c,d),_&&g&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,n-g,_,g),0,i-g,_,g),c&&g&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,s-c,n-g,c,g),e-c,i-g,c,g),d&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,_,0,s-_-c,d),_,0,e-_-c,d),g&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,_,n-g,s-_-c,g),_,i-g,e-_-c,g),_&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,d,_,n-d-g),0,d,_,i-d-g),c&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,s-c,d,c,n-d-g),e-c,d,c,i-d-g),t.drawTexture(fairygui.display.Image.getTexture(this._texture,_,d,s-_-c,n-d-g),_,d,e-_-c,i-d-g)}else t.drawTexture(this._texture,0,0,e,i);this.repaint()}},h(0,s,"texture",function(){return this._texture},function(t){this._texture!=t&&(this._texture=t,this._texture?this.size(this._texture.width,this._texture.height):this.size(0,0),this.markChanged())}),h(0,s,"scale9Grid",function(){return this._scale9Grid},function(t){this._scale9Grid=t,this.markChanged()}),h(0,s,"scaleByTile",function(){return this._scaleByTile},function(t){this._scaleByTile!=t&&(this._scaleByTile=t,this.markChanged())}),e.getTexture=function(t,e,i,s,n){t.$GID||(t.$GID=m.getGID());var h=t.$GID+"."+e+"."+i+"."+s+"."+n,r=fairygui.display.Image._textureCache[h];return r||(r=fairygui.display.Image._textureCache[h]=p.create(t,e,i,s,n)),r},e.clearCache=function(){fairygui.display.Image._textureCache={}},e._textureCache={},e}(g)),kt=function(t){function e(){this.interval=0,this.swing=!1,this.repeatDelay=0,this._texture=null,this._needRebuild=!1,this._playing=!1,this._playState=null,this._frameCount=0,this._frames=null,this._currentFrame=0,this._boundsRect=null,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this._endHandler=null,e.__super.call(this),this._playState=new P,this._playing=!0,this.mouseEnabled=!1,this.setPlaySettings(),this.on("display",this,this.__addToStage),this.on("undisplay",this,this.__removeFromStage)}n(e,"fairygui.display.MovieClip",t,"MovieClip1");var s=e.prototype;return s.setPlaySettings=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=s,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._endHandler=n,this.currentFrame=t},s.update=function(){this._playing&&0!=this._frameCount&&3!=this._status?(this._playState.update(this),this._currentFrame!=this._playState.currentFrame&&(1==this._status?(this._currentFrame=this._start,this._playState.currentFrame=this._currentFrame,this._status=0):2==this._status?(this._currentFrame=this._endAt,this._playState.currentFrame=this._currentFrame,this._status=3,null!=this._endHandler&&i.timer.callLater(this,this._endHandler.run)):(this._currentFrame=this._playState.currentFrame,this._currentFrame==this._end&&this._times>0&&(this._times--,0==this._times?this._status=2:this._status=1)),this.setFrame(this._frames[this._currentFrame]))):this.setFrame(null)},s.setFrame=function(t){this.graphics.clear(),null!=t&&this.graphics.drawTexture(t.texture,t.rect.x,t.rect.y)},s.__addToStage=function(){this._playing&&i.timer.frameLoop(1,this,this.update)},s.__removeFromStage=function(){this._playing&&i.timer.clear(this,this.update)},h(0,s,"frameCount",function(){return this._frameCount}),h(0,s,"frames",function(){return this._frames},function(t){this._frames=t,null!=this._frames?this._frameCount=this._frames.length:this._frameCount=0,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._currentFrame<0||this._currentFrame>this._frameCount-1)&&(this._currentFrame=this._frameCount-1),this._frameCount>0?this.setFrame(this._frames[this._currentFrame]):this.setFrame(null),this._playState.rewind()}),h(0,s,"boundsRect",function(){return this._boundsRect},function(t){this._boundsRect=t}),h(0,s,"currentFrame",function(){return this._currentFrame},function(t){this._currentFrame!=t&&(this._currentFrame=t,this._playState.currentFrame=t,this.setFrame(this._currentFrame<this._frameCount?this._frames[this._currentFrame]:null))}),h(0,s,"playing",function(){return this._playing},function(t){this._playing=t,t&&null!=this.stage?i.timer.frameLoop(1,this,this.update):i.timer.clear(this,this.update)}),e}(g);i.__init([Z,D,ft,_t,nt,et,ot,U,q])}(window,document,Laya);